!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(t){return e[t]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="https://takingdoms.github.io/3do-viewer-preact-with-textures/",t(t.s="Pq/i")}({"/dwh":function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r("hosL");t.a=({userSettings:e,setUserSettings:t})=>Object(a.h)("div",{class:"space-y-4"},Object(a.h)("div",{class:"flex flex-col items-stretch"},Object(a.h)("label",{for:"sidebarPosition"},"Sidebar Position"),Object(a.h)("select",{id:"sidebarPosition",value:e.sidebarPosition,onChange:r=>{const n="left"===r.currentTarget.value?"left":"right";t(o(o({},e),{},{sidebarPosition:n}))}},Object(a.h)("option",{value:"left"},"Left"),Object(a.h)("option",{value:"right"},"Right"))))},"/u4b":function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r("CCBT"),t),o(r("ejsI"),t),o(r("BQX+"),t)},"BQX+":function(e,t,r){"use strict";function n(e,t){const r=[];let s=t;do{const t=u.makeStruct(e,s,f.OBJECT_STRUCT),l=o(e,t.OffsetToObjectName),c=i(e,t.OffsetToVertexArray,t.NumberOfVertexes),h=a(e,t.OffsetToPrimitiveArray,t.NumberOfPrimitives),d=0!==t.OffsetToChildObject?n(e,t.OffsetToChildObject):[];r.push({name:l,vertices:c,primitives:h,children:d,xOffset:t.XFromParent,yOffset:t.YFromParent,zOffset:t.ZFromParent}),s=t.OffsetToSiblingObject}while(0!==s);return r}function o(e,t){let r=0;for(let n=0;n<256;n++){r=n;if(0===e.getUint8(t+n))break}const n=new Uint8Array(e.buffer,t,r);return h.decode(n)}function i(e,t,r){const n=[];for(let o=0;o<r;o++){const r=u.makeStruct(e,t+o*f.VERTEX_STRUCT_SIZE,f.VERTEX_STRUCT);n.push({x:r.x,y:r.y,z:r.z})}return n}function a(e,t,r){const n=[];for(let i=0;i<r;i++){const r=u.makeStruct(e,t+i*f.PRIMITIVE_STRUCT_SIZE,f.PRIMITIVE_STRUCT),a=[];for(let t=0;t<r.NumberOfVertexIndexes;t++){const n=e.getUint16(r.OffsetToVertexIndexArray+2*t,!0);a.push(n)}const s=o(e,r.OffsetToTextureName);n.push({vertexIndices:a,textureName:s})}return n}var s=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Parse3do=void 0;const u=c(r("CCBT")),f=r("weEs"),h=new TextDecoder("ascii");t.Parse3do={fromBuffer:function(e){return{rootNodes:n(e,0)}}}},CCBT:function(e,t){"use strict";function r(e,t,r,n="LE"){return"I8"===r?e.getInt8(t):"U8"===r?e.getUint8(t):"I16"===r?e.getInt16(t,"LE"===n):"U16"===r?e.getUint16(t,"LE"===n):e.getInt32(t,"LE"===n)}Object.defineProperty(t,"__esModule",{value:!0}),t.makeStruct=t.readInteger=t.ENDIANNESSES=t.INTEGER_TYPES=void 0,t.INTEGER_TYPES=["U8","I8","U16","I16","U32","I32"],t.ENDIANNESSES=["LE","BE"],t.readInteger=r,t.makeStruct=function(e,t,n,o="LE"){let i={};for(const[a,s]of n)i[a]=r(e,t,s,o),"U8"===s||"I8"===s?t+=1:"U16"===s||"I16"===s?t+=2:"U32"!==s&&"I32"!==s||(t+=4);return i}},GssO:function(e,t,r){"use strict";var n=r("hosL"),o=r("QRet"),i=r("Xvsu");t.a=({color:e,setColor:t})=>{const[r,a]=Object(o.e)(!1);let s="custom";r||(1===e[0]&&1===e[1]&&1===e[2]&&1===e[3]?s="white":1===e[0]&&0===e[1]&&0===e[2]&&1===e[3]?s="red":0===e[0]&&1===e[1]&&0===e[2]&&1===e[3]?s="green":0===e[0]&&0===e[1]&&1===e[2]&&1===e[3]&&(s="blue"));const l=Object(o.c)((()=>r?Object(n.h)("div",{class:"space-y-2"},Object(n.h)(i.a,{id:"red",label:"Red",min:0,max:255,value:Math.floor(255*e[0]),setValue:r=>{t([r/255,e[1],e[2],e[3]])}}),Object(n.h)(i.a,{id:"green",label:"Green",min:0,max:255,value:Math.floor(255*e[1]),setValue:r=>{t([e[0],r/255,e[2],e[3]])}}),Object(n.h)(i.a,{id:"blue",label:"Blue",min:0,max:255,value:Math.floor(255*e[2]),setValue:r=>{t([e[0],e[1],r/255,e[3]])}})):null),[r,e,t]);return Object(n.h)("div",{class:""},Object(n.h)("select",{value:s,onChange:e=>{const r=e.currentTarget.value;if("custom"===r)return void a(!0);a(!1);t("red"===r?[1,0,0,1]:"green"===r?[0,1,0,1]:"blue"===r?[0,0,1,1]:[1,1,1,1])}},Object(n.h)("option",{value:"custom"},"(Custom)"),Object(n.h)("option",{value:"white"},"White"),Object(n.h)("option",{value:"red"},"Red"),Object(n.h)("option",{value:"green"},"Green"),Object(n.h)("option",{value:"blue"},"Blue")),l)}},IomO:function(e,t,r){"use strict";(function(e){var n=r("hosL"),o=r("QRet"),i=r("NOVX"),a=r("tpTz"),s=r("/dwh"),l=r("nF9+"),c=r("qiYd"),u=r("b2Zb");t.a=({modelControls:t,setModelControls:r,userSettings:f,setUserSettings:h,logoDefs:d,canvasRef:b})=>{const g=Object(o.c)((()=>Object(n.h)(i.a,{modelControls:t,setModelControls:r})),[t,r]),p=Object(o.c)((()=>Object(n.h)(s.a,{userSettings:f,setUserSettings:h})),[f,h]),v=Object(o.c)((()=>{const o=t.viewMode,i="regular"===o?Object(n.h)(l.a,{modelControls:t,setModelControls:r,logoDefs:d}):"solid_color"===o?Object(n.h)(c.a,{modelControls:t,setModelControls:r}):"wireframe"===o?Object(n.h)(u.a,{modelControls:t,setModelControls:r}):null;return Object(n.h)(e,null,Object(n.h)("div",{class:"text-center font-bold border-b border-gray-700 mb-2 pb-1 mt-6"},"View Mode Settings"),i)}),[t,r]);return Object(n.h)("div",{class:"max-h-full overflow-auto px-6"},Object(n.h)("div",{class:"text-center font-bold border-b border-gray-700 mb-2 pb-1"},"Controls"),g,v,Object(n.h)("div",{class:"text-center font-bold border-b border-gray-700 mb-2 pb-1 mt-6"},"User Settings"),p,Object(n.h)("div",{class:"text-center font-bold border-b border-gray-700 mb-2 pb-1 mt-6"},"Misc."),Object(n.h)(a.a,{modelControls:t,setModelControls:r,canvasRef:b,enableSaveImageButton:f.preserveDrawingBuffer}))}}).call(this,r("hosL").Fragment)},NOVX:function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r("hosL");const s=["regular","solid_color","wireframe"];var l=r("Xvsu");t.a=({modelControls:e,setModelControls:t})=>Object(a.h)("div",{class:"space-y-4"},Object(a.h)(l.a,{id:"zoom",label:"Zoom",max:1e3,value:e.zoom,setValue:r=>t(o(o({},e),{},{zoom:r}))}),Object(a.h)(l.a,{id:"rotationX",label:"Rotation X",min:-180,max:180,value:e.rotationX,setValue:r=>t(o(o({},e),{},{rotationX:r}))}),Object(a.h)(l.a,{id:"rotationY",label:"Rotation Y",min:-180,max:180,value:e.rotationY,setValue:r=>t(o(o({},e),{},{rotationY:r}))}),Object(a.h)(l.a,{id:"rotationZ",label:"Rotation Z",min:-180,max:180,value:e.rotationZ,setValue:r=>t(o(o({},e),{},{rotationZ:r}))}),Object(a.h)(l.a,{id:"panX",label:"Pan X",value:e.translationX,setValue:r=>t(o(o({},e),{},{translationX:r}))}),Object(a.h)(l.a,{id:"panY",label:"Pan Y",value:e.translationY,setValue:r=>t(o(o({},e),{},{translationY:r}))}),Object(a.h)("div",{class:"flex flex-col items-stretch"},Object(a.h)("label",{for:"viewMode"},"View Mode"),Object(a.h)("select",{id:"viewMode",value:e.viewMode,onChange:r=>{const n=s.find((e=>e===r.currentTarget.value));n&&t(o(o({},e),{},{viewMode:n}))}},Object(a.h)("option",{value:"regular"},"Regular"),Object(a.h)("option",{value:"solid_color"},"Solid Color"),Object(a.h)("option",{value:"wireframe"},"Wireframe"))),Object(a.h)("div",null,Object(a.h)("label",{class:"flex items-center space-x-2",title:"This is a temporary, band-aid solution to fix issues with Z-Fighting"},Object(a.h)("input",{type:"checkbox",checked:e.enableFaceCulling,onChange:r=>{t(o(o({},e),{},{enableFaceCulling:r.currentTarget.checked}))}}),Object(a.h)("span",null,"Enable face-culling"))))},"Pq/i":function(e,t,r){"use strict";r.r(t);var n=r("hosL");const{h:o,render:i,hydrate:a}=n,s=e=>e&&e.default?e.default:e,l=e=>"/"===e[e.length-1]?e:e+"/";if("serviceWorker"in navigator&&navigator.serviceWorker.register(l(r.p)+"sw-esm.js"),"function"==typeof s(r("qVkA"))){let e=document.getElementById("preact_root")||document.body.firstElementChild,t=()=>{let t=s(r("qVkA")),n={};const c=document.querySelector('[type="__PREACT_CLI_DATA__"]');c&&(n=JSON.parse(decodeURI(c.innerHTML)).preRenderData||n);const u={preRenderData:n},f=n.url?l(n.url):"";(a&&f===l(location.pathname)?a:i)(o(t,{CLI_DATA:u}),document.body,e)};0,t()}},QRet:function(e,t,r){"use strict";function n(e,t){_.options.__h&&_.options.__h(p,e,O||t),O=0;var r=p.__H||(p.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({__V:j}),r.__[e]}function o(e){return O=1,function(e,t,r){var o=n(g++,2);if(o.t=e,!o.__c&&(o.__=[r?r(t):b(void 0,t),function(e){var t=o.__N?o.__N[0]:o.__[0],r=o.t(t,e);t!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=p,!p.u)){p.u=!0;var i=p.shouldComponentUpdate;p.shouldComponentUpdate=function(e,t,r){if(!o.__c.__H)return!0;var n=o.__c.__H.__.filter((function(e){return e.__c}));if(n.every((function(e){return!e.__N})))return!i||i.call(this,e,t,r);var a=!1;return n.forEach((function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(a=!0)}})),!(!a&&o.__c.props===e)&&(!i||i.call(this,e,t,r))}}return o.__N||o.__}(b,e)}function i(e,t){var r=n(g++,3);!_.options.__s&&d(r.__H,t)&&(r.__=e,r.i=t,p.__H.__h.push(r))}function a(e){return O=5,s((function(){return{current:e}}),[])}function s(e,t){var r=n(g++,7);return d(r.__H,t)?(r.__V=e(),r.i=t,r.__h=e,r.__V):r.__}function l(e,t){return O=8,s((function(){return e}),t)}function c(){for(var e;e=y.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(f),e.__H.__h.forEach(h),e.__H.__h=[]}catch(t){e.__H.__h=[],_.options.__e(t,e.__v)}}function u(e){var t,r=function(){clearTimeout(n),P&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(r,100);P&&(t=requestAnimationFrame(r))}function f(e){var t=p,r=e.__c;"function"==typeof r&&(e.__c=void 0,r()),p=t}function h(e){var t=p;e.__c=e.__(),p=t}function d(e,t){return!e||e.length!==t.length||t.some((function(t,r){return t!==e[r]}))}function b(e,t){return"function"==typeof t?t(e):t}r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return a})),r.d(t,"e",(function(){return o}));var g,p,v,m,_=r("hosL"),O=0,y=[],j=[],x=_.options.__b,w=_.options.__r,M=_.options.diffed,S=_.options.__c,T=_.options.unmount;_.options.__b=function(e){p=null,x&&x(e)},_.options.__r=function(e){w&&w(e),g=0;var t=(p=e.__c).__H;t&&(v===p?(t.__h=[],p.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=j,e.__N=e.i=void 0}))):(t.__h.forEach(f),t.__h.forEach(h),t.__h=[])),v=p},_.options.diffed=function(e){M&&M(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==y.push(t)&&m===_.options.requestAnimationFrame||((m=_.options.requestAnimationFrame)||u)(c)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==j&&(e.__=e.__V),e.i=void 0,e.__V=j}))),v=p=null},_.options.__c=function(e,t){t.some((function(e){try{e.__h.forEach(f),e.__h=e.__h.filter((function(e){return!e.__||h(e)}))}catch(r){t.some((function(e){e.__h&&(e.__h=[])})),t=[],_.options.__e(r,e.__v)}})),S&&S(e,t)},_.options.unmount=function(e){T&&T(e);var t,r=e.__c;r&&r.__H&&(r.__H.__.forEach((function(e){try{f(e)}catch(e){t=e}})),r.__H=void 0,t&&_.options.__e(t,r.__v))};var P="function"==typeof requestAnimationFrame},Xvsu:function(e,t,r){"use strict";var n=r("hosL");t.a=({id:e,label:t,min:r,max:o,value:i,setValue:a})=>Object(n.h)("div",null,Object(n.h)("div",null,Object(n.h)("label",{for:e},t)),Object(n.h)("div",{class:"flex items-center space-x-2"},Object(n.h)("input",{type:"number",style:{width:"80px"},value:i,onChange:e=>{a(+e.currentTarget.value)}}),Object(n.h)("input",{class:"grow",type:"range",min:r,max:o,style:{width:"120px"},value:i,onChange:e=>{a(+e.currentTarget.value||0)}})))},b2Zb:function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r("hosL"),s=r("GssO");t.a=({modelControls:e,setModelControls:t})=>Object(a.h)("div",{class:"space-y-4"},Object(a.h)("div",null,Object(a.h)("div",{class:""},"Wireframe Color"),Object(a.h)(s.a,{color:e.wireframeColor,setColor:r=>t(o(o({},e),{},{wireframeColor:r}))})))},ejsI:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},hosL:function(e,t,r){"use strict";function n(e,t){for(var r in t)e[r]=t[r];return e}function o(e){var t=e.parentNode;t&&t.removeChild(e)}function i(e,t,r){var n,o,i,s={};for(i in t)"key"==i?n=t[i]:"ref"==i?o=t[i]:s[i]=t[i];if(arguments.length>2&&(s.children=arguments.length>3?U.call(arguments,2):r),"function"==typeof e&&null!=e.defaultProps)for(i in e.defaultProps)void 0===s[i]&&(s[i]=e.defaultProps[i]);return a(e,s,n,o,null)}function a(e,t,r,n,o){var i={type:e,props:t,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==o?++L:o};return null==o&&null!=D.vnode&&D.vnode(i),i}function s(){return{current:null}}function l(e){return e.children}function c(e,t){this.props=e,this.context=t}function u(e,t){if(null==t)return e.__?u(e.__,e.__.__k.indexOf(e)+1):null;for(var r;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e)return r.__e;return"function"==typeof e.type?u(e):null}function f(e){var t,r;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e){e.__e=e.__c.base=r.__e;break}return f(e)}}function h(e){(!e.__d&&(e.__d=!0)&&F.push(e)&&!d.__r++||A!==D.debounceRendering)&&((A=D.debounceRendering)||setTimeout)(d)}function d(){for(var e;d.__r=F.length;)e=F.sort((function(e,t){return e.__v.__b-t.__v.__b})),F=[],e.some((function(e){var t,r,o,i,a,s;e.__d&&(a=(i=(t=e).__v).__e,(s=t.__P)&&(r=[],(o=n({},i)).__v=i.__v+1,j(s,i,o,t.__n,void 0!==s.ownerSVGElement,null!=i.__h?[a]:null,r,null==a?u(i):a,i.__h),x(r,i),i.__e!=a&&f(i)))}))}function b(e,t,r,n,o,i,s,c,f,h){var d,b,p,m,_,O,y,x=n&&n.__k||N,w=x.length;for(r.__k=[],d=0;d<t.length;d++)if(null!=(m=r.__k[d]=null==(m=t[d])||"boolean"==typeof m?null:"string"==typeof m||"number"==typeof m||"bigint"==typeof m?a(null,m,null,null,m):Array.isArray(m)?a(l,{children:m},null,null,null):m.__b>0?a(m.type,m.props,m.key,m.ref?m.ref:null,m.__v):m)){if(m.__=r,m.__b=r.__b+1,null===(p=x[d])||p&&m.key==p.key&&m.type===p.type)x[d]=void 0;else for(b=0;b<w;b++){if((p=x[b])&&m.key==p.key&&m.type===p.type){x[b]=void 0;break}p=null}j(e,m,p=p||B,o,i,s,c,f,h),_=m.__e,(b=m.ref)&&p.ref!=b&&(y||(y=[]),p.ref&&y.push(p.ref,null,m),y.push(b,m.__c||_,m)),null!=_?(null==O&&(O=_),"function"==typeof m.type&&m.__k===p.__k?m.__d=f=g(m,f,e):f=v(e,m,p,x,_,f),"function"==typeof r.type&&(r.__d=f)):f&&p.__e==f&&f.parentNode!=e&&(f=u(p))}for(r.__e=O,d=w;d--;)null!=x[d]&&S(x[d],x[d]);if(y)for(d=0;d<y.length;d++)M(y[d],y[++d],y[++d])}function g(e,t,r){for(var n,o=e.__k,i=0;o&&i<o.length;i++)(n=o[i])&&(n.__=e,t="function"==typeof n.type?g(n,t,r):v(r,n,n,o,n.__e,t));return t}function p(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some((function(e){p(e,t)})):t.push(e)),t}function v(e,t,r,n,o,i){var a,s,l;if(void 0!==t.__d)a=t.__d,t.__d=void 0;else if(null==r||o!=i||null==o.parentNode)e:if(null==i||i.parentNode!==e)e.appendChild(o),a=null;else{for(s=i,l=0;(s=s.nextSibling)&&l<n.length;l+=1)if(s==o)break e;e.insertBefore(o,i),a=i}return void 0!==a?a:o.nextSibling}function m(e,t,r){"-"===t[0]?e.setProperty(t,r):e[t]=null==r?"":"number"!=typeof r||V.test(t)?r:r+"px"}function _(e,t,r,n,o){var i;e:if("style"===t)if("string"==typeof r)e.style.cssText=r;else{if("string"==typeof n&&(e.style.cssText=n=""),n)for(t in n)r&&t in r||m(e.style,t,"");if(r)for(t in r)n&&r[t]===n[t]||m(e.style,t,r[t])}else if("o"===t[0]&&"n"===t[1])i=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+i]=r,r?n||e.addEventListener(t,i?y:O,i):e.removeEventListener(t,i?y:O,i);else if("dangerouslySetInnerHTML"!==t){if(o)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==r?"":r;break e}catch(e){}"function"==typeof r||(null==r||!1===r&&-1==t.indexOf("-")?e.removeAttribute(t):e.setAttribute(t,r))}}function O(e){this.l[e.type+!1](D.event?D.event(e):e)}function y(e){this.l[e.type+!0](D.event?D.event(e):e)}function j(e,t,r,o,i,a,s,u,f){var h,d,g,p,v,m,_,O,y,j,x,M,S,P,E,C=t.type;if(void 0!==t.constructor)return null;null!=r.__h&&(f=r.__h,u=t.__e=r.__e,t.__h=null,a=[u]),(h=D.__b)&&h(t);try{e:if("function"==typeof C){if(O=t.props,y=(h=C.contextType)&&o[h.__c],j=h?y?y.props.value:h.__:o,r.__c?_=(d=t.__c=r.__c).__=d.__E:("prototype"in C&&C.prototype.render?t.__c=d=new C(O,j):(t.__c=d=new c(O,j),d.constructor=C,d.render=T),y&&y.sub(d),d.props=O,d.state||(d.state={}),d.context=j,d.__n=o,g=d.__d=!0,d.__h=[],d._sb=[]),null==d.__s&&(d.__s=d.state),null!=C.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=n({},d.__s)),n(d.__s,C.getDerivedStateFromProps(O,d.__s))),p=d.props,v=d.state,g)null==C.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==C.getDerivedStateFromProps&&O!==p&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(O,j),!d.__e&&null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(O,d.__s,j)||t.__v===r.__v){for(d.props=O,d.state=d.__s,t.__v!==r.__v&&(d.__d=!1),d.__v=t,t.__e=r.__e,t.__k=r.__k,t.__k.forEach((function(e){e&&(e.__=t)})),x=0;x<d._sb.length;x++)d.__h.push(d._sb[x]);d._sb=[],d.__h.length&&s.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(O,d.__s,j),null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(p,v,m)}))}if(d.context=j,d.props=O,d.__v=t,d.__P=e,M=D.__r,S=0,"prototype"in C&&C.prototype.render){for(d.state=d.__s,d.__d=!1,M&&M(t),h=d.render(d.props,d.state,d.context),P=0;P<d._sb.length;P++)d.__h.push(d._sb[P]);d._sb=[]}else do{d.__d=!1,M&&M(t),h=d.render(d.props,d.state,d.context),d.state=d.__s}while(d.__d&&++S<25);d.state=d.__s,null!=d.getChildContext&&(o=n(n({},o),d.getChildContext())),g||null==d.getSnapshotBeforeUpdate||(m=d.getSnapshotBeforeUpdate(p,v)),E=null!=h&&h.type===l&&null==h.key?h.props.children:h,b(e,Array.isArray(E)?E:[E],t,r,o,i,a,s,u,f),d.base=t.__e,t.__h=null,d.__h.length&&s.push(d),_&&(d.__E=d.__=null),d.__e=!1}else null==a&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=w(r.__e,t,r,o,i,a,s,f);(h=D.diffed)&&h(t)}catch(e){t.__v=null,(f||null!=a)&&(t.__e=u,t.__h=!!f,a[a.indexOf(u)]=null),D.__e(e,t,r)}}function x(e,t){D.__c&&D.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){D.__e(e,t.__v)}}))}function w(e,t,r,n,i,a,s,l){var c,f,h,d=r.props,g=t.props,p=t.type,v=0;if("svg"===p&&(i=!0),null!=a)for(;v<a.length;v++)if((c=a[v])&&"setAttribute"in c==!!p&&(p?c.localName===p:3===c.nodeType)){e=c,a[v]=null;break}if(null==e){if(null===p)return document.createTextNode(g);e=i?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,g.is&&g),a=null,l=!1}if(null===p)d===g||l&&e.data===g||(e.data=g);else{if(a=a&&U.call(e.childNodes),f=(d=r.props||B).dangerouslySetInnerHTML,h=g.dangerouslySetInnerHTML,!l){if(null!=a)for(d={},v=0;v<e.attributes.length;v++)d[e.attributes[v].name]=e.attributes[v].value;(h||f)&&(h&&(f&&h.__html==f.__html||h.__html===e.innerHTML)||(e.innerHTML=h&&h.__html||""))}if(function(e,t,r,n,o){var i;for(i in r)"children"===i||"key"===i||i in t||_(e,i,null,r[i],n);for(i in t)o&&"function"!=typeof t[i]||"children"===i||"key"===i||"value"===i||"checked"===i||r[i]===t[i]||_(e,i,t[i],r[i],n)}(e,g,d,i,l),h)t.__k=[];else if(v=t.props.children,b(e,Array.isArray(v)?v:[v],t,r,n,i&&"foreignObject"!==p,a,s,a?a[0]:r.__k&&u(r,0),l),null!=a)for(v=a.length;v--;)null!=a[v]&&o(a[v]);l||("value"in g&&void 0!==(v=g.value)&&(v!==e.value||"progress"===p&&!v||"option"===p&&v!==d.value)&&_(e,"value",v,d.value,!1),"checked"in g&&void 0!==(v=g.checked)&&v!==e.checked&&_(e,"checked",v,d.checked,!1))}return e}function M(e,t,r){try{"function"==typeof e?e(t):e.current=t}catch(e){D.__e(e,r)}}function S(e,t,r){var n,i;if(D.unmount&&D.unmount(e),(n=e.ref)&&(n.current&&n.current!==e.__e||M(n,null,t)),null!=(n=e.__c)){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(e){D.__e(e,t)}n.base=n.__P=null,e.__c=void 0}if(n=e.__k)for(i=0;i<n.length;i++)n[i]&&S(n[i],t,r||"function"!=typeof e.type);r||null==e.__e||o(e.__e),e.__=e.__e=e.__d=void 0}function T(e,t,r){return this.constructor(e,r)}function P(e,t,r){var n,o,a;D.__&&D.__(e,t),o=(n="function"==typeof r)?null:r&&r.__k||t.__k,a=[],j(t,e=(!n&&r||t).__k=i(l,null,[e]),o||B,B,void 0!==t.ownerSVGElement,!n&&r?[r]:o?null:t.firstChild?U.call(t.childNodes):null,a,!n&&r?r:o?o.__e:t.firstChild,n),x(a,e)}function E(e,t){P(e,t,E)}function C(e,t,r){var o,i,s,l=n({},e.props);for(s in t)"key"==s?o=t[s]:"ref"==s?i=t[s]:l[s]=t[s];return arguments.length>2&&(l.children=arguments.length>3?U.call(arguments,2):r),a(e.type,l,o||e.key,i||e.ref,null)}function R(e,t){var r={__c:t="__cC"+I++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var r,n;return this.getChildContext||(r=[],(n={})[t]=this,this.getChildContext=function(){return n},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&r.some(h)},this.sub=function(e){r.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){r.splice(r.indexOf(e),1),t&&t.call(e)}}),e.children}};return r.Provider.__=r.Consumer.contextType=r}r.r(t),r.d(t,"Component",(function(){return c})),r.d(t,"Fragment",(function(){return l})),r.d(t,"cloneElement",(function(){return C})),r.d(t,"createContext",(function(){return R})),r.d(t,"createElement",(function(){return i})),r.d(t,"createRef",(function(){return s})),r.d(t,"h",(function(){return i})),r.d(t,"hydrate",(function(){return E})),r.d(t,"isValidElement",(function(){return k})),r.d(t,"options",(function(){return D})),r.d(t,"render",(function(){return P})),r.d(t,"toChildArray",(function(){return p}));var U,D,L,k,F,A,I,B={},N=[],V=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;U=N.slice,D={__e:function(e,t,r,n){for(var o,i,a;t=t.__;)if((o=t.__c)&&!o.__)try{if((i=o.constructor)&&null!=i.getDerivedStateFromError&&(o.setState(i.getDerivedStateFromError(e)),a=o.__d),null!=o.componentDidCatch&&(o.componentDidCatch(e,n||{}),a=o.__d),a)return o.__E=o}catch(t){e=t}throw e}},L=0,k=function(e){return null!=e&&void 0===e.constructor},c.prototype.setState=function(e,t){var r;r=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=n({},this.state),"function"==typeof e&&(e=e(n({},r),this.props)),e&&n(r,e),null!=e&&this.__v&&(t&&this._sb.push(t),h(this))},c.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),h(this))},c.prototype.render=l,F=[],d.__r=0,I=0},"nF9+":function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r("hosL");const s=({htmlColor:e,isSelected:t,onSelect:r})=>Object(a.h)("button",{class:"w-8 h-8 border border-2 p-1 rounded-full flex justify-center items-center",style:{borderColor:e},onClick:()=>{t||r()}},Object(a.h)("span",{class:"w-full h-full rounded-full leading-none",style:{backgroundColor:t?e:""}}));t.a=({modelControls:e,setModelControls:t,logoDefs:r})=>Object(a.h)("div",{class:"space-y-4"},Object(a.h)("div",null,Object(a.h)("div",null,"Team Color"),Object(a.h)("div",{class:"flex flex-wrap -m-1 p-1"},r.idxList.map((n=>Object(a.h)("div",{key:n,class:"m-1"},Object(a.h)(s,{htmlColor:r.idxToHtmlColor(n),isSelected:e.logoColorIdx===n,onSelect:()=>t(o(o({},e),{},{logoColorIdx:n}))})))))),Object(a.h)("div",{class:"space-y-2"},Object(a.h)("div",null,Object(a.h)("div",null,"Texture Filter (Min.)"),Object(a.h)("select",{value:e.textureFilterMin,onChange:r=>{const n=r.currentTarget.value;t(o(o({},e),{},{textureFilterMin:n}))}},Object(a.h)("option",{value:"nearest"},"Nearest"),Object(a.h)("option",{value:"linear"},"Linear"))),Object(a.h)("div",null,Object(a.h)("div",null,"Texture Filter (Mag.)"),Object(a.h)("select",{value:e.textureFilterMag,onChange:r=>{const n=r.currentTarget.value;t(o(o({},e),{},{textureFilterMag:n}))}},Object(a.h)("option",{value:"nearest"},"Nearest"),Object(a.h)("option",{value:"linear"},"Linear")))),Object(a.h)("div",null,Object(a.h)("label",{class:"flex items-center"},Object(a.h)("input",{type:"checkbox",checked:e.enableLightingRegular,onChange:r=>{t(o(o({},e),{},{enableLightingRegular:r.currentTarget.checked}))}}),Object(a.h)("span",{class:"pl-1"},"Enable Lighting"))))},qVkA:function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e){Wt=e}function f(e){return e*zt}function h(e,t){return Math.abs(e-t)<=Yt*Math.max(1,Math.abs(e),Math.abs(t))}function d(){var e=new Wt(16);return Wt!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function b(e){var t=new Wt(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function g(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function p(e,t,r,n,o,i,a,s,l,c,u,f,h,d,b,g){var p=new Wt(16);return p[0]=e,p[1]=t,p[2]=r,p[3]=n,p[4]=o,p[5]=i,p[6]=a,p[7]=s,p[8]=l,p[9]=c,p[10]=u,p[11]=f,p[12]=h,p[13]=d,p[14]=b,p[15]=g,p}function v(e,t,r,n,o,i,a,s,l,c,u,f,h,d,b,g,p){return e[0]=t,e[1]=r,e[2]=n,e[3]=o,e[4]=i,e[5]=a,e[6]=s,e[7]=l,e[8]=c,e[9]=u,e[10]=f,e[11]=h,e[12]=d,e[13]=b,e[14]=g,e[15]=p,e}function m(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _(e,t){if(e===t){var r=t[1],n=t[2],o=t[3],i=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=i,e[11]=t[14],e[12]=o,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function O(e,t){var r=t[0],n=t[1],o=t[2],i=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],f=t[9],h=t[10],d=t[11],b=t[12],g=t[13],p=t[14],v=t[15],m=r*s-n*a,_=r*l-o*a,O=r*c-i*a,y=n*l-o*s,j=n*c-i*s,x=o*c-i*l,w=u*g-f*b,M=u*p-h*b,S=u*v-d*b,T=f*p-h*g,P=f*v-d*g,E=h*v-d*p,C=m*E-_*P+O*T+y*S-j*M+x*w;return C?(e[0]=(s*E-l*P+c*T)*(C=1/C),e[1]=(o*P-n*E-i*T)*C,e[2]=(g*x-p*j+v*y)*C,e[3]=(h*j-f*x-d*y)*C,e[4]=(l*S-a*E-c*M)*C,e[5]=(r*E-o*S+i*M)*C,e[6]=(p*O-b*x-v*_)*C,e[7]=(u*x-h*O+d*_)*C,e[8]=(a*P-s*S+c*w)*C,e[9]=(n*S-r*P-i*w)*C,e[10]=(b*j-g*O+v*m)*C,e[11]=(f*O-u*j-d*m)*C,e[12]=(s*M-a*T-l*w)*C,e[13]=(r*T-n*M+o*w)*C,e[14]=(g*_-b*y-p*m)*C,e[15]=(u*y-f*_+h*m)*C,e):null}function y(e,t){var r=t[0],n=t[1],o=t[2],i=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],f=t[9],h=t[10],d=t[11],b=t[12],g=t[13],p=t[14],v=t[15];return e[0]=s*(h*v-d*p)-f*(l*v-c*p)+g*(l*d-c*h),e[1]=-(n*(h*v-d*p)-f*(o*v-i*p)+g*(o*d-i*h)),e[2]=n*(l*v-c*p)-s*(o*v-i*p)+g*(o*c-i*l),e[3]=-(n*(l*d-c*h)-s*(o*d-i*h)+f*(o*c-i*l)),e[4]=-(a*(h*v-d*p)-u*(l*v-c*p)+b*(l*d-c*h)),e[5]=r*(h*v-d*p)-u*(o*v-i*p)+b*(o*d-i*h),e[6]=-(r*(l*v-c*p)-a*(o*v-i*p)+b*(o*c-i*l)),e[7]=r*(l*d-c*h)-a*(o*d-i*h)+u*(o*c-i*l),e[8]=a*(f*v-d*g)-u*(s*v-c*g)+b*(s*d-c*f),e[9]=-(r*(f*v-d*g)-u*(n*v-i*g)+b*(n*d-i*f)),e[10]=r*(s*v-c*g)-a*(n*v-i*g)+b*(n*c-i*s),e[11]=-(r*(s*d-c*f)-a*(n*d-i*f)+u*(n*c-i*s)),e[12]=-(a*(f*p-h*g)-u*(s*p-l*g)+b*(s*h-l*f)),e[13]=r*(f*p-h*g)-u*(n*p-o*g)+b*(n*h-o*f),e[14]=-(r*(s*p-l*g)-a*(n*p-o*g)+b*(n*l-o*s)),e[15]=r*(s*h-l*f)-a*(n*h-o*f)+u*(n*l-o*s),e}function j(e){var t=e[0],r=e[1],n=e[2],o=e[3],i=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=e[9],f=e[10],h=e[11],d=e[12],b=e[13],g=e[14],p=e[15];return(t*a-r*i)*(f*p-h*g)-(t*s-n*i)*(u*p-h*b)+(t*l-o*i)*(u*g-f*b)+(r*s-n*a)*(c*p-h*d)-(r*l-o*a)*(c*g-f*d)+(n*l-o*s)*(c*b-u*d)}function x(e,t,r){var n=t[0],o=t[1],i=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],f=t[8],h=t[9],d=t[10],b=t[11],g=t[12],p=t[13],v=t[14],m=t[15],_=r[0],O=r[1],y=r[2],j=r[3];return e[0]=_*n+O*s+y*f+j*g,e[1]=_*o+O*l+y*h+j*p,e[2]=_*i+O*c+y*d+j*v,e[3]=_*a+O*u+y*b+j*m,e[4]=(_=r[4])*n+(O=r[5])*s+(y=r[6])*f+(j=r[7])*g,e[5]=_*o+O*l+y*h+j*p,e[6]=_*i+O*c+y*d+j*v,e[7]=_*a+O*u+y*b+j*m,e[8]=(_=r[8])*n+(O=r[9])*s+(y=r[10])*f+(j=r[11])*g,e[9]=_*o+O*l+y*h+j*p,e[10]=_*i+O*c+y*d+j*v,e[11]=_*a+O*u+y*b+j*m,e[12]=(_=r[12])*n+(O=r[13])*s+(y=r[14])*f+(j=r[15])*g,e[13]=_*o+O*l+y*h+j*p,e[14]=_*i+O*c+y*d+j*v,e[15]=_*a+O*u+y*b+j*m,e}function w(e,t,r){var n,o,i,a,s,l,c,u,f,h,d,b,g=r[0],p=r[1],v=r[2];return t===e?(e[12]=t[0]*g+t[4]*p+t[8]*v+t[12],e[13]=t[1]*g+t[5]*p+t[9]*v+t[13],e[14]=t[2]*g+t[6]*p+t[10]*v+t[14],e[15]=t[3]*g+t[7]*p+t[11]*v+t[15]):(o=t[1],i=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],f=t[8],h=t[9],d=t[10],b=t[11],e[0]=n=t[0],e[1]=o,e[2]=i,e[3]=a,e[4]=s,e[5]=l,e[6]=c,e[7]=u,e[8]=f,e[9]=h,e[10]=d,e[11]=b,e[12]=n*g+s*p+f*v+t[12],e[13]=o*g+l*p+h*v+t[13],e[14]=i*g+c*p+d*v+t[14],e[15]=a*g+u*p+b*v+t[15]),e}function M(e,t,r){var n=r[0],o=r[1],i=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*o,e[5]=t[5]*o,e[6]=t[6]*o,e[7]=t[7]*o,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function S(e,t,r,n){var o,i,a,s,l,c,u,f,h,d,b,g,p,v,m,_,O,y,j,x,w,M,S,T,P=n[0],E=n[1],C=n[2],R=Math.hypot(P,E,C);return R<Yt?null:(P*=R=1/R,E*=R,C*=R,o=Math.sin(r),i=Math.cos(r),l=t[1],c=t[2],u=t[3],h=t[5],d=t[6],b=t[7],p=t[9],v=t[10],m=t[11],j=P*E*(a=1-i)-C*o,x=E*E*a+i,w=C*E*a+P*o,M=P*C*a+E*o,S=E*C*a-P*o,T=C*C*a+i,e[0]=(s=t[0])*(_=P*P*a+i)+(f=t[4])*(O=E*P*a+C*o)+(g=t[8])*(y=C*P*a-E*o),e[1]=l*_+h*O+p*y,e[2]=c*_+d*O+v*y,e[3]=u*_+b*O+m*y,e[4]=s*j+f*x+g*w,e[5]=l*j+h*x+p*w,e[6]=c*j+d*x+v*w,e[7]=u*j+b*x+m*w,e[8]=s*M+f*S+g*T,e[9]=l*M+h*S+p*T,e[10]=c*M+d*S+v*T,e[11]=u*M+b*S+m*T,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function T(e,t,r){var n=Math.sin(r),o=Math.cos(r),i=t[4],a=t[5],s=t[6],l=t[7],c=t[8],u=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*o+c*n,e[5]=a*o+u*n,e[6]=s*o+f*n,e[7]=l*o+h*n,e[8]=c*o-i*n,e[9]=u*o-a*n,e[10]=f*o-s*n,e[11]=h*o-l*n,e}function P(e,t,r){var n=Math.sin(r),o=Math.cos(r),i=t[0],a=t[1],s=t[2],l=t[3],c=t[8],u=t[9],f=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*o-c*n,e[1]=a*o-u*n,e[2]=s*o-f*n,e[3]=l*o-h*n,e[8]=i*n+c*o,e[9]=a*n+u*o,e[10]=s*n+f*o,e[11]=l*n+h*o,e}function E(e,t,r){var n=Math.sin(r),o=Math.cos(r),i=t[0],a=t[1],s=t[2],l=t[3],c=t[4],u=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*o+c*n,e[1]=a*o+u*n,e[2]=s*o+f*n,e[3]=l*o+h*n,e[4]=c*o-i*n,e[5]=u*o-a*n,e[6]=f*o-s*n,e[7]=h*o-l*n,e}function C(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function R(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function U(e,t,r){var n,o,i,a=r[0],s=r[1],l=r[2],c=Math.hypot(a,s,l);return c<Yt?null:(a*=c=1/c,s*=c,l*=c,n=Math.sin(t),o=Math.cos(t),e[0]=a*a*(i=1-o)+o,e[1]=s*a*i+l*n,e[2]=l*a*i-s*n,e[3]=0,e[4]=a*s*i-l*n,e[5]=s*s*i+o,e[6]=l*s*i+a*n,e[7]=0,e[8]=a*l*i+s*n,e[9]=s*l*i-a*n,e[10]=l*l*i+o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function D(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function L(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function k(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function F(e,t,r){var n=t[0],o=t[1],i=t[2],a=t[3],s=n+n,l=o+o,c=i+i,u=n*s,f=n*l,h=n*c,d=o*l,b=o*c,g=i*c,p=a*s,v=a*l,m=a*c;return e[0]=1-(d+g),e[1]=f+m,e[2]=h-v,e[3]=0,e[4]=f-m,e[5]=1-(u+g),e[6]=b+p,e[7]=0,e[8]=h+v,e[9]=b-p,e[10]=1-(u+d),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function A(e,t){var r=new Wt(3),n=-t[0],o=-t[1],i=-t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],f=n*n+o*o+i*i+a*a;return f>0?(r[0]=2*(s*a+u*n+l*i-c*o)/f,r[1]=2*(l*a+u*o+c*n-s*i)/f,r[2]=2*(c*a+u*i+s*o-l*n)/f):(r[0]=2*(s*a+u*n+l*i-c*o),r[1]=2*(l*a+u*o+c*n-s*i),r[2]=2*(c*a+u*i+s*o-l*n)),F(e,t,r),e}function I(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function B(e,t){var r=t[4],n=t[5],o=t[6],i=t[8],a=t[9],s=t[10];return e[0]=Math.hypot(t[0],t[1],t[2]),e[1]=Math.hypot(r,n,o),e[2]=Math.hypot(i,a,s),e}function N(e,t){var r=new Wt(3);B(r,t);var n=1/r[0],o=1/r[1],i=1/r[2],a=t[0]*n,s=t[1]*o,l=t[2]*i,c=t[4]*n,u=t[5]*o,f=t[6]*i,h=t[8]*n,d=t[9]*o,b=t[10]*i,g=a+u+b,p=0;return g>0?(p=2*Math.sqrt(g+1),e[3]=.25*p,e[0]=(f-d)/p,e[1]=(h-l)/p,e[2]=(s-c)/p):a>u&&a>b?(p=2*Math.sqrt(1+a-u-b),e[3]=(f-d)/p,e[0]=.25*p,e[1]=(s+c)/p,e[2]=(h+l)/p):u>b?(p=2*Math.sqrt(1+u-a-b),e[3]=(h-l)/p,e[0]=(s+c)/p,e[1]=.25*p,e[2]=(f+d)/p):(p=2*Math.sqrt(1+b-a-u),e[3]=(s-c)/p,e[0]=(h+l)/p,e[1]=(f+d)/p,e[2]=.25*p),e}function V(e,t,r,n){var o=t[0],i=t[1],a=t[2],s=t[3],l=o+o,c=i+i,u=a+a,f=o*l,h=o*c,d=o*u,b=i*c,g=i*u,p=a*u,v=s*l,m=s*c,_=s*u,O=n[0],y=n[1],j=n[2];return e[0]=(1-(b+p))*O,e[1]=(h+_)*O,e[2]=(d-m)*O,e[3]=0,e[4]=(h-_)*y,e[5]=(1-(f+p))*y,e[6]=(g+v)*y,e[7]=0,e[8]=(d+m)*j,e[9]=(g-v)*j,e[10]=(1-(f+b))*j,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function X(e,t,r,n,o){var i=t[0],a=t[1],s=t[2],l=t[3],c=i+i,u=a+a,f=s+s,h=i*c,d=i*u,b=i*f,g=a*u,p=a*f,v=s*f,m=l*c,_=l*u,O=l*f,y=n[0],j=n[1],x=n[2],w=o[0],M=o[1],S=o[2],T=(1-(g+v))*y,P=(d+O)*y,E=(b-_)*y,C=(d-O)*j,R=(1-(h+v))*j,U=(p+m)*j,D=(b+_)*x,L=(p-m)*x,k=(1-(h+g))*x;return e[0]=T,e[1]=P,e[2]=E,e[3]=0,e[4]=C,e[5]=R,e[6]=U,e[7]=0,e[8]=D,e[9]=L,e[10]=k,e[11]=0,e[12]=r[0]+w-(T*w+C*M+D*S),e[13]=r[1]+M-(P*w+R*M+L*S),e[14]=r[2]+S-(E*w+U*M+k*S),e[15]=1,e}function $(e,t){var r=t[0],n=t[1],o=t[2],i=t[3],a=r+r,s=n+n,l=o+o,c=r*a,u=n*a,f=n*s,h=o*a,d=o*s,b=o*l,g=i*a,p=i*s,v=i*l;return e[0]=1-f-b,e[1]=u+v,e[2]=h-p,e[3]=0,e[4]=u-v,e[5]=1-c-b,e[6]=d+g,e[7]=0,e[8]=h+p,e[9]=d-g,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Y(e,t,r,n,o,i,a){var s=1/(r-t),l=1/(o-n),c=1/(i-a);return e[0]=2*i*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*i*l,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(o+n)*l,e[10]=(a+i)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*i*2*c,e[15]=0,e}function W(e,t,r,n,o){var i,a=1/Math.tan(t/2);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=o&&o!==1/0?(e[10]=(o+n)*(i=1/(n-o)),e[14]=2*o*n*i):(e[10]=-1,e[14]=-2*n),e}function H(e,t,r,n,o){var i,a=1/Math.tan(t/2);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=o&&o!==1/0?(e[10]=o*(i=1/(n-o)),e[14]=o*n*i):(e[10]=-1,e[14]=-n),e}function z(e,t,r,n){var o=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+s),c=2/(o+i);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-s)*l*.5,e[9]=(o-i)*c*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function G(e,t,r,n,o,i,a){var s=1/(t-r),l=1/(n-o),c=1/(i-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*s,e[13]=(o+n)*l,e[14]=(a+i)*c,e[15]=1,e}function q(e,t,r,n,o,i,a){var s=1/(t-r),l=1/(n-o),c=1/(i-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=c,e[11]=0,e[12]=(t+r)*s,e[13]=(o+n)*l,e[14]=i*c,e[15]=1,e}function Z(e,t,r,n){var o,i,a,s,l,c,u,f,h,d,b=t[0],g=t[1],p=t[2],v=n[0],_=n[1],O=n[2],y=r[0],j=r[1],x=r[2];return Math.abs(b-y)<Yt&&Math.abs(g-j)<Yt&&Math.abs(p-x)<Yt?m(e):(u=b-y,f=g-j,h=p-x,o=_*(h*=d=1/Math.hypot(u,f,h))-O*(f*=d),i=O*(u*=d)-v*h,a=v*f-_*u,(d=Math.hypot(o,i,a))?(o*=d=1/d,i*=d,a*=d):(o=0,i=0,a=0),s=f*a-h*i,l=h*o-u*a,c=u*i-f*o,(d=Math.hypot(s,l,c))?(s*=d=1/d,l*=d,c*=d):(s=0,l=0,c=0),e[0]=o,e[1]=s,e[2]=u,e[3]=0,e[4]=i,e[5]=l,e[6]=f,e[7]=0,e[8]=a,e[9]=c,e[10]=h,e[11]=0,e[12]=-(o*b+i*g+a*p),e[13]=-(s*b+l*g+c*p),e[14]=-(u*b+f*g+h*p),e[15]=1,e)}function K(e,t,r,n){var o=t[0],i=t[1],a=t[2],s=n[0],l=n[1],c=n[2],u=o-r[0],f=i-r[1],h=a-r[2],d=u*u+f*f+h*h;d>0&&(u*=d=1/Math.sqrt(d),f*=d,h*=d);var b=l*h-c*f,g=c*u-s*h,p=s*f-l*u;return(d=b*b+g*g+p*p)>0&&(b*=d=1/Math.sqrt(d),g*=d,p*=d),e[0]=b,e[1]=g,e[2]=p,e[3]=0,e[4]=f*p-h*g,e[5]=h*b-u*p,e[6]=u*g-f*b,e[7]=0,e[8]=u,e[9]=f,e[10]=h,e[11]=0,e[12]=o,e[13]=i,e[14]=a,e[15]=1,e}function Q(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function J(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function ee(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function te(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function re(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function ne(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function oe(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function ie(e,t){var r=e[0],n=e[1],o=e[2],i=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],f=e[9],h=e[10],d=e[11],b=e[12],g=e[13],p=e[14],v=e[15],m=t[0],_=t[1],O=t[2],y=t[3],j=t[4],x=t[5],w=t[6],M=t[7],S=t[8],T=t[9],P=t[10],E=t[11],C=t[12],R=t[13],U=t[14],D=t[15];return Math.abs(r-m)<=Yt*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(n-_)<=Yt*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(o-O)<=Yt*Math.max(1,Math.abs(o),Math.abs(O))&&Math.abs(i-y)<=Yt*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(a-j)<=Yt*Math.max(1,Math.abs(a),Math.abs(j))&&Math.abs(s-x)<=Yt*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(l-w)<=Yt*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(c-M)<=Yt*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(u-S)<=Yt*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(f-T)<=Yt*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(h-P)<=Yt*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(d-E)<=Yt*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(b-C)<=Yt*Math.max(1,Math.abs(b),Math.abs(C))&&Math.abs(g-R)<=Yt*Math.max(1,Math.abs(g),Math.abs(R))&&Math.abs(p-U)<=Yt*Math.max(1,Math.abs(p),Math.abs(U))&&Math.abs(v-D)<=Yt*Math.max(1,Math.abs(v),Math.abs(D))}function ae(){var e=new Wt(3);return Wt!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function se(e){var t=new Wt(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function le(e){return Math.hypot(e[0],e[1],e[2])}function ce(e,t,r){var n=new Wt(3);return n[0]=e,n[1]=t,n[2]=r,n}function ue(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function fe(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function he(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function de(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function be(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function ge(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function pe(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function ve(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function me(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function _e(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function Oe(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function ye(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function je(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function xe(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2])}function we(e,t){var r=t[0]-e[0],n=t[1]-e[1],o=t[2]-e[2];return r*r+n*n+o*o}function Me(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function Se(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function Te(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Pe(e,t){var r=t[0],n=t[1],o=t[2],i=r*r+n*n+o*o;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function Ee(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Ce(e,t,r){var n=t[0],o=t[1],i=t[2],a=r[0],s=r[1],l=r[2];return e[0]=o*l-i*s,e[1]=i*a-n*l,e[2]=n*s-o*a,e}function Re(e,t,r,n){var o=t[0],i=t[1],a=t[2];return e[0]=o+n*(r[0]-o),e[1]=i+n*(r[1]-i),e[2]=a+n*(r[2]-a),e}function Ue(e,t,r,n,o,i){var a=i*i,s=a*(2*i-3)+1,l=a*(i-2)+i,c=a*(i-1),u=a*(3-2*i);return e[0]=t[0]*s+r[0]*l+n[0]*c+o[0]*u,e[1]=t[1]*s+r[1]*l+n[1]*c+o[1]*u,e[2]=t[2]*s+r[2]*l+n[2]*c+o[2]*u,e}function De(e,t,r,n,o,i){var a=1-i,s=a*a,l=i*i,c=s*a,u=3*i*s,f=3*l*a,h=l*i;return e[0]=t[0]*c+r[0]*u+n[0]*f+o[0]*h,e[1]=t[1]*c+r[1]*u+n[1]*f+o[1]*h,e[2]=t[2]*c+r[2]*u+n[2]*f+o[2]*h,e}function Le(e,t){t=t||1;var r=2*Ht()*Math.PI,n=2*Ht()-1,o=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*o,e[1]=Math.sin(r)*o,e[2]=n*t,e}function ke(e,t,r){var n=t[0],o=t[1],i=t[2],a=r[3]*n+r[7]*o+r[11]*i+r[15];return e[0]=(r[0]*n+r[4]*o+r[8]*i+r[12])/(a=a||1),e[1]=(r[1]*n+r[5]*o+r[9]*i+r[13])/a,e[2]=(r[2]*n+r[6]*o+r[10]*i+r[14])/a,e}function Fe(e,t,r){var n=t[0],o=t[1],i=t[2];return e[0]=n*r[0]+o*r[3]+i*r[6],e[1]=n*r[1]+o*r[4]+i*r[7],e[2]=n*r[2]+o*r[5]+i*r[8],e}function Ae(e,t,r){var n=r[0],o=r[1],i=r[2],a=t[0],s=t[1],l=t[2],c=o*l-i*s,u=i*a-n*l,f=n*s-o*a,h=o*f-i*u,d=i*c-n*f,b=n*u-o*c,g=2*r[3];return u*=g,f*=g,d*=2,b*=2,e[0]=a+(c*=g)+(h*=2),e[1]=s+u+d,e[2]=l+f+b,e}function Ie(e,t,r,n){var o=[],i=[];return o[0]=t[0]-r[0],o[1]=t[1]-r[1],o[2]=t[2]-r[2],i[0]=o[0],i[1]=o[1]*Math.cos(n)-o[2]*Math.sin(n),i[2]=o[1]*Math.sin(n)+o[2]*Math.cos(n),e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e}function Be(e,t,r,n){var o=[],i=[];return o[0]=t[0]-r[0],o[1]=t[1]-r[1],o[2]=t[2]-r[2],i[0]=o[2]*Math.sin(n)+o[0]*Math.cos(n),i[1]=o[1],i[2]=o[2]*Math.cos(n)-o[0]*Math.sin(n),e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e}function Ne(e,t,r,n){var o=[],i=[];return o[0]=t[0]-r[0],o[1]=t[1]-r[1],o[2]=t[2]-r[2],i[0]=o[0]*Math.cos(n)-o[1]*Math.sin(n),i[1]=o[0]*Math.sin(n)+o[1]*Math.cos(n),i[2]=o[2],e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e}function Ve(e,t){var r=e[0],n=e[1],o=e[2],i=t[0],a=t[1],s=t[2],l=Math.sqrt(r*r+n*n+o*o)*Math.sqrt(i*i+a*a+s*s),c=l&&Ee(e,t)/l;return Math.acos(Math.min(Math.max(c,-1),1))}function Xe(e){return e[0]=0,e[1]=0,e[2]=0,e}function $e(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Ye(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function We(e,t){var r=e[0],n=e[1],o=e[2],i=t[0],a=t[1],s=t[2];return Math.abs(r-i)<=Yt*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=Yt*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(o-s)<=Yt*Math.max(1,Math.abs(o),Math.abs(s))}function He(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ze(e){return 0==(e&e-1)}function Ge(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qe(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ze(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ke(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qe(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Je(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function et(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tt(e,t,r){const n=t.vertices.flatMap((e=>e)),o=new pr(e.getGl(),e.getProgramInfo().attribLocations.vertexPosition);o.bufferData(pr.createBufferSourceFromPositions(n));const i=t.indices.map((e=>{if(e<0||e>t.vertices.length-1)throw`Index out of bounds: ${e}`;return e})),a=new dr(e.getGl());let s,l;if(a.bufferData(dr.createBufferSourceFromIndices(i)),r){const r=[];for(let e=0;e<t.vertices.length;e++)r[e]=St.create();for(let e=0;e<i.length;e+=3){const n=i[e+0],o=i[e+1],a=i[e+2],s=St.fromValues(...t.vertices[n]),l=St.fromValues(...t.vertices[o]),c=St.fromValues(...t.vertices[a]),u=St.sub(St.create(),l,s),f=St.sub(St.create(),c,s),h=St.cross(St.create(),u,f);St.add(r[n],r[n],h),St.add(r[o],r[o],h),St.add(r[a],r[a],h)}for(let e=0;e<t.vertices.length;e++)St.normalize(r[e],r[e]);s=new gr(e.getGl(),e.getProgramInfo().attribLocations.vertexNormal),s.bufferData(gr.createBufferSourceFromPositions(r.flatMap((e=>[e[0],e[1],e[2]]))))}return t.texCoords&&(l=new vr(e.getGl(),e.getProgramInfo().attribLocations.textureCoord),l.bufferData(vr.createBufferSourceFromCoords(t.texCoords))),new mr(o,a,s,l)}function rt(e,t,r,n,o,i,a){const s=new fr(null,"WRAPPER:"+t.name);s.translate(t.xOffset*Or,t.yOffset*Or,t.zOffset*Or);const l=[];for(const r of t.primitives){const n=nt(e,t.vertices,r,o,i,a);null!==n&&(a&&Nt.validateTextureName(r.textureName)&&n.setTextureKey(r.textureName),l.push(n))}const c=new fr(l,t.name);s.addChild(c),n.set(t,c);for(const r of t.children)rt(e,r,c,n,o,i,a);r.addChild(s)}function nt(e,t,r,n,o,i){const a=r.vertexIndices.map((e=>{const r=t[e];return[r.x*Or,r.y*Or,r.z*Or]}));if(3===r.vertexIndices.length){return _r.createModelFromIndexedVertices(e,{vertices:a,indices:[0,1,2],texCoords:i?[0,0,0,1,1,1]:null},o)}if(4===r.vertexIndices.length){return _r.createModelFromIndexedVertices(e,{vertices:a,indices:n?[0,1,2,0,2,3]:[0,1,2,3],texCoords:i&&n?[0,0,1,0,1,1,0,1]:null},o)}return null}function ot(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function it(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function at(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function st(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?at(Object(r),!0).forEach((function(t){lt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):at(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function lt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ct(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ut(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(r),!0).forEach((function(t){ft(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ft(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ht(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function dt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(r),!0).forEach((function(t){bt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ht(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function bt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(r),!0).forEach((function(t){vt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function vt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mt(e){const t=new Map,r=e=>{t.set(e,{highlight:!1,hide:!1});for(const t of e.children)r(t)};for(const t of e.rootNodes)r(t);return t}function _t(e){return Object.values(e).every((e=>null===e))?"wireframe":void 0}function Ot(e){const t="string"==typeof e?e.replace(/^.*[\\\/]/,""):e.name;return t.startsWith("ara")?3:t.startsWith("tar")?1:t.startsWith("ver")?0:t.startsWith("zon")?7:t.startsWith("cre")?6:void 0}function yt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function jt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(r),!0).forEach((function(t){xt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function xt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.r(t);var wt={};r.r(wt),r.d(wt,"EPSILON",(function(){return Yt})),r.d(wt,"ARRAY_TYPE",(function(){return Wt})),r.d(wt,"RANDOM",(function(){return Ht})),r.d(wt,"setMatrixArrayType",(function(){return u})),r.d(wt,"toRadian",(function(){return f})),r.d(wt,"equals",(function(){return h}));var Mt={};r.r(Mt),r.d(Mt,"create",(function(){return d})),r.d(Mt,"clone",(function(){return b})),r.d(Mt,"copy",(function(){return g})),r.d(Mt,"fromValues",(function(){return p})),r.d(Mt,"set",(function(){return v})),r.d(Mt,"identity",(function(){return m})),r.d(Mt,"transpose",(function(){return _})),r.d(Mt,"invert",(function(){return O})),r.d(Mt,"adjoint",(function(){return y})),r.d(Mt,"determinant",(function(){return j})),r.d(Mt,"multiply",(function(){return x})),r.d(Mt,"translate",(function(){return w})),r.d(Mt,"scale",(function(){return M})),r.d(Mt,"rotate",(function(){return S})),r.d(Mt,"rotateX",(function(){return T})),r.d(Mt,"rotateY",(function(){return P})),r.d(Mt,"rotateZ",(function(){return E})),r.d(Mt,"fromTranslation",(function(){return C})),r.d(Mt,"fromScaling",(function(){return R})),r.d(Mt,"fromRotation",(function(){return U})),r.d(Mt,"fromXRotation",(function(){return D})),r.d(Mt,"fromYRotation",(function(){return L})),r.d(Mt,"fromZRotation",(function(){return k})),r.d(Mt,"fromRotationTranslation",(function(){return F})),r.d(Mt,"fromQuat2",(function(){return A})),r.d(Mt,"getTranslation",(function(){return I})),r.d(Mt,"getScaling",(function(){return B})),r.d(Mt,"getRotation",(function(){return N})),r.d(Mt,"fromRotationTranslationScale",(function(){return V})),r.d(Mt,"fromRotationTranslationScaleOrigin",(function(){return X})),r.d(Mt,"fromQuat",(function(){return $})),r.d(Mt,"frustum",(function(){return Y})),r.d(Mt,"perspectiveNO",(function(){return W})),r.d(Mt,"perspective",(function(){return qt})),r.d(Mt,"perspectiveZO",(function(){return H})),r.d(Mt,"perspectiveFromFieldOfView",(function(){return z})),r.d(Mt,"orthoNO",(function(){return G})),r.d(Mt,"ortho",(function(){return Zt})),r.d(Mt,"orthoZO",(function(){return q})),r.d(Mt,"lookAt",(function(){return Z})),r.d(Mt,"targetTo",(function(){return K})),r.d(Mt,"str",(function(){return Q})),r.d(Mt,"frob",(function(){return J})),r.d(Mt,"add",(function(){return ee})),r.d(Mt,"subtract",(function(){return te})),r.d(Mt,"multiplyScalar",(function(){return re})),r.d(Mt,"multiplyScalarAndAdd",(function(){return ne})),r.d(Mt,"exactEquals",(function(){return oe})),r.d(Mt,"equals",(function(){return ie})),r.d(Mt,"mul",(function(){return Kt})),r.d(Mt,"sub",(function(){return Qt}));var St={};r.r(St),r.d(St,"create",(function(){return ae})),r.d(St,"clone",(function(){return se})),r.d(St,"length",(function(){return le})),r.d(St,"fromValues",(function(){return ce})),r.d(St,"copy",(function(){return ue})),r.d(St,"set",(function(){return fe})),r.d(St,"add",(function(){return he})),r.d(St,"subtract",(function(){return de})),r.d(St,"multiply",(function(){return be})),r.d(St,"divide",(function(){return ge})),r.d(St,"ceil",(function(){return pe})),r.d(St,"floor",(function(){return ve})),r.d(St,"min",(function(){return me})),r.d(St,"max",(function(){return _e})),r.d(St,"round",(function(){return Oe})),r.d(St,"scale",(function(){return ye})),r.d(St,"scaleAndAdd",(function(){return je})),r.d(St,"distance",(function(){return xe})),r.d(St,"squaredDistance",(function(){return we})),r.d(St,"squaredLength",(function(){return Me})),r.d(St,"negate",(function(){return Se})),r.d(St,"inverse",(function(){return Te})),r.d(St,"normalize",(function(){return Pe})),r.d(St,"dot",(function(){return Ee})),r.d(St,"cross",(function(){return Ce})),r.d(St,"lerp",(function(){return Re})),r.d(St,"hermite",(function(){return Ue})),r.d(St,"bezier",(function(){return De})),r.d(St,"random",(function(){return Le})),r.d(St,"transformMat4",(function(){return ke})),r.d(St,"transformMat3",(function(){return Fe})),r.d(St,"transformQuat",(function(){return Ae})),r.d(St,"rotateX",(function(){return Ie})),r.d(St,"rotateY",(function(){return Be})),r.d(St,"rotateZ",(function(){return Ne})),r.d(St,"angle",(function(){return Ve})),r.d(St,"zero",(function(){return Xe})),r.d(St,"str",(function(){return $e})),r.d(St,"exactEquals",(function(){return Ye})),r.d(St,"equals",(function(){return We})),r.d(St,"sub",(function(){return Jt})),r.d(St,"mul",(function(){return er})),r.d(St,"div",(function(){return tr})),r.d(St,"dist",(function(){return rr})),r.d(St,"sqrDist",(function(){return nr})),r.d(St,"len",(function(){return or})),r.d(St,"sqrLen",(function(){return ir})),r.d(St,"forEach",(function(){return ar}));var Tt=r("hosL"),Pt=r("QRet");const Et={sidebarPosition:"right",sidebarWidth:300,defaultTextureFilterMin:"nearest",defaultTextureFilterMag:"nearest",preserveDrawingBuffer:!0},Ct={save:e=>{const t=JSON.stringify(e);localStorage.setItem("user",t)},load:()=>{const e=localStorage.getItem("user");if(null===e)return;const t=JSON.parse(e);if("object"!=typeof t)throw new Error("User settings is not an object");const r=t.sidebarPosition;if("left"!==r&&"right"!==r)throw new Error("Invalid sidebarPosition");const n=t.sidebarWidth;if("number"!=typeof n)throw new Error("Invalid sidebarWidth");const o=t.defaultTextureFilterMin;if("nearest"!==o&&"linear"!==o)throw new Error("Invalid defaultTextureFilterMin");const i=t.defaultTextureFilterMag;if("nearest"!==i&&"linear"!==i)throw new Error("Invalid defaultTextureFilterMag");let a=t.preserveDrawingBuffer;return"boolean"!=typeof a&&(a=Et.preserveDrawingBuffer),{sidebarPosition:r,sidebarWidth:n,defaultTextureFilterMin:o,defaultTextureFilterMag:i,preserveDrawingBuffer:a}}},Rt={rotationX:50,rotationY:-150,rotationZ:0,translationX:0,translationY:0,zoom:900,viewMode:"regular",viewColor:[1,1,1,1],canvasBackground:"black",canvasBackgroundSize:"auto",canvasBackgroundRepeat:"repeat",enableFaceCulling:!1,enableLightingRegular:!1,logoColorIdx:0,textureFilterMin:"linear",textureFilterMag:"linear",enableLightingSolidColor:!0,solidColor:[1,1,1,1],wireframeColor:[1,1,1,1]};var Ut=({title:e,children:t,showByDefault:r})=>{const[n,o]=Object(Pt.e)(null!=r&&r),i=n?Object(Tt.h)("div",null,t):null,a=Object(Tt.h)("button",{onClick:()=>o(!n)},n?"[Hide]":"[Show]");return Object(Tt.h)("div",null,Object(Tt.h)("div",{class:"flex justify-between space-x-2"},Object(Tt.h)("span",null,e),a),i)};const Dt=["aradrag.3do","tardrag.3do","verdrag.3do","zondrag.3do","creaeri.3do","aralode.3do","araking.3do","cresage.3do","tarnecro.3do","vermage.3do","zonhunt.3do"].map((e=>({name:e,path:"assets/3do-samples/"+e}))),Lt="https://github.com/takingdoms/3do-viewer-preact/issues",kt="border border-gray-700 px-2 py-0.5 hover:text-yellow-500 focus:text-yellow-500";var Ft=({onSubmit:e,defaultUserSettings:t,setDefaultUserSettings:r})=>{const n=Object(Pt.c)((()=>Object(Tt.h)("div",{class:"text-sm"},Object(Tt.h)("h3",{class:"text-base font-bold"},"Controls:"),Object(Tt.h)("p",null,Object(Tt.h)("u",null,"Left mouse button:")," hold and drag to rotate the model."),Object(Tt.h)("p",null,Object(Tt.h)("u",null,"Middle mouse button:")," hold and drag to move the model."),Object(Tt.h)("p",null,Object(Tt.h)("u",null,"Mouse wheel:")," zoom in or out."))),[]),i=Object(Pt.c)((()=>Object(Tt.h)("div",{class:"text-sm"},Object(Tt.h)("h3",{class:"text-base font-bold"},"About:"),Object(Tt.h)("p",null,"Submit suggestions or problems at: ",Object(Tt.h)("a",{class:"text-sky-500 hover:text-sky-700 focus:text-sky-700 hover:underline focus:underline",href:Lt,target:"_blank"},Lt)),Object(Tt.h)("p",null,"...or message spagg#2962 on Discord."))),[]),a=Object(Pt.c)((()=>Object(Tt.h)("form",{class:"px-4 py-2 border border-4 border-gray-600 rounded h-full",onSubmit:t=>{t.preventDefault();const r=new FormData(t.currentTarget).get("file");r&&r.size&&r.name&&e(r)}},Object(Tt.h)("div",{class:"text-3xl text-center mb-4"},"Option 1"),Object(Tt.h)("div",{class:"text-xl text-gray-400 mb-2"},"Load your own file"),Object(Tt.h)("div",{className:"flex items-stretch space-x-2"},Object(Tt.h)("input",{name:"file",type:"file",class:"grow border border-gray-700"}),Object(Tt.h)("button",{class:kt,type:"submit"},"GO")))),[e]),s=Object(Pt.c)((()=>Object(Tt.h)("form",{class:"px-4 py-2 border border-4 border-gray-600 rounded h-full",onSubmit:t=>{var r;t.preventDefault();const n=null===(r=new FormData(t.currentTarget).get("sample"))||void 0===r?void 0:r.toString().trim();n&&e(n)}},Object(Tt.h)("div",{class:"text-3xl text-center mb-4"},"Option 2"),Object(Tt.h)("div",{class:"text-xl text-gray-400 mb-2"},"Pick a sample file"),Object(Tt.h)("div",{className:"flex items-stretch space-x-2"},Object(Tt.h)("select",{name:"sample",class:"grow border border-gray-700"},Object(Tt.h)("option",{value:""}),Dt.map(((e,t)=>Object(Tt.h)("option",{value:e.path,key:t},e.name)))),Object(Tt.h)("button",{class:kt,type:"submit"},"GO")))),[e]),l=Object(Pt.c)((()=>Object(Tt.h)(Ut,{title:"Advanced"},Object(Tt.h)("div",{class:"space-y-2"},Object(Tt.h)("div",null,Object(Tt.h)("label",{class:"flex items-center"},Object(Tt.h)("input",{type:"checkbox",checked:t.preserveDrawingBuffer,onChange:e=>{r(o(o({},t),{},{preserveDrawingBuffer:e.currentTarget.checked}))}}),Object(Tt.h)("span",{class:"font-bold ml-2"},"WebGL / Preserve Drawing Buffer")),Object(Tt.h)("span",{class:"text-gray-300 text-sm"},'Disable this only if the model rendering is lagging (might not even change anything).\n            Disabling this will also disable the "Save Model Image" button and the ability to\n            "Right click > Save Image As"'))))),[t,r]);return Object(Tt.h)("div",{class:"min-w-screen min-h-screen bg-gray-800 flex flex-col justify-center items-center"},Object(Tt.h)("div",{style:{maxWidth:800},class:"container flex justify-center items-stretch\r flex-col-reverse md:flex-col"},Object(Tt.h)("div",{class:"flex flex-wrap items-stretch"},Object(Tt.h)("div",{class:"flex-1 p-4",style:{minWidth:300}},n),Object(Tt.h)("div",{class:"flex-1 p-4",style:{minWidth:300}},i)),Object(Tt.h)("div",{class:"flex flex-wrap items-stretch"},Object(Tt.h)("div",{class:"flex-1 p-4"},a),Object(Tt.h)("div",{class:"flex-1 p-4"},s)),Object(Tt.h)("div",{class:"mt-8 self-center"},l)))},At=r("/u4b");const It={defaultIdx:0,idxList:Array.from({length:10}).map(((e,t)=>t)),idxCount:10,idxToName:e=>e.toString(),idxToHtmlColor:e=>Bt[e],textureKeyUsesLogo:e=>e.toLowerCase().includes("logo"),idxToTextureKey:(e,t)=>0===e?t:`${t}/color:${e}`,idxToTextureFilename:(e,t)=>0===e?t:`${t}.${e}`},Bt={0:"lightblue",1:"red",2:"white",3:"green",4:"darkblue",5:"purple",6:"yellow",7:"black",8:"orange",9:"brown"},Nt={compareObjectsShallow:function(e,t){const r=Object.entries(e),n=Object.keys(t);return r.length===n.length&&r.every((([e,r])=>e in t&&t[e]===r))},createUpdatedMap:function(e,t,r){const n=new Map(e);return n.set(t,r),n},validateTextureName:function(e){return/^(?!^(?:COM|PRN|AUX|NUL|CON|CLOCK\$)(?:\..+)?$)[^\s\\/:\*\?\"<>\|\x00-\x1F\x7F]{1,254}$/.test(e)}};class Vt{constructor(e){l(this,"config",void 0),l(this,"resizeObserver",void 0),l(this,"cleanupEvents",void 0),this.config=e}setupEvents(){const{listener:e,canvas:t,mode:r}=this.config;let n,o,i,a,l,c=!1;const u=e=>{if(void 0===n){if(0===e.button)n="rotate";else{if(1!==e.button)return;n="pan"}o=e.clientX,i=e.clientY,a="rotate"===n?this.config.modelControls.rotationX:this.config.modelControls.translationX,l="rotate"===n?this.config.modelControls.rotationY:this.config.modelControls.translationY}},f=e=>{if(void 0===o||void 0===i||void 0===a||void 0===l)return;const t=Math.round(.75*(e.clientX-o)),s=Math.round(.75*(e.clientY-i));if(0!==t||0!==s){if(0!==t)if("rotate"===n){let e=l+t;for(;e>180;)e-=360;for(;e<-180;)e+=360;this.config.modelControls.rotationY=e}else this.config.modelControls.translationX=a+t;if(0!==s)if("rotate"===n){let e=a+s;for(;e>180;)e-=360;for(;e<-180;)e+=360;this.config.modelControls.rotationX=e}else this.config.modelControls.translationY=l+s;c=!0,"static"===r&&this.render()}},h=()=>{n=o=i=a=l=void 0,c&&(e.onModelControlsChanged(s({},this.config.modelControls)),c=!1)},d=()=>{"hidden"===document.visibilityState&&h()},b=t=>{0!==t.deltaY&&(this.config.modelControls.zoom+=t.deltaY,"static"===this.config.mode&&this.render(),e.onModelControlsChanged(s({},this.config.modelControls)))};t.addEventListener("mousedown",u),t.addEventListener("mousemove",f),window.addEventListener("mouseup",h),document.addEventListener("visibilitychange",d),t.addEventListener("wheel",b),this.cleanupEvents=()=>{t.removeEventListener("mousedown",u),t.removeEventListener("mousedown",f),window.removeEventListener("mouseup",h),document.removeEventListener("visibilitychange",d),t.removeEventListener("wheel",b)};const g=()=>{const e=t.parentElement;if(!e)throw new Error("Canvas has no parent!!");const r=e.clientWidth,n=e.clientHeight;let o=!1;return t.width!==r&&(t.width=r,o=!0),t.height!==n&&(t.height=n,o=!0),!!o&&(this.onResized(),!0)};this.resizeObserver=new ResizeObserver(g);const p=t.parentElement;if(!p)throw window.alert("Failed to create canvas"),new Error("Canvas has no parent!! (Can't listen to resizing...)");this.resizeObserver.observe(p),g()||this.onResized()}setModelControls(e){this.config.modelControls=e,"static"===this.config.mode&&this.render()}setTextureMapping(e){this.config.textureMapping=e,"static"===this.config.mode&&this.render()}setObjectStateMap(e){this.config.objStateMap=e,"static"===this.config.mode&&this.render()}destroy(){var e;this.resizeObserver&&this.resizeObserver.disconnect(),null===(e=this.cleanupEvents)||void 0===e||e.call(this)}get width(){return this.config.canvas.width}get height(){return this.config.canvas.height}}class Xt extends Vt{constructor(e){super(e),c(this,"ctx",void 0),c(this,"renderCount",0);const t=e.canvas.getContext("2d");if(null===t)throw window.alert("Canvas not supported in this browser."),new Error("Failed to create context");this.ctx=t,this.setupEvents()}onResized(){this.render()}render(){const{modelControls:e}=this.config;console.log(`Rendering next 🖼️ (#${this.renderCount})`);const t=performance.now(),r=this.width,n=this.height;this.ctx.fillStyle="rgb(4, 16, 22)",this.ctx.fillRect(0,0,r,n),this.ctx.strokeStyle="rgb(0, 0, 200)",this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(0,n/2),this.ctx.lineTo(r,n/2),this.ctx.stroke(),this.ctx.moveTo(r/2,0),this.ctx.lineTo(r/2,n),this.ctx.stroke();const o=[`renderCount: ${this.renderCount}`,`viewWidth: ${r}`,`viewHeight: ${n}`,`zoom: ${e.zoom}`,`rotationX: ${e.rotationX}`,`rotationY: ${e.rotationY}`,`rotationZ: ${e.rotationZ}`,`translationX: ${e.translationX}`,`translationY: ${e.translationY}`,`viewMode: ${e.viewMode}`];this.ctx.textAlign="left",this.ctx.textBaseline="middle",this.ctx.fillStyle="white",this.ctx.font="18px monospace",this.ctx.strokeStyle="red";const i=this.ctx.measureText(o.reduce(((e,t)=>e.length>t.length?e:t))).width,a=18*o.length+4*o.length*2;for(let e=0;e<o.length;e++){const t=26;false,this.ctx.fillText(o[e],r/2-i/2,n/2-a/2+(e*t+t/2))}const s=performance.now();console.log(`Finished rendering 🖼️ in ${s-t}ms`),this.renderCount++}}const $t={compileShader:function(e,t,r){const n=e.createShader(r);if(null===n)throw`Failed to create shader of type "${r}"`;if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw`Could not compile shader: ${e.getShaderInfoLog(n)}`;return n},createProgram:function(e,t,r){const n=e.createProgram();if(null===n)throw"Failed to create program";if(e.attachShader(n,t),e.attachShader(n,r),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS))throw`Program failed to link: ${e.getProgramInfoLog(n)}`;return n},resizeCanvasToDisplaySize:function(e){const t=e.clientWidth,r=e.clientHeight,n=e.width!==t||e.height!==r;return n&&(e.width=t,e.height=r),n}};var Yt=1e-6,Wt="undefined"!=typeof Float32Array?Float32Array:Array,Ht=Math.random,zt=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var Gt,qt=W,Zt=G,Kt=x,Qt=te,Jt=de,er=be,tr=ge,rr=xe,nr=we,or=le,ir=Me,ar=(Gt=ae(),function(e,t,r,n,o,i){var a,s;for(t||(t=3),r||(r=0),s=n?Math.min(n*t+r,e.length):e.length,a=r;a<s;a+=t)Gt[0]=e[a],Gt[1]=e[a+1],Gt[2]=e[a+2],o(Gt,Gt,i),e[a]=Gt[0],e[a+1]=Gt[1],e[a+2]=Gt[2];return e});class sr{constructor(e){He(this,"gl",void 0),He(this,"handle",void 0),He(this,"deleted",!1),He(this,"ok",!1),this.gl=e;const t=e.createTexture();if(null===t)throw new Error("Failed to create texture.");this.handle=t}use(e,t,r){if(this.deleted)throw"Trying to use a texture that has already been deleted.";return!!this.ok&&(this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.handle),this.gl.uniform1i(e,0),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,r),!0)}loadDataFromPixels(e,t,r){if(this.deleted)throw"Trying to use a texture that has already been deleted.";const n=this.gl.RGBA,o=this.gl.RGBA,i=this.gl.UNSIGNED_BYTE;this.gl.bindTexture(this.gl.TEXTURE_2D,this.handle),this.gl.texImage2D(this.gl.TEXTURE_2D,0,n,e,t,0,o,i,r),this.ok=!0}loadDataFromImage(e){if(this.deleted)throw"Trying to use a texture that has already been deleted.";if(!e.complete||0===e.naturalWidth){console.error("Trying to load data from an image that hasn't yet loaded!");const t=new Uint8Array([255,255,255,255]);return this.loadDataFromPixels(1,1,t),void(e.onload=()=>{e.complete&&0!==e.naturalWidth&&this.loadDataFromImage(e)})}const t=this.gl.RGBA,r=this.gl.RGBA,n=this.gl.UNSIGNED_BYTE;this.gl.bindTexture(this.gl.TEXTURE_2D,this.handle),this.gl.texImage2D(this.gl.TEXTURE_2D,0,t,r,n,e),ze(e.width)&&ze(e.height)&&this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.ok=!0}delete(){this.gl.deleteTexture(this.handle),this.deleted=!0}}class lr{constructor(e,t,r){Ge(this,"gl",void 0),Ge(this,"programInfo",void 0),Ge(this,"logoDefs",void 0),Ge(this,"currentLogoIdx",void 0),Ge(this,"textureDatabase",{}),Ge(this,"lastTexture",void 0),Ge(this,"baseEntityColor",new Float32Array([1,1,1,1])),Ge(this,"textureMinFilter",void 0),Ge(this,"textureMagFilter",void 0),this.gl=e,this.programInfo=t,this.logoDefs=r,this.currentLogoIdx=r.defaultIdx,this.textureMinFilter=e.NEAREST,this.textureMagFilter=e.NEAREST}getGl(){return this.gl}getProgramInfo(){return this.programInfo}getBaseEntityColor(){return this.baseEntityColor}setBaseEntityColor(e){this.baseEntityColor=e}setUniformMatrix4(e,t){const r=this.programInfo.uniformLocations[e];r&&this.gl.uniformMatrix4fv(r,!1,t)}setUniformFloat4(e,t){if(4!==t.length)throw new Error(`data.length is not 4: ${t.length}`);const r=this.programInfo.uniformLocations[e];r&&this.gl.uniform4fv(r,t)}setUniformBool(e,t){const r=this.programInfo.uniformLocations[e];r&&this.gl.uniform1i(r,t?1:0)}setTextureMinFilter(e){this.textureMinFilter=e}setTextureMagFilter(e){this.textureMagFilter=e}drawElements(e){this.gl.drawElements(this.gl.TRIANGLES,e,this.gl.UNSIGNED_SHORT,0)}useTexture(e){let t;if(null===e)t=null;else{const r=this.logoDefs.textureKeyUsesLogo(e)?this.logoDefs.idxToTextureKey(this.currentLogoIdx,e):e,n=this.textureDatabase[r];void 0===n?(console.error(`Missing texture for: ${r}`),t=null):t=n}return this.lastTexture===t?null!==t:(this.lastTexture=t,null!==t&&(t.use(this.programInfo.uniformLocations.sampler,this.textureMinFilter,this.textureMagFilter),!0))}changeTextureMapping(e){for(const[t,r]of Object.entries(e)){const e=this.textureDatabase[t];e!==r&&(null!=e&&e.delete(),this.textureDatabase[t]=null===r?null:this.setupTexture(r))}}setCurrentLogoIdx(e){this.currentLogoIdx=e}setupTexture(e){const t=new sr(this.gl);if("html"===e.type)t.loadDataFromImage(e.image);else{const{width:r,height:n,data:o}=e;t.loadDataFromPixels(r,n,o)}return t}}class cr extends lr{constructor(e,t,r,n){super(e,t,r),qe(this,"viewMode",void 0),this.viewMode=n}drawElements(e){this.gl.drawElements("wireframe"===this.viewMode?this.gl.LINE_LOOP:this.gl.TRIANGLES,e,this.gl.UNSIGNED_SHORT,0)}useTexture(e){return"regular"!==this.viewMode||super.useTexture(e)}}const ur=new Float32Array([1,1,0,1]);class fr{constructor(e,t){Ze(this,"model",void 0),Ze(this,"name",void 0),Ze(this,"children",void 0),Ze(this,"parent",void 0),Ze(this,"modelViewMatrix",void 0),Ze(this,"relativeModelViewMatrix",void 0),Ze(this,"stateOptions",void 0),this.model=e,this.name=null!=t?t:null,this.children=[],this.parent=null,this.modelViewMatrix=Mt.create(),this.relativeModelViewMatrix=Mt.create(),this.stateOptions={visibile:!0,highlighted:!1}}addChild(e){if(null!==e.parent)throw new Error("Can't add a child that already has a parent.");this.children.push(e),e.parent=this}render(e){this.recalculateMatrices(Mt.create()),this.renderChild(e)}recalculateMatrices(e){this.relativeModelViewMatrix=Mt.mul(Mt.create(),e,this.modelViewMatrix);for(const e of this.children)e.recalculateMatrices(this.relativeModelViewMatrix)}renderChild(e){var t;const r=null!==(t=this.color)&&void 0!==t?t:e.getBaseEntityColor();if(null!==this.model&&this.stateOptions.visibile)if(e.setUniformFloat4("entityColor",r),e.setUniformMatrix4("modelViewMatrix",this.relativeModelViewMatrix),Array.isArray(this.model))for(const t of this.model)this.renderModel(e,t);else this.renderModel(e,this.model);for(const t of this.children)t.renderChild(e)}findChild(e,t){for(const r of this.children){if(r.name===e)return r;if(t){const n=r.findChild(e,t);if(void 0!==n)return n}}}renderModel(e,t){if(t.usesNormals()){const t=Mt.create();Mt.invert(t,this.relativeModelViewMatrix),Mt.transpose(t,t),e.setUniformMatrix4("normalMatrix",t)}t.draw(e)}translate(e,t,r){Mt.translate(this.modelViewMatrix,this.modelViewMatrix,[e,t,r])}scale(e,t,r){Mt.scale(this.modelViewMatrix,this.modelViewMatrix,[e,t,r])}rotate(e,t,r,n){Mt.rotate(this.modelViewMatrix,this.modelViewMatrix,e,[t?1:0,r?1:0,n?1:0])}rotateX(e){Mt.rotateX(this.modelViewMatrix,this.modelViewMatrix,e)}rotateY(e){Mt.rotateY(this.modelViewMatrix,this.modelViewMatrix,e)}rotateZ(e){Mt.rotateZ(this.modelViewMatrix,this.modelViewMatrix,e)}resetTransformations(){this.modelViewMatrix=Mt.create()}get color(){if(this.stateOptions.highlighted)return ur}getStateOptions(){return this.stateOptions}setStateOptions(e){this.stateOptions=e}}class hr{constructor(e){Ke(this,"gl",void 0),Ke(this,"_handle",void 0),Ke(this,"deleted",!1),this.gl=e;const t=e.createBuffer();if(null===t)throw"Failed to create buffer!";this._handle=t}get handle(){return this._handle}bufferData(e){if(this.deleted)throw"Trying to use a buffer that has already been deleted.";this.doBufferData(e)}use(){if(this.deleted)throw"Trying to use a buffer that has already been deleted.";this.doUse()}delete(){if(this.deleted)throw"Trying to delete a buffer that has already been deleted.";this.gl.deleteBuffer(this._handle),this.deleted=!0}}class dr extends hr{constructor(...e){super(...e),Qe(this,"length",0)}getLength(){return this.length}doBufferData(e){this.length=e.byteLength/2,this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.handle),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,e,this.gl.STATIC_DRAW)}doUse(){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.handle)}static createBufferSourceFromIndices(e){return new Uint16Array(e)}}class br extends hr{constructor(e,t){super(e),Je(this,"attribLocation",void 0),this.attribLocation=t}}class gr extends br{doBufferData(e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.handle),this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW)}doUse(){const e=this.gl.FLOAT;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.handle),this.gl.vertexAttribPointer(this.attribLocation,3,e,!1,0,0),this.gl.enableVertexAttribArray(this.attribLocation)}static createBufferSourceFromPositions(e){return new Float32Array(e)}}class pr extends br{doBufferData(e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.handle),this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW)}doUse(){const e=this.gl.FLOAT;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.handle),this.gl.vertexAttribPointer(this.attribLocation,3,e,!1,0,0),this.gl.enableVertexAttribArray(this.attribLocation)}static createBufferSourceFromPositions(e){return new Float32Array(e)}}class vr extends br{doBufferData(e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.handle),this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW)}doUse(){const e=this.gl.FLOAT;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.handle),this.gl.vertexAttribPointer(this.attribLocation,2,e,!1,0,0),this.gl.enableVertexAttribArray(this.attribLocation)}static createBufferSourceFromCoords(e){return new Float32Array(e)}}class mr{constructor(e,t,r,n){et(this,"positionBuffer",void 0),et(this,"indexBuffer",void 0),et(this,"normalBuffer",void 0),et(this,"textureCoordsBuffer",void 0),et(this,"textureKey",null),this.positionBuffer=e,this.indexBuffer=t,this.normalBuffer=r,this.textureCoordsBuffer=n}setTextureKey(e){this.textureKey=e}getTextureKey(){return this.textureKey}usesNormals(){return void 0!==this.normalBuffer}draw(e){e.useTexture(this.textureKey)&&(this.positionBuffer.use(),this.indexBuffer.use(),void 0!==this.normalBuffer&&this.normalBuffer.use(),void 0!==this.textureCoordsBuffer&&this.textureCoordsBuffer.use(),e.drawElements(this.indexBuffer.getLength()))}}const _r={createModelFromIndexedVertices:tt,createModelFromSmartVertices:function(e,t,r){const n=[],o=[];e:for(let e=0;e<t.length;e++){const r=t[e];for(let e=0;e<n.length;e++){if((i=r)[0]===(a=n[e])[0]&&i[1]===a[1]&&i[2]===a[2]){o.push(e);continue e}}n.push(r),o.push(n.length-1)}var i,a;return tt(e,{vertices:n,indices:o,texCoords:null},r)},makeCube:function(e,t){const r=new pr(e,t.attribLocations.vertexPosition);r.bufferData(pr.createBufferSourceFromPositions([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]));const n=new dr(e);n.bufferData(dr.createBufferSourceFromIndices([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]));const o=new gr(e,t.attribLocations.vertexNormal);o.bufferData(gr.createBufferSourceFromPositions([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]));const i=new vr(e,t.attribLocations.textureCoord);i.bufferData(vr.createBufferSourceFromCoords([0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1]));const a=new mr(r,n,o,i);return new fr(a,"cube")}},Or=1e-6,yr=[1,1,1,1];class jr{constructor(e,t,r,n){this.gl=e,this.shaderSources=t,this.object3doTree=r,this.logoDefs=n,ot(this,"programInfo",void 0),ot(this,"ctx",void 0),ot(this,"rootEntity",void 0),ot(this,"objEntityMap",new Map),this.programInfo=this.initProgram(),this.ctx=this.initContext(),this.rootEntity=this.initRootEntity()}initContext(){return new cr(this.gl,this.programInfo,this.logoDefs,this.getViewMode())}initRootEntity(){const e=this.getViewMode(),t=new fr(null);for(const r of this.object3doTree.rootNodes)rt(this.ctx,r,t,this.objEntityMap,"wireframe"!==e,"wireframe"!==e,"regular"===e);return t}changeTextureMapping(e){}changeModelControls(e){}changeObjectStateMap(e){for(const[t,r]of e){const e=this.objEntityMap.get(t);if(void 0===e)throw new Error(`Couldn't find an entity for the object: ${t}`);e.setStateOptions({visibile:!r.hide,highlighted:r.highlight})}}inBeforeTheRootRender(e,t){}render(e,t,r){var n;const o=e.drawingBufferWidth,i=e.drawingBufferHeight;e.clearColor(0,0,0,0),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);const a=45*Math.PI/180,s=o/i,l=Mt.create();e.useProgram(this.programInfo.program),this.ctx.setUniformFloat4("baseColor",null!==(n=t.viewColor)&&void 0!==n?n:yr),Mt.perspective(l,a,s,.1,100),this.ctx.setUniformMatrix4("projectionMatrix",l);const c=.02*t.translationX,u=.02*t.translationY*-1,f=-1*(8+.01*t.zoom);this.rootEntity.resetTransformations(),this.rootEntity.translate(c,u,f),this.rootEntity.rotateX(wt.toRadian(t.rotationX)),this.rootEntity.rotateY(wt.toRadian(t.rotationY)),this.rootEntity.rotateZ(wt.toRadian(t.rotationZ)),this.inBeforeTheRootRender(e,t),this.rootEntity.render(this.ctx)}update(e){}}class xr extends jr{changeTextureMapping(e){this.ctx.changeTextureMapping(e)}changeModelControls(e){this.ctx.setCurrentLogoIdx(e.logoColorIdx),super.changeModelControls(e)}getViewMode(){return"regular"}initProgram(){const{vsSource:e,fsSource:t}=this.shaderSources.regular,r=$t.compileShader(this.gl,e,this.gl.VERTEX_SHADER),n=$t.compileShader(this.gl,t,this.gl.FRAGMENT_SHADER),o=$t.createProgram(this.gl,r,n);return{program:o,attribLocations:{vertexPosition:this.gl.getAttribLocation(o,"aVertexPosition"),vertexNormal:this.gl.getAttribLocation(o,"aVertexNormal"),textureCoord:this.gl.getAttribLocation(o,"aTextureCoord")},uniformLocations:{modelViewMatrix:this.gl.getUniformLocation(o,"uModelViewMatrix"),projectionMatrix:this.gl.getUniformLocation(o,"uProjectionMatrix"),baseColor:this.gl.getUniformLocation(o,"baseColor"),entityColor:this.gl.getUniformLocation(o,"entityColor"),normalMatrix:this.gl.getUniformLocation(o,"uNormalMatrix"),sampler:this.gl.getUniformLocation(o,"uSampler"),useLights:this.gl.getUniformLocation(o,"useLights")}}}inBeforeTheRootRender(e,t){t.enableFaceCulling?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.ctx.setUniformBool("useLights",t.enableLightingRegular);const r="linear"===t.textureFilterMag?e.LINEAR:e.NEAREST;this.ctx.setTextureMinFilter("linear"===t.textureFilterMin?e.LINEAR:e.NEAREST),this.ctx.setTextureMagFilter(r)}}class wr extends jr{getViewMode(){return"solid_color"}changeModelControls(e){this.ctx.setBaseEntityColor(e.solidColor)}initProgram(){const{vsSource:e,fsSource:t}=this.shaderSources.solid,r=$t.compileShader(this.gl,e,this.gl.VERTEX_SHADER),n=$t.compileShader(this.gl,t,this.gl.FRAGMENT_SHADER),o=$t.createProgram(this.gl,r,n);return{program:o,attribLocations:{vertexPosition:this.gl.getAttribLocation(o,"aVertexPosition"),vertexNormal:this.gl.getAttribLocation(o,"aVertexNormal")},uniformLocations:{modelViewMatrix:this.gl.getUniformLocation(o,"uModelViewMatrix"),projectionMatrix:this.gl.getUniformLocation(o,"uProjectionMatrix"),baseColor:this.gl.getUniformLocation(o,"baseColor"),entityColor:this.gl.getUniformLocation(o,"entityColor"),normalMatrix:this.gl.getUniformLocation(o,"uNormalMatrix"),useLights:this.gl.getUniformLocation(o,"useLights")}}}inBeforeTheRootRender(e,t){t.enableFaceCulling?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.ctx.setUniformBool("useLights",t.enableLightingSolidColor)}}class Mr extends jr{getViewMode(){return"wireframe"}changeModelControls(e){this.ctx.setBaseEntityColor(e.wireframeColor)}initProgram(){const{vsSource:e,fsSource:t}=this.shaderSources.wireframe,r=$t.compileShader(this.gl,e,this.gl.VERTEX_SHADER),n=$t.compileShader(this.gl,t,this.gl.FRAGMENT_SHADER),o=$t.createProgram(this.gl,r,n);return{program:o,attribLocations:{vertexPosition:this.gl.getAttribLocation(o,"aVertexPosition")},uniformLocations:{modelViewMatrix:this.gl.getUniformLocation(o,"uModelViewMatrix"),projectionMatrix:this.gl.getUniformLocation(o,"uProjectionMatrix"),baseColor:this.gl.getUniformLocation(o,"baseColor"),entityColor:this.gl.getUniformLocation(o,"entityColor")}}}}class Sr extends Vt{constructor(e,t,r,n){super(e),it(this,"gl",void 0),it(this,"subRenderers",void 0);const o=e.canvas.getContext("webgl",{preserveDrawingBuffer:e.preserveDrawingBuffer});if(null===o)throw"Couldn't get WebGL rendering context!";this.gl=o,o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),this.subRenderers={regular:new xr(o,t,r,n),solid_color:new wr(o,t,r,n),wireframe:new Mr(o,t,r,n)};for(const t of Object.values(this.subRenderers))t.changeTextureMapping(e.textureMapping);if(this.setupEvents(),"continuous"===e.mode){let e=0;const t=r=>{const n=(r*=.001)-e;e=r,this.update(n),this.render(n),requestAnimationFrame(t)};requestAnimationFrame(t)}}onResized(){console.log(`Resized! (${this.width} x ${this.height})`),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),"static"===this.config.mode&&this.render()}render(e){this.subRenderers[this.config.modelControls.viewMode].render(this.gl,this.config.modelControls,e)}setTextureMapping(e){for(const t of Object.values(this.subRenderers))t.changeTextureMapping(e);super.setTextureMapping(e)}setModelControls(e){for(const t of Object.values(this.subRenderers))t.changeModelControls(e);super.setModelControls(e)}setObjectStateMap(e){for(const t of Object.values(this.subRenderers))t.changeObjectStateMap(e);super.setObjectStateMap(e)}update(e){this.subRenderers[this.config.modelControls.viewMode].update(e)}}var Tr=({canvasRef:e})=>{console.log("Re-rendering CanvasWrapper");const t=Object(Tt.h)("div",{class:"absolute inset-0"},Object(Tt.h)("canvas",{ref:e}));return Object(Tt.h)("div",{class:"w-full h-full max-w-full max-h-full relative"},t)},Pr="NameWrapper__lk4ti",Er="LeftBorder__WZG0Y",Cr="MiddleBorder__FcOEe",Rr="Root__0piuG";var Ur=({state:e,setState:t})=>Object(Tt.h)("div",{class:"flex pr-1"},Object(Tt.h)("div",{class:"flex items-center px-1 cursor-pointer"+(e.highlight?" text-yellow-500":""),onClick:()=>t(st(st({},e),{},{highlight:!e.highlight}))},"H"),Object(Tt.h)("div",{class:"flex items-center px-1 cursor-pointer"+(e.hide?"":" text-yellow-500"),onClick:()=>t(st(st({},e),{},{hide:!e.hide}))},"V"));const Dr="1.50rem",Lr="34px",kr="0.50rem",Fr=({current:e,nodes:t,onChangeNodeStack:r,nodeStack:n,objStateMap:o,setObjStateMap:i})=>{var a;const[s,l]=Object(Pt.e)(!0),c=t.length>0,u=e&&o.get(e);return Object(Tt.h)("div",{class:Rr+" w-full overflow-hidden text-sm"},null!==e&&Object(Tt.h)("div",{style:{height:Lr},class:Pr+" flex py-1 bg-cyan-900 box-border"},Object(Tt.h)("div",{onClick:c?()=>l(!s):void 0,class:"flex items-center px-1 pl-2 "+(c?"cursor-pointer hover:text-yellow-400":"invisible")},s?"▲":"▼"),Object(Tt.h)("div",{class:"min-w-0 flex items-center grow hover:text-yellow-400 cursor-pointer",onClick:()=>r(n)},Object(Tt.h)("div",{class:"truncate px-1",title:e.name},null!==(a=e.name)&&void 0!==a?a:Object(Tt.h)("span",{class:"text-gray-300"},"<empty name>"))),u&&Object(Tt.h)(Ur,{state:u,setState:t=>{const r=Nt.createUpdatedMap(o,e,t);i(r)}})),t.length>0&&Object(Tt.h)("div",{class:s?"block":"hidden"},t.map(((e,a)=>Object(Tt.h)("div",{key:a,class:"flex"},Object(Tt.h)("div",{class:Er,style:{marginLeft:`calc(${Dr} / 2)`,height:a===t.length-1?`calc(${Lr} / 2 + ${kr})`:"auto"}}),Object(Tt.h)("div",{class:Cr+" self-start",style:{width:`calc(${Dr} / 2)`,height:`calc(${Lr} / 2 + ${kr})`}}),Object(Tt.h)("div",{class:"grow max-w-full overflow-hidden",style:{paddingTop:kr}},Object(Tt.h)(Fr,{current:e,nodes:e.children,onChangeNodeStack:r,nodeStack:[...n,e],objStateMap:o,setObjStateMap:i})))))))};var Ar=Fr;const Ir="px-1.5 py-1 align-top text-left",Br=`${Ir} whitespace-nowrap`,Nr=`${Ir} break-all`;var Vr=({primitives:e})=>Object(Tt.h)("table",{class:"w-full overflow-hidden"},Object(Tt.h)("thead",null,Object(Tt.h)("tr",null,Object(Tt.h)("th",{class:Br},"#"),Object(Tt.h)("th",{class:Br,title:"Vertex Indices"},"V.Indices"),Object(Tt.h)("th",{class:Br},"Texture"))),Object(Tt.h)("tbody",null,e.map(((e,t)=>Object(Tt.h)("tr",{key:t},Object(Tt.h)("td",{class:Nr},t),Object(Tt.h)("td",{class:Nr},"[",e.vertexIndices.join(", "),"]"),Object(Tt.h)("td",{class:`${Nr}`},e.textureName))))));var Xr=({object3doTree:e,objStateMap:t,setObjStateMap:r})=>{const[n,o]=Object(Pt.e)([]),i=0===n.length?null:n[n.length-1],a=null===i?e.rootNodes:i.children,s=i&&t.get(i),l=Object(Pt.c)((()=>{const e=Object(Tt.h)("div",{class:"mx-1 text-pink-600"},"»"),t="font-bold",r="cursor-pointer text-gray-400 hover:text-white";return Object(Tt.h)("div",{class:"flex flex-wrap bg-gray-900 px-1 py-0.5"},Object(Tt.h)("div",{class:null===i?t:r,onClick:()=>o([])},Object(Tt.h)("span",{class:"italic"},"(ROOT)")),null!==i&&e,n.map(((i,a)=>Object(Tt.h)(Tt.Fragment,{key:a},Object(Tt.h)("div",{onClick:()=>o(n.slice(0,a+1)),class:a===n.length-1?t:r},i.name),a<n.length-1&&e))))}),[n,i]),c=Object(Pt.c)((()=>{var e;return Object(Tt.h)("div",{class:"flex py-1 bg-cyan-900 border border-yellow-500 text-sm"},Object(Tt.h)("div",{class:"min-w-0 grow px-1 pl-2"},null===i?Object(Tt.h)("span",{class:"italic"},"(ROOT)"):null!==(e=i.name)&&void 0!==e?e:Object(Tt.h)("span",{class:"text-gray-300"},"<empty name>")),s&&Object(Tt.h)(Ur,{state:s,setState:e=>{const n=Nt.createUpdatedMap(t,i,e);r(n)}}))}),[i,s,t,r]),u=Object(Pt.c)((()=>null===i||0===i.primitives.length?null:Object(Tt.h)("div",{class:"border border-dashed border-gray-500 px-2 py-1 mt-2 mb-1 text-sm text-gray-300"},Object(Tt.h)(Ut,{title:"Vertices"},Object(Tt.h)("div",{class:"border-t border-gray-700 mt-1 pt-1 text-xs"},Object(Tt.h)("span",{class:"break-all"},"[",i.vertices.map((e=>`[${e.x}, ${e.y}, ${e.z}]`)).join(", "),"]"))))),[i]),f=Object(Pt.c)((()=>null===i||0===i.primitives.length?null:Object(Tt.h)("div",{class:"border border-dashed border-gray-500 px-2 py-1 mt-2 mb-1 text-sm text-gray-300"},Object(Tt.h)(Ut,{title:"Primitives"},Object(Tt.h)("div",{class:"border-t border-gray-700 mt-1 pt-1 text-xs"},Object(Tt.h)(Vr,{primitives:i.primitives}))))),[i]);return Object(Tt.h)("div",{class:"flex flex-col h-full overflow-hidden"},Object(Tt.h)("div",{className:"px-6"},Object(Tt.h)("div",{class:"mb-4"},l),Object(Tt.h)("div",{class:"mb-2 font-bold"},"Current:"),c,Object(Tt.h)("div",{class:"pl-4"},u,f),a.length>0&&Object(Tt.h)("div",{class:"mt-6 mb-2 font-bold flex justify-between"},Object(Tt.h)("span",null,"Children:"),Object(Tt.h)("span",null,"(",a.length,")"))),Object(Tt.h)("div",{class:"grow overflow-auto px-6"},Object(Tt.h)(Ar,{current:null,nodes:a,onChangeNodeStack:o,nodeStack:n,objStateMap:t,setObjStateMap:r})))},$r=r("IomO"),Yr=r("u6ao");var Wr=({textures:e})=>Object(Tt.h)("div",{class:"flex flex-col space-y-2"},Object.entries(e).map((([e,t],r)=>{let n=null!==t;null!==t&&"html"===t.type&&(n=t.image.complete&&0!==t.image.naturalWidth);const o=n?"OK":"ERROR";return Object(Tt.h)("div",{key:r,class:"flex items-center group"+(n?" text-green-600 hover:text-green-500":" text-red-600 hover:text-red-500")},Object(Tt.h)("div",{class:"break-all"},e),Object(Tt.h)("div",{class:"grow border-b border-dashed border-gray-600 group-hover:border-gray-500 mx-1\r text-transparent text-center",style:{minWidth:"24px",marginBottom:"6px"}},"-"),"html"===(null==t?void 0:t.type)?Object(Tt.h)("a",{href:t.image.src,target:"_blank",rel:"noreferrer"},o):Object(Tt.h)("div",null,o))})));const Hr=["image/png","image/gif","image/jpeg"];var zr=({regularTextures:e,customTextures:t,setCustomTextures:r})=>{const[n,o]=Object(Pt.e)(!1),i=Object(Pt.a)((async e=>{const n={};for(const t of e){if(!Hr.includes(t.type))continue;const e=e=>{const r=t.name.replace(/^.*[\\\/]/,"").replace(/\.[^/.]+$/,"");n[r]={type:"html",image:e}};await Yr.a.loadDataUrl(t).then(Yr.a.createImageFromDataUrl).then(e).catch(console.error)}r(ut(ut({},t),n))}),[t,r]),a=Object(Tt.h)("input",{type:"file",multiple:!0,accept:Hr.join(", "),disabled:n,onChange:e=>{if(n)return void(e.currentTarget.value="");const t=e.currentTarget.files;null!==t&&(o(!0),i(t).finally((()=>{o(!1)}))),e.currentTarget.value=""}});return Object(Tt.h)("div",{class:"flex flex-col h-full overflow-hidden"},Object(Tt.h)("div",{class:"flex flex-col overflow-hidden pb-4",style:{maxHeight:"50%"}},Object(Tt.h)("div",{class:"text-center font-bold mb-2"},"Custom Textures"),Object(Tt.h)("div",{class:"grow overflow-auto px-6"},Object(Tt.h)(Wr,{textures:t,setTextures:r})),Object(Tt.h)("div",{className:"px-6 mt-2"},a)),Object(Tt.h)("div",{class:"grow basis-1/2 flex flex-col overflow-hidden"},Object(Tt.h)("div",{class:"text-center font-bold mb-2"},"TAK Textures"),Object(Tt.h)("div",{class:"grow overflow-auto px-6"},Object(Tt.h)(Wr,{textures:e}))))};const Gr=["options","objects","textures"];var qr=({engineName:e,shaders:t,object3doTree:r,regularTextures:n,defaultObjStateMap:o,logoDefs:i,userService:a,defaultUserSettings:s,defaultModelControls:l})=>{console.log("Re-rendering App");const[c,u]=Object(Pt.e)(!1),[f,h]=Object(Pt.e)("options"),[d,b]=Object(Pt.e)(l),[g,p]=Object(Pt.e)(o),[v,m]=Object(Pt.e)(),[_,O]=Object(Pt.e)(s),y=Object(Pt.a)((e=>{O(e),a.save(e)}),[a]),[j,x]=Object(Pt.e)({}),w=Object(Pt.d)();Object(Pt.b)((()=>{const a=w.current;if(!a)return;a.width=a.clientWidth,a.height=a.clientHeight,console.log("Creating the Engine");const c={mode:"static",canvas:a,modelControls:l,listener:{onModelControlsChanged:b},textureMapping:dt({},n),objStateMap:o,preserveDrawingBuffer:s.preserveDrawingBuffer},u=dt(dt({},i),{},{defaultIdx:l.logoColorIdx}),f="webgl"===e?new Sr(c,t,r,u):new Xt(c);return m(f),()=>{f.destroy(),m(void 0),alert("Unmounting the engine. This should probably not be happening normally!!!")}}),[w,t,o,e,r,n,i,l,s]),Object(Pt.b)((()=>{const e=w.current;e&&(e.style.background=d.canvasBackground,e.style.backgroundSize=d.canvasBackgroundSize,e.style.backgroundRepeat=d.canvasBackgroundRepeat,e.style.backgroundPosition="center")}),[w,d]),Object(Pt.b)((()=>{v&&v.setModelControls(d)}),[v,d]),Object(Pt.b)((()=>{d.textureFilterMin===_.defaultTextureFilterMin&&d.textureFilterMag===_.defaultTextureFilterMag||y(dt(dt({},_),{},{defaultTextureFilterMin:d.textureFilterMin,defaultTextureFilterMag:d.textureFilterMag}))}),[v,d,_,y]),Object(Pt.b)((()=>{v&&v.setObjectStateMap(g)}),[v,g]),Object(Pt.b)((()=>{v&&v.setTextureMapping(dt(dt({},n),j))}),[v,n,j]);const M=Object(Pt.c)((()=>Object(Tt.h)(Tr,{canvasRef:w})),[w]),S=Object(Pt.c)((()=>Object(Tt.h)("div",{class:"h-full flex flex-col"},Object(Tt.h)("div",{class:"flex text-white border-b border-gray-700"},Object(Tt.h)("div",{class:"grow px-4 py-4 text-center"},"Canvas"),Object(Tt.h)("div",{class:"px-4 py-4 cursor-pointer hover:bg-blue-700 font-mono",onClick:()=>u(!c)},c?">[ ]<":"<[ ]>")),Object(Tt.h)("div",{class:"grow p-6"},M))),[M,c]),T=Object(Pt.c)((()=>Object(Tt.h)($r.a,{modelControls:d,setModelControls:b,userSettings:_,setUserSettings:y,logoDefs:i,canvasRef:w})),[d,_,y,i,w]),P=Object(Pt.c)((()=>Object(Tt.h)(Xr,{object3doTree:r,objStateMap:g,setObjStateMap:p})),[r,g]),E=Object(Pt.c)((()=>Object(Tt.h)(zr,{regularTextures:n,customTextures:j,setCustomTextures:x})),[j,n]),C=Object(Pt.c)((()=>Object(Tt.h)("div",{class:"h-full flex flex-col"},Object(Tt.h)("div",{class:"flex text-white border-b border-gray-700"},Gr.map(((e,t,r)=>{const n=e===f,o=n?"font-bold":"cursor-pointer text-gray-400 hover:text-white",i=t!==r.length-1?"border-r border-gray-700":"";return Object(Tt.h)("div",{key:t,class:`grow basis-0 px-2 py-4 text-center ${o} ${i}`,onClick:()=>{n||h(e)}},"options"===e?"Options":"objects"===e?"Objects":"Textures")}))),Object(Tt.h)("div",{class:"grow max-h-full overflow-hidden py-6",style:{width:_.sidebarWidth,overflowX:"auto"}},"options"===f?T:"objects"===f?P:E))),[f,T,_,P,E]),R=c?" border-gray-800":" border-gray-700",U="left"===_.sidebarPosition?"":" flex-row-reverse",D="left"===_.sidebarPosition?" border-r":" border-l";return Object(Tt.h)("div",{class:"flex justify-center items-stretch h-screen overflow-hidden bg-gray-900"},Object(Tt.h)("div",{class:`grow flex bg-gray-800 border ${R} ${U}`,style:{"max-width":c?"100%":"1600px"}},Object(Tt.h)("div",{class:`hidden lg:block border-gray-700 ${D}`},C),Object(Tt.h)("div",{class:"grow"},S)))};var Zr=({dataSource:e,userService:t,defaultUserSettings:r,defaultModelControls:n})=>{var o,i;const[a,s]=Object(Pt.e)(),[l,c]=Object(Pt.e)(),[u,f]=Object(Pt.e)(),[h,d]=Object(Pt.e)(),b=It;if(Object(Pt.b)((()=>{(async function(){return{regular:{fsSource:await fetch("assets/shaders/regular.fs").then((e=>e.text())),vsSource:await fetch("assets/shaders/regular.vs").then((e=>e.text()))},solid:{fsSource:await fetch("assets/shaders/solid_color.fs").then((e=>e.text())),vsSource:await fetch("assets/shaders/solid_color.vs").then((e=>e.text()))},wireframe:{fsSource:await fetch("assets/shaders/wireframe.fs").then((e=>e.text())),vsSource:await fetch("assets/shaders/wireframe.vs").then((e=>e.text()))}}})().then(c)}),[]),Object(Pt.b)((()=>{(async function(e){let t;if("string"==typeof e){const r=await fetch(e);t=await r.arrayBuffer()}else t=await e.arrayBuffer();const r=new DataView(t);return At.Parse3do.fromBuffer(r)})(e).then((e=>(s(e),async function(e,t,r,n){const o=new Set,i=e=>{for(const t of e.primitives){const e=t.textureName;Nt.validateTextureName(e)&&o.add(e)}for(const t of e.children)i(t)};for(const t of e.rootNodes)i(t);const a={};return await Promise.all(Array.from(o).map((e=>new Promise(((o,i)=>{if(""===(e=e.trim()))return a[e]=null,void o();if(!t.textureKeyUsesLogo(e)){const t=`${e}.${n}`,i=new Image;return i.src=r+t,i.onerror=()=>{console.error(`Failed to load image at: ${i.src}`),a[e]=null,o()},void(i.onload=()=>{a[e]={type:"html",image:i},o()})}Promise.all(t.idxList.map((o=>new Promise((i=>{const s=t.idxToTextureKey(o,e),l=`${t.idxToTextureFilename(o,e)}.${n}`,c=new Image;c.src=r+l,c.onerror=()=>{console.error(`Failed to load image at: ${c.src}`),a[s]=null,i()},c.onload=()=>{a[s]={type:"html",image:c},i()}}))))).then((()=>o()),i)}))))),a}(e,b,"assets/custom/pngs/","png")))).then(f).catch(d)}),[e,b]),void 0!==h)return Object(Tt.h)("div",{class:"min-w-screen min-h-screen flex flex-col justify-center items-center text-3xl\r bg-black"},Object(Tt.h)("div",{class:"text-red-300"},"Error!"),Object(Tt.h)("div",{class:"text-red-600"},"(TODO)"),Object(Tt.h)("div",{class:"text-red-600"},JSON.stringify(h)));if(void 0===a||void 0===l||void 0===u){let e="Loading...";return a&&l&&(e="Loading textures..."),Object(Tt.h)("div",{class:"min-w-screen min-h-screen flex justify-center items-center text-3xl bg-black"},Object(Tt.h)("span",{class:"text-gray-400"},e))}return Object(Tt.h)(qr,{engineName:"webgl",object3doTree:a,shaders:l,regularTextures:u,defaultObjStateMap:mt(a),logoDefs:b,userService:t,defaultUserSettings:r,defaultModelControls:pt(pt({},n),{},{viewMode:null!==(o=_t(u))&&void 0!==o?o:n.viewMode,logoColorIdx:null!==(i=Ot(e))&&void 0!==i?i:n.logoColorIdx})})};t.default=()=>{const[e,t]=Object(Pt.e)(),[r]=Object(Pt.e)(Ct),[n,o]=Object(Pt.e)(),[i,a]=Object(Pt.e)();return Object(Pt.b)((()=>{let e;try{var t;e=null!==(t=r.load())&&void 0!==t?t:Et}catch(t){console.error(t),e=Et,r.save(e)}o(e),a(jt(jt({},Rt),{},{textureFilterMin:e.defaultTextureFilterMin,textureFilterMag:e.defaultTextureFilterMag}))}),[r]),void 0===n||void 0===i?Object(Tt.h)("div",{class:"min-h-screen flex justify-center items-center"},Object(Tt.h)("span",null,"Loading...")):void 0===e?Object(Tt.h)(Ft,{onSubmit:t,defaultUserSettings:n,setDefaultUserSettings:e=>{o(e),r.save(e)}}):Object(Tt.h)(Zr,{dataSource:e,userService:r,defaultUserSettings:n,defaultModelControls:i})}},qiYd:function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r("hosL"),s=r("GssO");t.a=({modelControls:e,setModelControls:t})=>Object(a.h)("div",{class:"space-y-4"},Object(a.h)("div",null,Object(a.h)("label",{class:"flex items-center"},Object(a.h)("input",{type:"checkbox",checked:e.enableLightingSolidColor,onChange:r=>{t(o(o({},e),{},{enableLightingSolidColor:r.currentTarget.checked}))}}),Object(a.h)("span",{class:"pl-1"},"Enable Lighting"))),Object(a.h)("div",null,Object(a.h)("div",{class:""},"Solid Color"),Object(a.h)(s.a,{color:e.solidColor,setColor:r=>t(o(o({},e),{},{solidColor:r}))})))},tpTz:function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r("hosL"),s=r("QRet"),l=r("u6ao");t.a=({modelControls:e,setModelControls:t,enableSaveImageButton:r,canvasRef:n})=>{const[i,c]=Object(s.e)(function(e){return"black"===e||"white"===e||"transparent"===e?e:"custom"}(e.canvasBackground)),u=Object(s.a)((r=>{c(r),"custom"!==r&&t(o(o({},e),{},{canvasBackground:r}))}),[e,t]),f=Object(s.c)((()=>"custom"!==i?null:Object(a.h)("input",{type:"file",multiple:!1,onChange:r=>{const n=r.currentTarget.files;if(null===n||0===n.length)return void(r.currentTarget.value="");l.a.loadDataUrl(n[0]).then((r=>{const n=`url(${r})`;t(o(o({},e),{},{canvasBackground:n}))}))}})),[i,e,t]),h=Object(s.c)((()=>"custom"!==i?null:Object(a.h)("div",null,Object(a.h)("div",null,"Background Size"),Object(a.h)("select",{class:"w-full",value:e.canvasBackgroundSize,onChange:r=>{t(o(o({},e),{},{canvasBackgroundSize:r.currentTarget.value}))}},Object(a.h)("option",{value:"auto"},"Auto"),Object(a.h)("option",{value:"cover"},"Cover"),Object(a.h)("option",{value:"contain"},"Contain")))),[i,e]),d=Object(s.c)((()=>"custom"!==i||"cover"===e.canvasBackgroundSize?null:Object(a.h)("div",null,Object(a.h)("div",null,"Background Repeat"),Object(a.h)("select",{class:"w-full",value:e.canvasBackgroundRepeat,onChange:r=>{t(o(o({},e),{},{canvasBackgroundRepeat:r.currentTarget.value}))}},Object(a.h)("option",{value:"repeat"},"On"),Object(a.h)("option",{value:"no-repeat"},"Off")))),[i,e]),b=Object(s.a)((()=>{const e=n.current;if(void 0===e)return;const t=e.toDataURL(),r=document.createElement("a"),o=(new Date).getTime();r.href=t,r.download=`3do-${o}.png`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}),[n]),g=Object(s.c)((()=>r?Object(a.h)("div",{class:"text-center"},Object(a.h)("button",{class:"text-white hover:text-yellow-500 focus:text-yellow-500",onClick:b},"Save Model Image")):null),[r,b]);return Object(a.h)("div",{class:"space-y-4"},g,Object(a.h)("div",null,"Canvas Background",Object(a.h)("select",{class:"w-full",value:i,onChange:e=>u(e.currentTarget.value)},Object(a.h)("option",{value:"transparent"},"Transparent"),Object(a.h)("option",{value:"black"},"Black"),Object(a.h)("option",{value:"white"},"White"),Object(a.h)("option",{value:"custom"},"(Custom Image)")),Object(a.h)("div",{class:"mt-0.5"},f)),h,d)}},u6ao:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n={loadDataUrl:function(e){const t=new FileReader,r=new Promise(((r,n)=>{t.onload=()=>{const o=t.result;"string"==typeof o?r(o):n(new Error(`Failed to read file: ${e.name}`))},t.onerror=()=>{n(new Error(`Failed to read file: ${e.name}`))}}));return t.readAsDataURL(e),r},createImageFromDataUrl:function(e){return new Promise(((t,r)=>{const n=new Image;n.onload=()=>{t(n)},n.onerror=()=>{r(new Error(`Failed to create image for dataUrl: ${e}`))},n.src=e}))}}},weEs:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PRIMITIVE_STRUCT_SIZE=t.PRIMITIVE_STRUCT=t.VERTEX_STRUCT_SIZE=t.VERTEX_STRUCT=t.OBJECT_STRUCT_SIZE=t.OBJECT_STRUCT=void 0,t.OBJECT_STRUCT=[["VersionSignature","U32"],["NumberOfVertexes","U32"],["NumberOfPrimitives","U32"],["UnknownFlag","U32"],["XFromParent","U32"],["YFromParent","U32"],["ZFromParent","U32"],["OffsetToObjectName","U32"],["Always_0","U32"],["OffsetToVertexArray","U32"],["OffsetToPrimitiveArray","U32"],["OffsetToSiblingObject","U32"],["OffsetToChildObject","U32"]],t.OBJECT_STRUCT_SIZE=4*t.OBJECT_STRUCT.length,t.VERTEX_STRUCT=[["x","U32"],["y","U32"],["z","U32"]],t.VERTEX_STRUCT_SIZE=4*t.VERTEX_STRUCT.length,t.PRIMITIVE_STRUCT=[["Unknown_0","U32"],["NumberOfVertexIndexes","U32"],["Always_0","U32"],["OffsetToVertexIndexArray","U32"],["OffsetToTextureName","U32"],["Unknown_1","U32"],["Unknown_2","U32"],["Unknown_3","U32"]],t.PRIMITIVE_STRUCT_SIZE=4*t.PRIMITIVE_STRUCT.length}});
//# sourceMappingURL=bundle.3226b.esm.js.map