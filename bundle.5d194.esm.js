!function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="https://takingdoms.github.io/3do-viewer-preact-with-textures/",e(e.s="Pq/i")}({"/dwh":function(t,e,r){"use strict";function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=r("hosL");e.a=({userSettings:t,setUserSettings:e})=>Object(a.h)("div",{class:"space-y-4"},Object(a.h)("div",{class:"flex flex-col items-stretch"},Object(a.h)("label",{for:"sidebarPosition"},"Sidebar Position"),Object(a.h)("select",{id:"sidebarPosition",value:t.sidebarPosition,onChange:r=>{const n="left"===r.currentTarget.value?"left":"right";e(o(o({},t),{},{sidebarPosition:n}))}},Object(a.h)("option",{value:"left"},"Left"),Object(a.h)("option",{value:"right"},"Right"))))},"/u4b":function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),o(r("CCBT"),e),o(r("ejsI"),e),o(r("BQX+"),e)},"BQX+":function(t,e,r){"use strict";function n(t,e){const r=[];let s=e;do{const e=u.makeStruct(t,s,f.OBJECT_STRUCT),l=o(t,e.OffsetToObjectName),c=i(t,e.OffsetToVertexArray,e.NumberOfVertexes),h=a(t,e.OffsetToPrimitiveArray,e.NumberOfPrimitives),d=0!==e.OffsetToChildObject?n(t,e.OffsetToChildObject):[];r.push({name:l,vertices:c,primitives:h,children:d,xOffset:e.XFromParent,yOffset:e.YFromParent,zOffset:e.ZFromParent}),s=e.OffsetToSiblingObject}while(0!==s);return r}function o(t,e){let r=0;for(let n=0;n<256;n++){r=n;if(0===t.getUint8(e+n))break}const n=new Uint8Array(t.buffer,e,r);return h.decode(n)}function i(t,e,r){const n=[];for(let o=0;o<r;o++){const r=u.makeStruct(t,e+o*f.VERTEX_STRUCT_SIZE,f.VERTEX_STRUCT);n.push({x:r.x,y:r.y,z:r.z})}return n}function a(t,e,r){const n=[];for(let i=0;i<r;i++){const r=u.makeStruct(t,e+i*f.PRIMITIVE_STRUCT_SIZE,f.PRIMITIVE_STRUCT),a=[];for(let e=0;e<r.NumberOfVertexIndexes;e++){const n=t.getUint16(r.OffsetToVertexIndexArray+2*e,!0);a.push(n)}const s=o(t,r.OffsetToTextureName);n.push({vertexIndices:a,textureName:s})}return n}var s=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),l=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),c=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&s(e,t,r);return l(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Parse3do=void 0;const u=c(r("CCBT")),f=r("weEs"),h=new TextDecoder("ascii");e.Parse3do={fromBuffer:function(t){return{rootNodes:n(t,0)}}}},CCBT:function(t,e){"use strict";function r(t,e,r,n="LE"){return"I8"===r?t.getInt8(e):"U8"===r?t.getUint8(e):"I16"===r?t.getInt16(e,"LE"===n):"U16"===r?t.getUint16(e,"LE"===n):t.getInt32(e,"LE"===n)}Object.defineProperty(e,"__esModule",{value:!0}),e.makeStruct=e.readInteger=e.ENDIANNESSES=e.INTEGER_TYPES=void 0,e.INTEGER_TYPES=["U8","I8","U16","I16","U32","I32"],e.ENDIANNESSES=["LE","BE"],e.readInteger=r,e.makeStruct=function(t,e,n,o="LE"){let i={};for(const[a,s]of n)i[a]=r(t,e,s,o),"U8"===s||"I8"===s?e+=1:"U16"===s||"I16"===s?e+=2:"U32"!==s&&"I32"!==s||(e+=4);return i}},GssO:function(t,e,r){"use strict";var n=r("hosL"),o=r("QRet"),i=r("Xvsu");e.a=({color:t,setColor:e})=>{const[r,a]=Object(o.e)(!1);let s="custom";r||(1===t[0]&&1===t[1]&&1===t[2]&&1===t[3]?s="white":1===t[0]&&0===t[1]&&0===t[2]&&1===t[3]?s="red":0===t[0]&&1===t[1]&&0===t[2]&&1===t[3]?s="green":0===t[0]&&0===t[1]&&1===t[2]&&1===t[3]&&(s="blue"));const l=Object(o.c)((()=>r?Object(n.h)("div",{class:"space-y-2"},Object(n.h)(i.a,{id:"red",label:"Red",min:0,max:255,value:Math.floor(255*t[0]),setValue:r=>{e([r/255,t[1],t[2],t[3]])}}),Object(n.h)(i.a,{id:"green",label:"Green",min:0,max:255,value:Math.floor(255*t[1]),setValue:r=>{e([t[0],r/255,t[2],t[3]])}}),Object(n.h)(i.a,{id:"blue",label:"Blue",min:0,max:255,value:Math.floor(255*t[2]),setValue:r=>{e([t[0],t[1],r/255,t[3]])}})):null),[r,t,e]);return Object(n.h)("div",{class:""},Object(n.h)("select",{value:s,onChange:t=>{const r=t.currentTarget.value;if("custom"===r)return void a(!0);a(!1);e("red"===r?[1,0,0,1]:"green"===r?[0,1,0,1]:"blue"===r?[0,0,1,1]:[1,1,1,1])}},Object(n.h)("option",{value:"custom"},"(Custom)"),Object(n.h)("option",{value:"white"},"White"),Object(n.h)("option",{value:"red"},"Red"),Object(n.h)("option",{value:"green"},"Green"),Object(n.h)("option",{value:"blue"},"Blue")),l)}},IomO:function(t,e,r){"use strict";(function(t){var n=r("hosL"),o=r("QRet"),i=r("NOVX"),a=r("tpTz"),s=r("/dwh"),l=r("nF9+"),c=r("qiYd"),u=r("b2Zb");e.a=({modelControls:e,setModelControls:r,userSettings:f,setUserSettings:h,logoDefs:d,canvasRef:b})=>{const g=Object(o.c)((()=>Object(n.h)(i.a,{modelControls:e,setModelControls:r})),[e,r]),p=Object(o.c)((()=>Object(n.h)(s.a,{userSettings:f,setUserSettings:h})),[f,h]),v=Object(o.c)((()=>{const o=e.viewMode,i="regular"===o?Object(n.h)(l.a,{modelControls:e,setModelControls:r,logoDefs:d}):"solid_color"===o?Object(n.h)(c.a,{modelControls:e,setModelControls:r}):"wireframe"===o?Object(n.h)(u.a,{modelControls:e,setModelControls:r}):null;return Object(n.h)(t,null,Object(n.h)("div",{class:"text-center font-bold border-b border-gray-700 mb-2 pb-1 mt-6"},"View Mode Settings"),i)}),[e,r]);return Object(n.h)("div",{class:"max-h-full overflow-auto px-6"},Object(n.h)("div",{class:"text-center font-bold border-b border-gray-700 mb-2 pb-1"},"Controls"),g,v,Object(n.h)("div",{class:"text-center font-bold border-b border-gray-700 mb-2 pb-1 mt-6"},"User Settings"),p,Object(n.h)("div",{class:"text-center font-bold border-b border-gray-700 mb-2 pb-1 mt-6"},"Misc."),Object(n.h)(a.a,{modelControls:e,setModelControls:r,canvasRef:b,enableSaveImageButton:f.preserveDrawingBuffer}))}}).call(this,r("hosL").Fragment)},NOVX:function(t,e,r){"use strict";function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=r("hosL");const s=["regular","solid_color","wireframe"];var l=r("Xvsu");e.a=({modelControls:t,setModelControls:e})=>Object(a.h)("div",{class:"space-y-4"},Object(a.h)(l.a,{id:"zoom",label:"Zoom",max:1e3,value:t.zoom,setValue:r=>e(o(o({},t),{},{zoom:r}))}),Object(a.h)(l.a,{id:"rotationX",label:"Rotation X",min:-180,max:180,value:t.rotationX,setValue:r=>e(o(o({},t),{},{rotationX:r}))}),Object(a.h)(l.a,{id:"rotationY",label:"Rotation Y",min:-180,max:180,value:t.rotationY,setValue:r=>e(o(o({},t),{},{rotationY:r}))}),Object(a.h)(l.a,{id:"rotationZ",label:"Rotation Z",min:-180,max:180,value:t.rotationZ,setValue:r=>e(o(o({},t),{},{rotationZ:r}))}),Object(a.h)(l.a,{id:"panX",label:"Pan X",value:t.translationX,setValue:r=>e(o(o({},t),{},{translationX:r}))}),Object(a.h)(l.a,{id:"panY",label:"Pan Y",value:t.translationY,setValue:r=>e(o(o({},t),{},{translationY:r}))}),Object(a.h)("div",{class:"flex flex-col items-stretch"},Object(a.h)("label",{for:"viewMode"},"View Mode"),Object(a.h)("select",{id:"viewMode",value:t.viewMode,onChange:r=>{const n=s.find((t=>t===r.currentTarget.value));n&&e(o(o({},t),{},{viewMode:n}))}},Object(a.h)("option",{value:"regular"},"Regular"),Object(a.h)("option",{value:"solid_color"},"Solid Color"),Object(a.h)("option",{value:"wireframe"},"Wireframe"))))},"Pq/i":function(t,e,r){"use strict";r.r(e);var n=r("hosL");const{h:o,render:i,hydrate:a}=n,s=t=>t&&t.default?t.default:t,l=t=>"/"===t[t.length-1]?t:t+"/";if("serviceWorker"in navigator&&navigator.serviceWorker.register(l(r.p)+"sw-esm.js"),"function"==typeof s(r("qVkA"))){let t=document.getElementById("preact_root")||document.body.firstElementChild,e=()=>{let e=s(r("qVkA")),n={};const c=document.querySelector('[type="__PREACT_CLI_DATA__"]');c&&(n=JSON.parse(decodeURI(c.innerHTML)).preRenderData||n);const u={preRenderData:n},f=n.url?l(n.url):"";(a&&f===l(location.pathname)?a:i)(o(e,{CLI_DATA:u}),document.body,t)};0,e()}},QRet:function(t,e,r){"use strict";function n(t,e){_.options.__h&&_.options.__h(p,t,O||e),O=0;var r=p.__H||(p.__H={__:[],__h:[]});return t>=r.__.length&&r.__.push({__V:j}),r.__[t]}function o(t){return O=1,function(t,e,r){var o=n(g++,2);if(o.t=t,!o.__c&&(o.__=[r?r(e):b(void 0,e),function(t){var e=o.__N?o.__N[0]:o.__[0],r=o.t(e,t);e!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=p,!p.u)){p.u=!0;var i=p.shouldComponentUpdate;p.shouldComponentUpdate=function(t,e,r){if(!o.__c.__H)return!0;var n=o.__c.__H.__.filter((function(t){return t.__c}));if(n.every((function(t){return!t.__N})))return!i||i.call(this,t,e,r);var a=!1;return n.forEach((function(t){if(t.__N){var e=t.__[0];t.__=t.__N,t.__N=void 0,e!==t.__[0]&&(a=!0)}})),!(!a&&o.__c.props===t)&&(!i||i.call(this,t,e,r))}}return o.__N||o.__}(b,t)}function i(t,e){var r=n(g++,3);!_.options.__s&&d(r.__H,e)&&(r.__=t,r.i=e,p.__H.__h.push(r))}function a(t){return O=5,s((function(){return{current:t}}),[])}function s(t,e){var r=n(g++,7);return d(r.__H,e)?(r.__V=t(),r.i=e,r.__h=t,r.__V):r.__}function l(t,e){return O=8,s((function(){return t}),e)}function c(){for(var t;t=y.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(f),t.__H.__h.forEach(h),t.__H.__h=[]}catch(e){t.__H.__h=[],_.options.__e(e,t.__v)}}function u(t){var e,r=function(){clearTimeout(n),P&&cancelAnimationFrame(e),setTimeout(t)},n=setTimeout(r,100);P&&(e=requestAnimationFrame(r))}function f(t){var e=p,r=t.__c;"function"==typeof r&&(t.__c=void 0,r()),p=e}function h(t){var e=p;t.__c=t.__(),p=e}function d(t,e){return!t||t.length!==e.length||e.some((function(e,r){return e!==t[r]}))}function b(t,e){return"function"==typeof e?e(t):e}r.d(e,"a",(function(){return l})),r.d(e,"b",(function(){return i})),r.d(e,"c",(function(){return s})),r.d(e,"d",(function(){return a})),r.d(e,"e",(function(){return o}));var g,p,v,m,_=r("hosL"),O=0,y=[],j=[],x=_.options.__b,w=_.options.__r,M=_.options.diffed,S=_.options.__c,T=_.options.unmount;_.options.__b=function(t){p=null,x&&x(t)},_.options.__r=function(t){w&&w(t),g=0;var e=(p=t.__c).__H;e&&(v===p?(e.__h=[],p.__h=[],e.__.forEach((function(t){t.__N&&(t.__=t.__N),t.__V=j,t.__N=t.i=void 0}))):(e.__h.forEach(f),e.__h.forEach(h),e.__h=[])),v=p},_.options.diffed=function(t){M&&M(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(1!==y.push(e)&&m===_.options.requestAnimationFrame||((m=_.options.requestAnimationFrame)||u)(c)),e.__H.__.forEach((function(t){t.i&&(t.__H=t.i),t.__V!==j&&(t.__=t.__V),t.i=void 0,t.__V=j}))),v=p=null},_.options.__c=function(t,e){e.some((function(t){try{t.__h.forEach(f),t.__h=t.__h.filter((function(t){return!t.__||h(t)}))}catch(r){e.some((function(t){t.__h&&(t.__h=[])})),e=[],_.options.__e(r,t.__v)}})),S&&S(t,e)},_.options.unmount=function(t){T&&T(t);var e,r=t.__c;r&&r.__H&&(r.__H.__.forEach((function(t){try{f(t)}catch(t){e=t}})),r.__H=void 0,e&&_.options.__e(e,r.__v))};var P="function"==typeof requestAnimationFrame},Xvsu:function(t,e,r){"use strict";var n=r("hosL");e.a=({id:t,label:e,min:r,max:o,value:i,setValue:a})=>Object(n.h)("div",null,Object(n.h)("div",null,Object(n.h)("label",{for:t},e)),Object(n.h)("div",{class:"flex items-center space-x-2"},Object(n.h)("input",{type:"number",style:{width:"80px"},value:i,onChange:t=>{a(+t.currentTarget.value)}}),Object(n.h)("input",{class:"grow",type:"range",min:r,max:o,style:{width:"120px"},value:i,onChange:t=>{a(+t.currentTarget.value||0)}})))},b2Zb:function(t,e,r){"use strict";function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=r("hosL"),s=r("GssO");e.a=({modelControls:t,setModelControls:e})=>Object(a.h)("div",{class:"space-y-4"},Object(a.h)("div",null,Object(a.h)("div",{class:""},"Wireframe Color"),Object(a.h)(s.a,{color:t.wireframeColor,setColor:r=>e(o(o({},t),{},{wireframeColor:r}))})))},ejsI:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},hosL:function(t,e,r){"use strict";function n(t,e){for(var r in e)t[r]=e[r];return t}function o(t){var e=t.parentNode;e&&e.removeChild(t)}function i(t,e,r){var n,o,i,s={};for(i in e)"key"==i?n=e[i]:"ref"==i?o=e[i]:s[i]=e[i];if(arguments.length>2&&(s.children=arguments.length>3?D.call(arguments,2):r),"function"==typeof t&&null!=t.defaultProps)for(i in t.defaultProps)void 0===s[i]&&(s[i]=t.defaultProps[i]);return a(t,s,n,o,null)}function a(t,e,r,n,o){var i={type:t,props:e,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==o?++k:o};return null==o&&null!=U.vnode&&U.vnode(i),i}function s(){return{current:null}}function l(t){return t.children}function c(t,e){this.props=t,this.context=e}function u(t,e){if(null==e)return t.__?u(t.__,t.__.__k.indexOf(t)+1):null;for(var r;e<t.__k.length;e++)if(null!=(r=t.__k[e])&&null!=r.__e)return r.__e;return"function"==typeof t.type?u(t):null}function f(t){var e,r;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(r=t.__k[e])&&null!=r.__e){t.__e=t.__c.base=r.__e;break}return f(t)}}function h(t){(!t.__d&&(t.__d=!0)&&F.push(t)&&!d.__r++||I!==U.debounceRendering)&&((I=U.debounceRendering)||setTimeout)(d)}function d(){for(var t;d.__r=F.length;)t=F.sort((function(t,e){return t.__v.__b-e.__v.__b})),F=[],t.some((function(t){var e,r,o,i,a,s;t.__d&&(a=(i=(e=t).__v).__e,(s=e.__P)&&(r=[],(o=n({},i)).__v=i.__v+1,j(s,i,o,e.__n,void 0!==s.ownerSVGElement,null!=i.__h?[a]:null,r,null==a?u(i):a,i.__h),x(r,i),i.__e!=a&&f(i)))}))}function b(t,e,r,n,o,i,s,c,f,h){var d,b,p,m,_,O,y,x=n&&n.__k||N,w=x.length;for(r.__k=[],d=0;d<e.length;d++)if(null!=(m=r.__k[d]=null==(m=e[d])||"boolean"==typeof m?null:"string"==typeof m||"number"==typeof m||"bigint"==typeof m?a(null,m,null,null,m):Array.isArray(m)?a(l,{children:m},null,null,null):m.__b>0?a(m.type,m.props,m.key,m.ref?m.ref:null,m.__v):m)){if(m.__=r,m.__b=r.__b+1,null===(p=x[d])||p&&m.key==p.key&&m.type===p.type)x[d]=void 0;else for(b=0;b<w;b++){if((p=x[b])&&m.key==p.key&&m.type===p.type){x[b]=void 0;break}p=null}j(t,m,p=p||B,o,i,s,c,f,h),_=m.__e,(b=m.ref)&&p.ref!=b&&(y||(y=[]),p.ref&&y.push(p.ref,null,m),y.push(b,m.__c||_,m)),null!=_?(null==O&&(O=_),"function"==typeof m.type&&m.__k===p.__k?m.__d=f=g(m,f,t):f=v(t,m,p,x,_,f),"function"==typeof r.type&&(r.__d=f)):f&&p.__e==f&&f.parentNode!=t&&(f=u(p))}for(r.__e=O,d=w;d--;)null!=x[d]&&S(x[d],x[d]);if(y)for(d=0;d<y.length;d++)M(y[d],y[++d],y[++d])}function g(t,e,r){for(var n,o=t.__k,i=0;o&&i<o.length;i++)(n=o[i])&&(n.__=t,e="function"==typeof n.type?g(n,e,r):v(r,n,n,o,n.__e,e));return e}function p(t,e){return e=e||[],null==t||"boolean"==typeof t||(Array.isArray(t)?t.some((function(t){p(t,e)})):e.push(t)),e}function v(t,e,r,n,o,i){var a,s,l;if(void 0!==e.__d)a=e.__d,e.__d=void 0;else if(null==r||o!=i||null==o.parentNode)t:if(null==i||i.parentNode!==t)t.appendChild(o),a=null;else{for(s=i,l=0;(s=s.nextSibling)&&l<n.length;l+=1)if(s==o)break t;t.insertBefore(o,i),a=i}return void 0!==a?a:o.nextSibling}function m(t,e,r){"-"===e[0]?t.setProperty(e,r):t[e]=null==r?"":"number"!=typeof r||V.test(e)?r:r+"px"}function _(t,e,r,n,o){var i;t:if("style"===e)if("string"==typeof r)t.style.cssText=r;else{if("string"==typeof n&&(t.style.cssText=n=""),n)for(e in n)r&&e in r||m(t.style,e,"");if(r)for(e in r)n&&r[e]===n[e]||m(t.style,e,r[e])}else if("o"===e[0]&&"n"===e[1])i=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=r,r?n||t.addEventListener(e,i?y:O,i):t.removeEventListener(e,i?y:O,i);else if("dangerouslySetInnerHTML"!==e){if(o)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==e&&"list"!==e&&"form"!==e&&"tabIndex"!==e&&"download"!==e&&e in t)try{t[e]=null==r?"":r;break t}catch(t){}"function"==typeof r||(null==r||!1===r&&-1==e.indexOf("-")?t.removeAttribute(e):t.setAttribute(e,r))}}function O(t){this.l[t.type+!1](U.event?U.event(t):t)}function y(t){this.l[t.type+!0](U.event?U.event(t):t)}function j(t,e,r,o,i,a,s,u,f){var h,d,g,p,v,m,_,O,y,j,x,M,S,P,E,C=e.type;if(void 0!==e.constructor)return null;null!=r.__h&&(f=r.__h,u=e.__e=r.__e,e.__h=null,a=[u]),(h=U.__b)&&h(e);try{t:if("function"==typeof C){if(O=e.props,y=(h=C.contextType)&&o[h.__c],j=h?y?y.props.value:h.__:o,r.__c?_=(d=e.__c=r.__c).__=d.__E:("prototype"in C&&C.prototype.render?e.__c=d=new C(O,j):(e.__c=d=new c(O,j),d.constructor=C,d.render=T),y&&y.sub(d),d.props=O,d.state||(d.state={}),d.context=j,d.__n=o,g=d.__d=!0,d.__h=[],d._sb=[]),null==d.__s&&(d.__s=d.state),null!=C.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=n({},d.__s)),n(d.__s,C.getDerivedStateFromProps(O,d.__s))),p=d.props,v=d.state,g)null==C.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==C.getDerivedStateFromProps&&O!==p&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(O,j),!d.__e&&null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(O,d.__s,j)||e.__v===r.__v){for(d.props=O,d.state=d.__s,e.__v!==r.__v&&(d.__d=!1),d.__v=e,e.__e=r.__e,e.__k=r.__k,e.__k.forEach((function(t){t&&(t.__=e)})),x=0;x<d._sb.length;x++)d.__h.push(d._sb[x]);d._sb=[],d.__h.length&&s.push(d);break t}null!=d.componentWillUpdate&&d.componentWillUpdate(O,d.__s,j),null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(p,v,m)}))}if(d.context=j,d.props=O,d.__v=e,d.__P=t,M=U.__r,S=0,"prototype"in C&&C.prototype.render){for(d.state=d.__s,d.__d=!1,M&&M(e),h=d.render(d.props,d.state,d.context),P=0;P<d._sb.length;P++)d.__h.push(d._sb[P]);d._sb=[]}else do{d.__d=!1,M&&M(e),h=d.render(d.props,d.state,d.context),d.state=d.__s}while(d.__d&&++S<25);d.state=d.__s,null!=d.getChildContext&&(o=n(n({},o),d.getChildContext())),g||null==d.getSnapshotBeforeUpdate||(m=d.getSnapshotBeforeUpdate(p,v)),E=null!=h&&h.type===l&&null==h.key?h.props.children:h,b(t,Array.isArray(E)?E:[E],e,r,o,i,a,s,u,f),d.base=e.__e,e.__h=null,d.__h.length&&s.push(d),_&&(d.__E=d.__=null),d.__e=!1}else null==a&&e.__v===r.__v?(e.__k=r.__k,e.__e=r.__e):e.__e=w(r.__e,e,r,o,i,a,s,f);(h=U.diffed)&&h(e)}catch(t){e.__v=null,(f||null!=a)&&(e.__e=u,e.__h=!!f,a[a.indexOf(u)]=null),U.__e(t,e,r)}}function x(t,e){U.__c&&U.__c(e,t),t.some((function(e){try{t=e.__h,e.__h=[],t.some((function(t){t.call(e)}))}catch(t){U.__e(t,e.__v)}}))}function w(t,e,r,n,i,a,s,l){var c,f,h,d=r.props,g=e.props,p=e.type,v=0;if("svg"===p&&(i=!0),null!=a)for(;v<a.length;v++)if((c=a[v])&&"setAttribute"in c==!!p&&(p?c.localName===p:3===c.nodeType)){t=c,a[v]=null;break}if(null==t){if(null===p)return document.createTextNode(g);t=i?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,g.is&&g),a=null,l=!1}if(null===p)d===g||l&&t.data===g||(t.data=g);else{if(a=a&&D.call(t.childNodes),f=(d=r.props||B).dangerouslySetInnerHTML,h=g.dangerouslySetInnerHTML,!l){if(null!=a)for(d={},v=0;v<t.attributes.length;v++)d[t.attributes[v].name]=t.attributes[v].value;(h||f)&&(h&&(f&&h.__html==f.__html||h.__html===t.innerHTML)||(t.innerHTML=h&&h.__html||""))}if(function(t,e,r,n,o){var i;for(i in r)"children"===i||"key"===i||i in e||_(t,i,null,r[i],n);for(i in e)o&&"function"!=typeof e[i]||"children"===i||"key"===i||"value"===i||"checked"===i||r[i]===e[i]||_(t,i,e[i],r[i],n)}(t,g,d,i,l),h)e.__k=[];else if(v=e.props.children,b(t,Array.isArray(v)?v:[v],e,r,n,i&&"foreignObject"!==p,a,s,a?a[0]:r.__k&&u(r,0),l),null!=a)for(v=a.length;v--;)null!=a[v]&&o(a[v]);l||("value"in g&&void 0!==(v=g.value)&&(v!==t.value||"progress"===p&&!v||"option"===p&&v!==d.value)&&_(t,"value",v,d.value,!1),"checked"in g&&void 0!==(v=g.checked)&&v!==t.checked&&_(t,"checked",v,d.checked,!1))}return t}function M(t,e,r){try{"function"==typeof t?t(e):t.current=e}catch(t){U.__e(t,r)}}function S(t,e,r){var n,i;if(U.unmount&&U.unmount(t),(n=t.ref)&&(n.current&&n.current!==t.__e||M(n,null,e)),null!=(n=t.__c)){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(t){U.__e(t,e)}n.base=n.__P=null,t.__c=void 0}if(n=t.__k)for(i=0;i<n.length;i++)n[i]&&S(n[i],e,r||"function"!=typeof t.type);r||null==t.__e||o(t.__e),t.__=t.__e=t.__d=void 0}function T(t,e,r){return this.constructor(t,r)}function P(t,e,r){var n,o,a;U.__&&U.__(t,e),o=(n="function"==typeof r)?null:r&&r.__k||e.__k,a=[],j(e,t=(!n&&r||e).__k=i(l,null,[t]),o||B,B,void 0!==e.ownerSVGElement,!n&&r?[r]:o?null:e.firstChild?D.call(e.childNodes):null,a,!n&&r?r:o?o.__e:e.firstChild,n),x(a,t)}function E(t,e){P(t,e,E)}function C(t,e,r){var o,i,s,l=n({},t.props);for(s in e)"key"==s?o=e[s]:"ref"==s?i=e[s]:l[s]=e[s];return arguments.length>2&&(l.children=arguments.length>3?D.call(arguments,2):r),a(t.type,l,o||t.key,i||t.ref,null)}function R(t,e){var r={__c:e="__cC"+A++,__:t,Consumer:function(t,e){return t.children(e)},Provider:function(t){var r,n;return this.getChildContext||(r=[],(n={})[e]=this,this.getChildContext=function(){return n},this.shouldComponentUpdate=function(t){this.props.value!==t.value&&r.some(h)},this.sub=function(t){r.push(t);var e=t.componentWillUnmount;t.componentWillUnmount=function(){r.splice(r.indexOf(t),1),e&&e.call(t)}}),t.children}};return r.Provider.__=r.Consumer.contextType=r}r.r(e),r.d(e,"Component",(function(){return c})),r.d(e,"Fragment",(function(){return l})),r.d(e,"cloneElement",(function(){return C})),r.d(e,"createContext",(function(){return R})),r.d(e,"createElement",(function(){return i})),r.d(e,"createRef",(function(){return s})),r.d(e,"h",(function(){return i})),r.d(e,"hydrate",(function(){return E})),r.d(e,"isValidElement",(function(){return L})),r.d(e,"options",(function(){return U})),r.d(e,"render",(function(){return P})),r.d(e,"toChildArray",(function(){return p}));var D,U,k,L,F,I,A,B={},N=[],V=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;D=N.slice,U={__e:function(t,e,r,n){for(var o,i,a;e=e.__;)if((o=e.__c)&&!o.__)try{if((i=o.constructor)&&null!=i.getDerivedStateFromError&&(o.setState(i.getDerivedStateFromError(t)),a=o.__d),null!=o.componentDidCatch&&(o.componentDidCatch(t,n||{}),a=o.__d),a)return o.__E=o}catch(e){t=e}throw t}},k=0,L=function(t){return null!=t&&void 0===t.constructor},c.prototype.setState=function(t,e){var r;r=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=n({},this.state),"function"==typeof t&&(t=t(n({},r),this.props)),t&&n(r,t),null!=t&&this.__v&&(e&&this._sb.push(e),h(this))},c.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),h(this))},c.prototype.render=l,F=[],d.__r=0,A=0},"nF9+":function(t,e,r){"use strict";function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=r("hosL");const s=({htmlColor:t,isSelected:e,onSelect:r})=>Object(a.h)("button",{class:"w-8 h-8 border border-2 p-1 rounded-full flex justify-center items-center",style:{borderColor:t},onClick:()=>{e||r()}},Object(a.h)("span",{class:"w-full h-full rounded-full leading-none",style:{backgroundColor:e?t:""}}));e.a=({modelControls:t,setModelControls:e,logoDefs:r})=>Object(a.h)("div",{class:"space-y-4"},Object(a.h)("div",null,Object(a.h)("div",null,"Team Color"),Object(a.h)("div",{class:"flex flex-wrap -m-1 p-1"},r.idxList.map((n=>Object(a.h)("div",{key:n,class:"m-1"},Object(a.h)(s,{htmlColor:r.idxToHtmlColor(n),isSelected:t.logoColorIdx===n,onSelect:()=>e(o(o({},t),{},{logoColorIdx:n}))})))))),Object(a.h)("div",{class:"space-y-2"},Object(a.h)("div",null,Object(a.h)("div",null,"Texture Filter (Min.)"),Object(a.h)("select",{value:t.textureFilterMin,onChange:r=>{const n=r.currentTarget.value;e(o(o({},t),{},{textureFilterMin:n}))}},Object(a.h)("option",{value:"nearest"},"Nearest"),Object(a.h)("option",{value:"linear"},"Linear"))),Object(a.h)("div",null,Object(a.h)("div",null,"Texture Filter (Mag.)"),Object(a.h)("select",{value:t.textureFilterMag,onChange:r=>{const n=r.currentTarget.value;e(o(o({},t),{},{textureFilterMag:n}))}},Object(a.h)("option",{value:"nearest"},"Nearest"),Object(a.h)("option",{value:"linear"},"Linear")))),Object(a.h)("div",null,Object(a.h)("label",{class:"flex items-center"},Object(a.h)("input",{type:"checkbox",checked:t.enableLightingRegular,onChange:r=>{e(o(o({},t),{},{enableLightingRegular:r.currentTarget.checked}))}}),Object(a.h)("span",{class:"pl-1"},"Enable Lighting"))))},qVkA:function(t,e,r){"use strict";function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u(t){We=t}function f(t){return t*ze}function h(t,e){return Math.abs(t-e)<=Ye*Math.max(1,Math.abs(t),Math.abs(e))}function d(){var t=new We(16);return We!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function b(t){var e=new We(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function g(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function p(t,e,r,n,o,i,a,s,l,c,u,f,h,d,b,g){var p=new We(16);return p[0]=t,p[1]=e,p[2]=r,p[3]=n,p[4]=o,p[5]=i,p[6]=a,p[7]=s,p[8]=l,p[9]=c,p[10]=u,p[11]=f,p[12]=h,p[13]=d,p[14]=b,p[15]=g,p}function v(t,e,r,n,o,i,a,s,l,c,u,f,h,d,b,g,p){return t[0]=e,t[1]=r,t[2]=n,t[3]=o,t[4]=i,t[5]=a,t[6]=s,t[7]=l,t[8]=c,t[9]=u,t[10]=f,t[11]=h,t[12]=d,t[13]=b,t[14]=g,t[15]=p,t}function m(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _(t,e){if(t===e){var r=e[1],n=e[2],o=e[3],i=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=i,t[11]=e[14],t[12]=o,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function O(t,e){var r=e[0],n=e[1],o=e[2],i=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],f=e[9],h=e[10],d=e[11],b=e[12],g=e[13],p=e[14],v=e[15],m=r*s-n*a,_=r*l-o*a,O=r*c-i*a,y=n*l-o*s,j=n*c-i*s,x=o*c-i*l,w=u*g-f*b,M=u*p-h*b,S=u*v-d*b,T=f*p-h*g,P=f*v-d*g,E=h*v-d*p,C=m*E-_*P+O*T+y*S-j*M+x*w;return C?(t[0]=(s*E-l*P+c*T)*(C=1/C),t[1]=(o*P-n*E-i*T)*C,t[2]=(g*x-p*j+v*y)*C,t[3]=(h*j-f*x-d*y)*C,t[4]=(l*S-a*E-c*M)*C,t[5]=(r*E-o*S+i*M)*C,t[6]=(p*O-b*x-v*_)*C,t[7]=(u*x-h*O+d*_)*C,t[8]=(a*P-s*S+c*w)*C,t[9]=(n*S-r*P-i*w)*C,t[10]=(b*j-g*O+v*m)*C,t[11]=(f*O-u*j-d*m)*C,t[12]=(s*M-a*T-l*w)*C,t[13]=(r*T-n*M+o*w)*C,t[14]=(g*_-b*y-p*m)*C,t[15]=(u*y-f*_+h*m)*C,t):null}function y(t,e){var r=e[0],n=e[1],o=e[2],i=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],f=e[9],h=e[10],d=e[11],b=e[12],g=e[13],p=e[14],v=e[15];return t[0]=s*(h*v-d*p)-f*(l*v-c*p)+g*(l*d-c*h),t[1]=-(n*(h*v-d*p)-f*(o*v-i*p)+g*(o*d-i*h)),t[2]=n*(l*v-c*p)-s*(o*v-i*p)+g*(o*c-i*l),t[3]=-(n*(l*d-c*h)-s*(o*d-i*h)+f*(o*c-i*l)),t[4]=-(a*(h*v-d*p)-u*(l*v-c*p)+b*(l*d-c*h)),t[5]=r*(h*v-d*p)-u*(o*v-i*p)+b*(o*d-i*h),t[6]=-(r*(l*v-c*p)-a*(o*v-i*p)+b*(o*c-i*l)),t[7]=r*(l*d-c*h)-a*(o*d-i*h)+u*(o*c-i*l),t[8]=a*(f*v-d*g)-u*(s*v-c*g)+b*(s*d-c*f),t[9]=-(r*(f*v-d*g)-u*(n*v-i*g)+b*(n*d-i*f)),t[10]=r*(s*v-c*g)-a*(n*v-i*g)+b*(n*c-i*s),t[11]=-(r*(s*d-c*f)-a*(n*d-i*f)+u*(n*c-i*s)),t[12]=-(a*(f*p-h*g)-u*(s*p-l*g)+b*(s*h-l*f)),t[13]=r*(f*p-h*g)-u*(n*p-o*g)+b*(n*h-o*f),t[14]=-(r*(s*p-l*g)-a*(n*p-o*g)+b*(n*l-o*s)),t[15]=r*(s*h-l*f)-a*(n*h-o*f)+u*(n*l-o*s),t}function j(t){var e=t[0],r=t[1],n=t[2],o=t[3],i=t[4],a=t[5],s=t[6],l=t[7],c=t[8],u=t[9],f=t[10],h=t[11],d=t[12],b=t[13],g=t[14],p=t[15];return(e*a-r*i)*(f*p-h*g)-(e*s-n*i)*(u*p-h*b)+(e*l-o*i)*(u*g-f*b)+(r*s-n*a)*(c*p-h*d)-(r*l-o*a)*(c*g-f*d)+(n*l-o*s)*(c*b-u*d)}function x(t,e,r){var n=e[0],o=e[1],i=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],f=e[8],h=e[9],d=e[10],b=e[11],g=e[12],p=e[13],v=e[14],m=e[15],_=r[0],O=r[1],y=r[2],j=r[3];return t[0]=_*n+O*s+y*f+j*g,t[1]=_*o+O*l+y*h+j*p,t[2]=_*i+O*c+y*d+j*v,t[3]=_*a+O*u+y*b+j*m,t[4]=(_=r[4])*n+(O=r[5])*s+(y=r[6])*f+(j=r[7])*g,t[5]=_*o+O*l+y*h+j*p,t[6]=_*i+O*c+y*d+j*v,t[7]=_*a+O*u+y*b+j*m,t[8]=(_=r[8])*n+(O=r[9])*s+(y=r[10])*f+(j=r[11])*g,t[9]=_*o+O*l+y*h+j*p,t[10]=_*i+O*c+y*d+j*v,t[11]=_*a+O*u+y*b+j*m,t[12]=(_=r[12])*n+(O=r[13])*s+(y=r[14])*f+(j=r[15])*g,t[13]=_*o+O*l+y*h+j*p,t[14]=_*i+O*c+y*d+j*v,t[15]=_*a+O*u+y*b+j*m,t}function w(t,e,r){var n,o,i,a,s,l,c,u,f,h,d,b,g=r[0],p=r[1],v=r[2];return e===t?(t[12]=e[0]*g+e[4]*p+e[8]*v+e[12],t[13]=e[1]*g+e[5]*p+e[9]*v+e[13],t[14]=e[2]*g+e[6]*p+e[10]*v+e[14],t[15]=e[3]*g+e[7]*p+e[11]*v+e[15]):(o=e[1],i=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],f=e[8],h=e[9],d=e[10],b=e[11],t[0]=n=e[0],t[1]=o,t[2]=i,t[3]=a,t[4]=s,t[5]=l,t[6]=c,t[7]=u,t[8]=f,t[9]=h,t[10]=d,t[11]=b,t[12]=n*g+s*p+f*v+e[12],t[13]=o*g+l*p+h*v+e[13],t[14]=i*g+c*p+d*v+e[14],t[15]=a*g+u*p+b*v+e[15]),t}function M(t,e,r){var n=r[0],o=r[1],i=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function S(t,e,r,n){var o,i,a,s,l,c,u,f,h,d,b,g,p,v,m,_,O,y,j,x,w,M,S,T,P=n[0],E=n[1],C=n[2],R=Math.hypot(P,E,C);return R<Ye?null:(P*=R=1/R,E*=R,C*=R,o=Math.sin(r),i=Math.cos(r),l=e[1],c=e[2],u=e[3],h=e[5],d=e[6],b=e[7],p=e[9],v=e[10],m=e[11],j=P*E*(a=1-i)-C*o,x=E*E*a+i,w=C*E*a+P*o,M=P*C*a+E*o,S=E*C*a-P*o,T=C*C*a+i,t[0]=(s=e[0])*(_=P*P*a+i)+(f=e[4])*(O=E*P*a+C*o)+(g=e[8])*(y=C*P*a-E*o),t[1]=l*_+h*O+p*y,t[2]=c*_+d*O+v*y,t[3]=u*_+b*O+m*y,t[4]=s*j+f*x+g*w,t[5]=l*j+h*x+p*w,t[6]=c*j+d*x+v*w,t[7]=u*j+b*x+m*w,t[8]=s*M+f*S+g*T,t[9]=l*M+h*S+p*T,t[10]=c*M+d*S+v*T,t[11]=u*M+b*S+m*T,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function T(t,e,r){var n=Math.sin(r),o=Math.cos(r),i=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*o+c*n,t[5]=a*o+u*n,t[6]=s*o+f*n,t[7]=l*o+h*n,t[8]=c*o-i*n,t[9]=u*o-a*n,t[10]=f*o-s*n,t[11]=h*o-l*n,t}function P(t,e,r){var n=Math.sin(r),o=Math.cos(r),i=e[0],a=e[1],s=e[2],l=e[3],c=e[8],u=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*o-c*n,t[1]=a*o-u*n,t[2]=s*o-f*n,t[3]=l*o-h*n,t[8]=i*n+c*o,t[9]=a*n+u*o,t[10]=s*n+f*o,t[11]=l*n+h*o,t}function E(t,e,r){var n=Math.sin(r),o=Math.cos(r),i=e[0],a=e[1],s=e[2],l=e[3],c=e[4],u=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*o+c*n,t[1]=a*o+u*n,t[2]=s*o+f*n,t[3]=l*o+h*n,t[4]=c*o-i*n,t[5]=u*o-a*n,t[6]=f*o-s*n,t[7]=h*o-l*n,t}function C(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function R(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function D(t,e,r){var n,o,i,a=r[0],s=r[1],l=r[2],c=Math.hypot(a,s,l);return c<Ye?null:(a*=c=1/c,s*=c,l*=c,n=Math.sin(e),o=Math.cos(e),t[0]=a*a*(i=1-o)+o,t[1]=s*a*i+l*n,t[2]=l*a*i-s*n,t[3]=0,t[4]=a*s*i-l*n,t[5]=s*s*i+o,t[6]=l*s*i+a*n,t[7]=0,t[8]=a*l*i+s*n,t[9]=s*l*i-a*n,t[10]=l*l*i+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function U(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function k(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function L(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function F(t,e,r){var n=e[0],o=e[1],i=e[2],a=e[3],s=n+n,l=o+o,c=i+i,u=n*s,f=n*l,h=n*c,d=o*l,b=o*c,g=i*c,p=a*s,v=a*l,m=a*c;return t[0]=1-(d+g),t[1]=f+m,t[2]=h-v,t[3]=0,t[4]=f-m,t[5]=1-(u+g),t[6]=b+p,t[7]=0,t[8]=h+v,t[9]=b-p,t[10]=1-(u+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function I(t,e){var r=new We(3),n=-e[0],o=-e[1],i=-e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],f=n*n+o*o+i*i+a*a;return f>0?(r[0]=2*(s*a+u*n+l*i-c*o)/f,r[1]=2*(l*a+u*o+c*n-s*i)/f,r[2]=2*(c*a+u*i+s*o-l*n)/f):(r[0]=2*(s*a+u*n+l*i-c*o),r[1]=2*(l*a+u*o+c*n-s*i),r[2]=2*(c*a+u*i+s*o-l*n)),F(t,e,r),t}function A(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function B(t,e){var r=e[4],n=e[5],o=e[6],i=e[8],a=e[9],s=e[10];return t[0]=Math.hypot(e[0],e[1],e[2]),t[1]=Math.hypot(r,n,o),t[2]=Math.hypot(i,a,s),t}function N(t,e){var r=new We(3);B(r,e);var n=1/r[0],o=1/r[1],i=1/r[2],a=e[0]*n,s=e[1]*o,l=e[2]*i,c=e[4]*n,u=e[5]*o,f=e[6]*i,h=e[8]*n,d=e[9]*o,b=e[10]*i,g=a+u+b,p=0;return g>0?(p=2*Math.sqrt(g+1),t[3]=.25*p,t[0]=(f-d)/p,t[1]=(h-l)/p,t[2]=(s-c)/p):a>u&&a>b?(p=2*Math.sqrt(1+a-u-b),t[3]=(f-d)/p,t[0]=.25*p,t[1]=(s+c)/p,t[2]=(h+l)/p):u>b?(p=2*Math.sqrt(1+u-a-b),t[3]=(h-l)/p,t[0]=(s+c)/p,t[1]=.25*p,t[2]=(f+d)/p):(p=2*Math.sqrt(1+b-a-u),t[3]=(s-c)/p,t[0]=(h+l)/p,t[1]=(f+d)/p,t[2]=.25*p),t}function V(t,e,r,n){var o=e[0],i=e[1],a=e[2],s=e[3],l=o+o,c=i+i,u=a+a,f=o*l,h=o*c,d=o*u,b=i*c,g=i*u,p=a*u,v=s*l,m=s*c,_=s*u,O=n[0],y=n[1],j=n[2];return t[0]=(1-(b+p))*O,t[1]=(h+_)*O,t[2]=(d-m)*O,t[3]=0,t[4]=(h-_)*y,t[5]=(1-(f+p))*y,t[6]=(g+v)*y,t[7]=0,t[8]=(d+m)*j,t[9]=(g-v)*j,t[10]=(1-(f+b))*j,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function X(t,e,r,n,o){var i=e[0],a=e[1],s=e[2],l=e[3],c=i+i,u=a+a,f=s+s,h=i*c,d=i*u,b=i*f,g=a*u,p=a*f,v=s*f,m=l*c,_=l*u,O=l*f,y=n[0],j=n[1],x=n[2],w=o[0],M=o[1],S=o[2],T=(1-(g+v))*y,P=(d+O)*y,E=(b-_)*y,C=(d-O)*j,R=(1-(h+v))*j,D=(p+m)*j,U=(b+_)*x,k=(p-m)*x,L=(1-(h+g))*x;return t[0]=T,t[1]=P,t[2]=E,t[3]=0,t[4]=C,t[5]=R,t[6]=D,t[7]=0,t[8]=U,t[9]=k,t[10]=L,t[11]=0,t[12]=r[0]+w-(T*w+C*M+U*S),t[13]=r[1]+M-(P*w+R*M+k*S),t[14]=r[2]+S-(E*w+D*M+L*S),t[15]=1,t}function $(t,e){var r=e[0],n=e[1],o=e[2],i=e[3],a=r+r,s=n+n,l=o+o,c=r*a,u=n*a,f=n*s,h=o*a,d=o*s,b=o*l,g=i*a,p=i*s,v=i*l;return t[0]=1-f-b,t[1]=u+v,t[2]=h-p,t[3]=0,t[4]=u-v,t[5]=1-c-b,t[6]=d+g,t[7]=0,t[8]=h+p,t[9]=d-g,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Y(t,e,r,n,o,i,a){var s=1/(r-e),l=1/(o-n),c=1/(i-a);return t[0]=2*i*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*l,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(o+n)*l,t[10]=(a+i)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*i*2*c,t[15]=0,t}function W(t,e,r,n,o){var i,a=1/Math.tan(e/2);return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(t[10]=(o+n)*(i=1/(n-o)),t[14]=2*o*n*i):(t[10]=-1,t[14]=-2*n),t}function H(t,e,r,n,o){var i,a=1/Math.tan(e/2);return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(t[10]=o*(i=1/(n-o)),t[14]=o*n*i):(t[10]=-1,t[14]=-n),t}function z(t,e,r,n){var o=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(a+s),c=2/(o+i);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-s)*l*.5,t[9]=(o-i)*c*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function G(t,e,r,n,o,i,a){var s=1/(e-r),l=1/(n-o),c=1/(i-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*s,t[13]=(o+n)*l,t[14]=(a+i)*c,t[15]=1,t}function q(t,e,r,n,o,i,a){var s=1/(e-r),l=1/(n-o),c=1/(i-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+r)*s,t[13]=(o+n)*l,t[14]=i*c,t[15]=1,t}function Z(t,e,r,n){var o,i,a,s,l,c,u,f,h,d,b=e[0],g=e[1],p=e[2],v=n[0],_=n[1],O=n[2],y=r[0],j=r[1],x=r[2];return Math.abs(b-y)<Ye&&Math.abs(g-j)<Ye&&Math.abs(p-x)<Ye?m(t):(u=b-y,f=g-j,h=p-x,o=_*(h*=d=1/Math.hypot(u,f,h))-O*(f*=d),i=O*(u*=d)-v*h,a=v*f-_*u,(d=Math.hypot(o,i,a))?(o*=d=1/d,i*=d,a*=d):(o=0,i=0,a=0),s=f*a-h*i,l=h*o-u*a,c=u*i-f*o,(d=Math.hypot(s,l,c))?(s*=d=1/d,l*=d,c*=d):(s=0,l=0,c=0),t[0]=o,t[1]=s,t[2]=u,t[3]=0,t[4]=i,t[5]=l,t[6]=f,t[7]=0,t[8]=a,t[9]=c,t[10]=h,t[11]=0,t[12]=-(o*b+i*g+a*p),t[13]=-(s*b+l*g+c*p),t[14]=-(u*b+f*g+h*p),t[15]=1,t)}function K(t,e,r,n){var o=e[0],i=e[1],a=e[2],s=n[0],l=n[1],c=n[2],u=o-r[0],f=i-r[1],h=a-r[2],d=u*u+f*f+h*h;d>0&&(u*=d=1/Math.sqrt(d),f*=d,h*=d);var b=l*h-c*f,g=c*u-s*h,p=s*f-l*u;return(d=b*b+g*g+p*p)>0&&(b*=d=1/Math.sqrt(d),g*=d,p*=d),t[0]=b,t[1]=g,t[2]=p,t[3]=0,t[4]=f*p-h*g,t[5]=h*b-u*p,t[6]=u*g-f*b,t[7]=0,t[8]=u,t[9]=f,t[10]=h,t[11]=0,t[12]=o,t[13]=i,t[14]=a,t[15]=1,t}function Q(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function J(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function tt(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function et(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function rt(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function nt(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function ot(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function it(t,e){var r=t[0],n=t[1],o=t[2],i=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],f=t[9],h=t[10],d=t[11],b=t[12],g=t[13],p=t[14],v=t[15],m=e[0],_=e[1],O=e[2],y=e[3],j=e[4],x=e[5],w=e[6],M=e[7],S=e[8],T=e[9],P=e[10],E=e[11],C=e[12],R=e[13],D=e[14],U=e[15];return Math.abs(r-m)<=Ye*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(n-_)<=Ye*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(o-O)<=Ye*Math.max(1,Math.abs(o),Math.abs(O))&&Math.abs(i-y)<=Ye*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(a-j)<=Ye*Math.max(1,Math.abs(a),Math.abs(j))&&Math.abs(s-x)<=Ye*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(l-w)<=Ye*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(c-M)<=Ye*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(u-S)<=Ye*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(f-T)<=Ye*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(h-P)<=Ye*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(d-E)<=Ye*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(b-C)<=Ye*Math.max(1,Math.abs(b),Math.abs(C))&&Math.abs(g-R)<=Ye*Math.max(1,Math.abs(g),Math.abs(R))&&Math.abs(p-D)<=Ye*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(v-U)<=Ye*Math.max(1,Math.abs(v),Math.abs(U))}function at(){var t=new We(3);return We!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function st(t){var e=new We(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function lt(t){return Math.hypot(t[0],t[1],t[2])}function ct(t,e,r){var n=new We(3);return n[0]=t,n[1]=e,n[2]=r,n}function ut(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function ft(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function ht(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function dt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function bt(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function gt(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function pt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function vt(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function mt(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function _t(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function Ot(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function yt(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function jt(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t}function xt(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])}function wt(t,e){var r=e[0]-t[0],n=e[1]-t[1],o=e[2]-t[2];return r*r+n*n+o*o}function Mt(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function St(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Tt(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Pt(t,e){var r=e[0],n=e[1],o=e[2],i=r*r+n*n+o*o;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function Et(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ct(t,e,r){var n=e[0],o=e[1],i=e[2],a=r[0],s=r[1],l=r[2];return t[0]=o*l-i*s,t[1]=i*a-n*l,t[2]=n*s-o*a,t}function Rt(t,e,r,n){var o=e[0],i=e[1],a=e[2];return t[0]=o+n*(r[0]-o),t[1]=i+n*(r[1]-i),t[2]=a+n*(r[2]-a),t}function Dt(t,e,r,n,o,i){var a=i*i,s=a*(2*i-3)+1,l=a*(i-2)+i,c=a*(i-1),u=a*(3-2*i);return t[0]=e[0]*s+r[0]*l+n[0]*c+o[0]*u,t[1]=e[1]*s+r[1]*l+n[1]*c+o[1]*u,t[2]=e[2]*s+r[2]*l+n[2]*c+o[2]*u,t}function Ut(t,e,r,n,o,i){var a=1-i,s=a*a,l=i*i,c=s*a,u=3*i*s,f=3*l*a,h=l*i;return t[0]=e[0]*c+r[0]*u+n[0]*f+o[0]*h,t[1]=e[1]*c+r[1]*u+n[1]*f+o[1]*h,t[2]=e[2]*c+r[2]*u+n[2]*f+o[2]*h,t}function kt(t,e){e=e||1;var r=2*He()*Math.PI,n=2*He()-1,o=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=n*e,t}function Lt(t,e,r){var n=e[0],o=e[1],i=e[2],a=r[3]*n+r[7]*o+r[11]*i+r[15];return t[0]=(r[0]*n+r[4]*o+r[8]*i+r[12])/(a=a||1),t[1]=(r[1]*n+r[5]*o+r[9]*i+r[13])/a,t[2]=(r[2]*n+r[6]*o+r[10]*i+r[14])/a,t}function Ft(t,e,r){var n=e[0],o=e[1],i=e[2];return t[0]=n*r[0]+o*r[3]+i*r[6],t[1]=n*r[1]+o*r[4]+i*r[7],t[2]=n*r[2]+o*r[5]+i*r[8],t}function It(t,e,r){var n=r[0],o=r[1],i=r[2],a=e[0],s=e[1],l=e[2],c=o*l-i*s,u=i*a-n*l,f=n*s-o*a,h=o*f-i*u,d=i*c-n*f,b=n*u-o*c,g=2*r[3];return u*=g,f*=g,d*=2,b*=2,t[0]=a+(c*=g)+(h*=2),t[1]=s+u+d,t[2]=l+f+b,t}function At(t,e,r,n){var o=[],i=[];return o[0]=e[0]-r[0],o[1]=e[1]-r[1],o[2]=e[2]-r[2],i[0]=o[0],i[1]=o[1]*Math.cos(n)-o[2]*Math.sin(n),i[2]=o[1]*Math.sin(n)+o[2]*Math.cos(n),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t}function Bt(t,e,r,n){var o=[],i=[];return o[0]=e[0]-r[0],o[1]=e[1]-r[1],o[2]=e[2]-r[2],i[0]=o[2]*Math.sin(n)+o[0]*Math.cos(n),i[1]=o[1],i[2]=o[2]*Math.cos(n)-o[0]*Math.sin(n),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t}function Nt(t,e,r,n){var o=[],i=[];return o[0]=e[0]-r[0],o[1]=e[1]-r[1],o[2]=e[2]-r[2],i[0]=o[0]*Math.cos(n)-o[1]*Math.sin(n),i[1]=o[0]*Math.sin(n)+o[1]*Math.cos(n),i[2]=o[2],t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t}function Vt(t,e){var r=t[0],n=t[1],o=t[2],i=e[0],a=e[1],s=e[2],l=Math.sqrt(r*r+n*n+o*o)*Math.sqrt(i*i+a*a+s*s),c=l&&Et(t,e)/l;return Math.acos(Math.min(Math.max(c,-1),1))}function Xt(t){return t[0]=0,t[1]=0,t[2]=0,t}function $t(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Yt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Wt(t,e){var r=t[0],n=t[1],o=t[2],i=e[0],a=e[1],s=e[2];return Math.abs(r-i)<=Ye*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=Ye*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(o-s)<=Ye*Math.max(1,Math.abs(o),Math.abs(s))}function Ht(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zt(t){return 0==(t&t-1)}function Gt(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qt(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zt(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kt(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qt(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Jt(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function te(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ee(t,e,r){const n=e.vertices.flatMap((t=>t)),o=new pr(t.getGl(),t.getProgramInfo().attribLocations.vertexPosition);o.bufferData(pr.createBufferSourceFromPositions(n));const i=e.indices.map((t=>{if(t<0||t>e.vertices.length-1)throw`Index out of bounds: ${t}`;return t})),a=new dr(t.getGl());let s,l;if(a.bufferData(dr.createBufferSourceFromIndices(i)),r){const r=[];for(let t=0;t<e.vertices.length;t++)r[t]=Se.create();for(let t=0;t<i.length;t+=3){const n=i[t+0],o=i[t+1],a=i[t+2],s=Se.fromValues(...e.vertices[n]),l=Se.fromValues(...e.vertices[o]),c=Se.fromValues(...e.vertices[a]),u=Se.sub(Se.create(),l,s),f=Se.sub(Se.create(),c,s),h=Se.cross(Se.create(),u,f);Se.add(r[n],r[n],h),Se.add(r[o],r[o],h),Se.add(r[a],r[a],h)}for(let t=0;t<e.vertices.length;t++)Se.normalize(r[t],r[t]);s=new gr(t.getGl(),t.getProgramInfo().attribLocations.vertexNormal),s.bufferData(gr.createBufferSourceFromPositions(r.flatMap((t=>[t[0],t[1],t[2]]))))}return e.texCoords&&(l=new vr(t.getGl(),t.getProgramInfo().attribLocations.textureCoord),l.bufferData(vr.createBufferSourceFromCoords(e.texCoords))),new mr(o,a,s,l)}function re(t,e,r,n,o,i,a){const s=new fr(null,"WRAPPER:"+e.name);s.translate(e.xOffset*Or,e.yOffset*Or,e.zOffset*Or);const l=[];for(const r of e.primitives){const n=ne(t,e.vertices,r,o,i,a);null!==n&&(a&&Ne.validateTextureName(r.textureName)&&n.setTextureKey(r.textureName),l.push(n))}const c=new fr(l,e.name);s.addChild(c),n.set(e,c);for(const r of e.children)re(t,r,c,n,o,i,a);r.addChild(s)}function ne(t,e,r,n,o,i){const a=r.vertexIndices.map((t=>{const r=e[t];return[r.x*Or,r.y*Or,r.z*Or]}));if(3===r.vertexIndices.length){return _r.createModelFromIndexedVertices(t,{vertices:a,indices:[0,1,2],texCoords:i?[0,0,0,1,1,1]:null},o)}if(4===r.vertexIndices.length){return _r.createModelFromIndexedVertices(t,{vertices:a,indices:n?[0,1,2,0,2,3]:[0,1,2,3],texCoords:i&&n?[0,0,1,0,1,1,0,1]:null},o)}return null}function oe(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ie(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ae(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function se(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ae(Object(r),!0).forEach((function(e){le(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ae(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function le(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ce(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ue(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ce(Object(r),!0).forEach((function(e){fe(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function fe(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function he(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function de(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?he(Object(r),!0).forEach((function(e){be(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):he(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function be(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ge(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function pe(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ge(Object(r),!0).forEach((function(e){ve(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ge(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ve(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function me(t){const e=new Map,r=t=>{e.set(t,{highlight:!1,hide:!1});for(const e of t.children)r(e)};for(const e of t.rootNodes)r(e);return e}function _e(t){return Object.values(t).every((t=>null===t))?"wireframe":void 0}function Oe(t){const e="string"==typeof t?t.replace(/^.*[\\\/]/,""):t.name;return e.startsWith("ara")?3:e.startsWith("tar")?1:e.startsWith("ver")?0:e.startsWith("zon")?7:e.startsWith("cre")?6:void 0}function ye(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function je(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ye(Object(r),!0).forEach((function(e){xe(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ye(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function xe(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.r(e);var we={};r.r(we),r.d(we,"EPSILON",(function(){return Ye})),r.d(we,"ARRAY_TYPE",(function(){return We})),r.d(we,"RANDOM",(function(){return He})),r.d(we,"setMatrixArrayType",(function(){return u})),r.d(we,"toRadian",(function(){return f})),r.d(we,"equals",(function(){return h}));var Me={};r.r(Me),r.d(Me,"create",(function(){return d})),r.d(Me,"clone",(function(){return b})),r.d(Me,"copy",(function(){return g})),r.d(Me,"fromValues",(function(){return p})),r.d(Me,"set",(function(){return v})),r.d(Me,"identity",(function(){return m})),r.d(Me,"transpose",(function(){return _})),r.d(Me,"invert",(function(){return O})),r.d(Me,"adjoint",(function(){return y})),r.d(Me,"determinant",(function(){return j})),r.d(Me,"multiply",(function(){return x})),r.d(Me,"translate",(function(){return w})),r.d(Me,"scale",(function(){return M})),r.d(Me,"rotate",(function(){return S})),r.d(Me,"rotateX",(function(){return T})),r.d(Me,"rotateY",(function(){return P})),r.d(Me,"rotateZ",(function(){return E})),r.d(Me,"fromTranslation",(function(){return C})),r.d(Me,"fromScaling",(function(){return R})),r.d(Me,"fromRotation",(function(){return D})),r.d(Me,"fromXRotation",(function(){return U})),r.d(Me,"fromYRotation",(function(){return k})),r.d(Me,"fromZRotation",(function(){return L})),r.d(Me,"fromRotationTranslation",(function(){return F})),r.d(Me,"fromQuat2",(function(){return I})),r.d(Me,"getTranslation",(function(){return A})),r.d(Me,"getScaling",(function(){return B})),r.d(Me,"getRotation",(function(){return N})),r.d(Me,"fromRotationTranslationScale",(function(){return V})),r.d(Me,"fromRotationTranslationScaleOrigin",(function(){return X})),r.d(Me,"fromQuat",(function(){return $})),r.d(Me,"frustum",(function(){return Y})),r.d(Me,"perspectiveNO",(function(){return W})),r.d(Me,"perspective",(function(){return qe})),r.d(Me,"perspectiveZO",(function(){return H})),r.d(Me,"perspectiveFromFieldOfView",(function(){return z})),r.d(Me,"orthoNO",(function(){return G})),r.d(Me,"ortho",(function(){return Ze})),r.d(Me,"orthoZO",(function(){return q})),r.d(Me,"lookAt",(function(){return Z})),r.d(Me,"targetTo",(function(){return K})),r.d(Me,"str",(function(){return Q})),r.d(Me,"frob",(function(){return J})),r.d(Me,"add",(function(){return tt})),r.d(Me,"subtract",(function(){return et})),r.d(Me,"multiplyScalar",(function(){return rt})),r.d(Me,"multiplyScalarAndAdd",(function(){return nt})),r.d(Me,"exactEquals",(function(){return ot})),r.d(Me,"equals",(function(){return it})),r.d(Me,"mul",(function(){return Ke})),r.d(Me,"sub",(function(){return Qe}));var Se={};r.r(Se),r.d(Se,"create",(function(){return at})),r.d(Se,"clone",(function(){return st})),r.d(Se,"length",(function(){return lt})),r.d(Se,"fromValues",(function(){return ct})),r.d(Se,"copy",(function(){return ut})),r.d(Se,"set",(function(){return ft})),r.d(Se,"add",(function(){return ht})),r.d(Se,"subtract",(function(){return dt})),r.d(Se,"multiply",(function(){return bt})),r.d(Se,"divide",(function(){return gt})),r.d(Se,"ceil",(function(){return pt})),r.d(Se,"floor",(function(){return vt})),r.d(Se,"min",(function(){return mt})),r.d(Se,"max",(function(){return _t})),r.d(Se,"round",(function(){return Ot})),r.d(Se,"scale",(function(){return yt})),r.d(Se,"scaleAndAdd",(function(){return jt})),r.d(Se,"distance",(function(){return xt})),r.d(Se,"squaredDistance",(function(){return wt})),r.d(Se,"squaredLength",(function(){return Mt})),r.d(Se,"negate",(function(){return St})),r.d(Se,"inverse",(function(){return Tt})),r.d(Se,"normalize",(function(){return Pt})),r.d(Se,"dot",(function(){return Et})),r.d(Se,"cross",(function(){return Ct})),r.d(Se,"lerp",(function(){return Rt})),r.d(Se,"hermite",(function(){return Dt})),r.d(Se,"bezier",(function(){return Ut})),r.d(Se,"random",(function(){return kt})),r.d(Se,"transformMat4",(function(){return Lt})),r.d(Se,"transformMat3",(function(){return Ft})),r.d(Se,"transformQuat",(function(){return It})),r.d(Se,"rotateX",(function(){return At})),r.d(Se,"rotateY",(function(){return Bt})),r.d(Se,"rotateZ",(function(){return Nt})),r.d(Se,"angle",(function(){return Vt})),r.d(Se,"zero",(function(){return Xt})),r.d(Se,"str",(function(){return $t})),r.d(Se,"exactEquals",(function(){return Yt})),r.d(Se,"equals",(function(){return Wt})),r.d(Se,"sub",(function(){return Je})),r.d(Se,"mul",(function(){return tr})),r.d(Se,"div",(function(){return er})),r.d(Se,"dist",(function(){return rr})),r.d(Se,"sqrDist",(function(){return nr})),r.d(Se,"len",(function(){return or})),r.d(Se,"sqrLen",(function(){return ir})),r.d(Se,"forEach",(function(){return ar}));var Te=r("hosL"),Pe=r("QRet");const Ee={sidebarPosition:"right",sidebarWidth:300,defaultTextureFilterMin:"nearest",defaultTextureFilterMag:"nearest",preserveDrawingBuffer:!0},Ce={save:t=>{const e=JSON.stringify(t);localStorage.setItem("user",e)},load:()=>{const t=localStorage.getItem("user");if(null===t)return;const e=JSON.parse(t);if("object"!=typeof e)throw new Error("User settings is not an object");const r=e.sidebarPosition;if("left"!==r&&"right"!==r)throw new Error("Invalid sidebarPosition");const n=e.sidebarWidth;if("number"!=typeof n)throw new Error("Invalid sidebarWidth");const o=e.defaultTextureFilterMin;if("nearest"!==o&&"linear"!==o)throw new Error("Invalid defaultTextureFilterMin");const i=e.defaultTextureFilterMag;if("nearest"!==i&&"linear"!==i)throw new Error("Invalid defaultTextureFilterMag");let a=e.preserveDrawingBuffer;return"boolean"!=typeof a&&(a=Ee.preserveDrawingBuffer),{sidebarPosition:r,sidebarWidth:n,defaultTextureFilterMin:o,defaultTextureFilterMag:i,preserveDrawingBuffer:a}}},Re={rotationX:50,rotationY:-150,rotationZ:0,translationX:0,translationY:0,zoom:900,viewMode:"regular",viewColor:[1,1,1,1],canvasBackground:"black",canvasBackgroundSize:"auto",canvasBackgroundRepeat:"repeat",enableLightingRegular:!1,logoColorIdx:0,textureFilterMin:"linear",textureFilterMag:"linear",enableLightingSolidColor:!0,solidColor:[1,1,1,1],wireframeColor:[1,1,1,1]};var De=({title:t,children:e,showByDefault:r})=>{const[n,o]=Object(Pe.e)(null!=r&&r),i=n?Object(Te.h)("div",null,e):null,a=Object(Te.h)("button",{onClick:()=>o(!n)},n?"[Hide]":"[Show]");return Object(Te.h)("div",null,Object(Te.h)("div",{class:"flex justify-between space-x-2"},Object(Te.h)("span",null,t),a),i)};const Ue=["aradrag.3do","tardrag.3do","verdrag.3do","zondrag.3do","creaeri.3do","aralode.3do","araking.3do","cresage.3do","tarnecro.3do","vermage.3do","zonhunt.3do"].map((t=>({name:t,path:"assets/3do-samples/"+t}))),ke="https://github.com/takingdoms/3do-viewer-preact/issues",Le="border border-gray-700 px-2 py-0.5 hover:text-yellow-500 focus:text-yellow-500";var Fe=({onSubmit:t,defaultUserSettings:e,setDefaultUserSettings:r})=>{const n=Object(Pe.c)((()=>Object(Te.h)("div",{class:"text-sm"},Object(Te.h)("h3",{class:"text-base font-bold"},"Controls:"),Object(Te.h)("p",null,Object(Te.h)("u",null,"Left mouse button:")," hold and drag to rotate the model."),Object(Te.h)("p",null,Object(Te.h)("u",null,"Middle mouse button:")," hold and drag to move the model."),Object(Te.h)("p",null,Object(Te.h)("u",null,"Mouse wheel:")," zoom in or out."))),[]),i=Object(Pe.c)((()=>Object(Te.h)("div",{class:"text-sm"},Object(Te.h)("h3",{class:"text-base font-bold"},"About:"),Object(Te.h)("p",null,"Submit suggestions or problems at: ",Object(Te.h)("a",{class:"text-sky-500 hover:text-sky-700 focus:text-sky-700 hover:underline focus:underline",href:ke,target:"_blank"},ke)),Object(Te.h)("p",null,"...or message spagg#2962 on Discord."))),[]),a=Object(Pe.c)((()=>Object(Te.h)("form",{class:"px-4 py-2 border border-4 border-gray-600 rounded h-full",onSubmit:e=>{e.preventDefault();const r=new FormData(e.currentTarget).get("file");r&&r.size&&r.name&&t(r)}},Object(Te.h)("div",{class:"text-3xl text-center mb-4"},"Option 1"),Object(Te.h)("div",{class:"text-xl text-gray-400 mb-2"},"Load your own file"),Object(Te.h)("div",{className:"flex items-stretch space-x-2"},Object(Te.h)("input",{name:"file",type:"file",class:"grow border border-gray-700"}),Object(Te.h)("button",{class:Le,type:"submit"},"GO")))),[t]),s=Object(Pe.c)((()=>Object(Te.h)("form",{class:"px-4 py-2 border border-4 border-gray-600 rounded h-full",onSubmit:e=>{var r;e.preventDefault();const n=null===(r=new FormData(e.currentTarget).get("sample"))||void 0===r?void 0:r.toString().trim();n&&t(n)}},Object(Te.h)("div",{class:"text-3xl text-center mb-4"},"Option 2"),Object(Te.h)("div",{class:"text-xl text-gray-400 mb-2"},"Pick a sample file"),Object(Te.h)("div",{className:"flex items-stretch space-x-2"},Object(Te.h)("select",{name:"sample",class:"grow border border-gray-700"},Object(Te.h)("option",{value:""}),Ue.map(((t,e)=>Object(Te.h)("option",{value:t.path,key:e},t.name)))),Object(Te.h)("button",{class:Le,type:"submit"},"GO")))),[t]),l=Object(Pe.c)((()=>Object(Te.h)(De,{title:"Advanced"},Object(Te.h)("div",{class:"space-y-2"},Object(Te.h)("div",null,Object(Te.h)("label",{class:"flex items-center"},Object(Te.h)("input",{type:"checkbox",checked:e.preserveDrawingBuffer,onChange:t=>{r(o(o({},e),{},{preserveDrawingBuffer:t.currentTarget.checked}))}}),Object(Te.h)("span",{class:"font-bold ml-2"},"WebGL / Preserve Drawing Buffer")),Object(Te.h)("span",{class:"text-gray-300 text-sm"},'Disable this only if the model rendering is lagging (might not even change anything).\n            Disabling this will also disable the "Save Model Image" button and the ability to\n            "Right click > Save Image As"'))))),[e,r]);return Object(Te.h)("div",{class:"min-w-screen min-h-screen bg-gray-800 flex flex-col justify-center items-center"},Object(Te.h)("div",{style:{maxWidth:800},class:"container flex justify-center items-stretch\r flex-col-reverse md:flex-col"},Object(Te.h)("div",{class:"flex flex-wrap items-stretch"},Object(Te.h)("div",{class:"flex-1 p-4",style:{minWidth:300}},n),Object(Te.h)("div",{class:"flex-1 p-4",style:{minWidth:300}},i)),Object(Te.h)("div",{class:"flex flex-wrap items-stretch"},Object(Te.h)("div",{class:"flex-1 p-4"},a),Object(Te.h)("div",{class:"flex-1 p-4"},s)),Object(Te.h)("div",{class:"mt-8 self-center"},l)))},Ie=r("/u4b");const Ae={defaultIdx:0,idxList:Array.from({length:10}).map(((t,e)=>e)),idxCount:10,idxToName:t=>t.toString(),idxToHtmlColor:t=>Be[t],textureKeyUsesLogo:t=>t.toLowerCase().includes("logo"),idxToTextureKey:(t,e)=>0===t?e:`${e}/color:${t}`,idxToTextureFilename:(t,e)=>0===t?e:`${e}.${t}`},Be={0:"lightblue",1:"red",2:"white",3:"green",4:"darkblue",5:"purple",6:"yellow",7:"black",8:"orange",9:"brown"},Ne={compareObjectsShallow:function(t,e){const r=Object.entries(t),n=Object.keys(e);return r.length===n.length&&r.every((([t,r])=>t in e&&e[t]===r))},createUpdatedMap:function(t,e,r){const n=new Map(t);return n.set(e,r),n},validateTextureName:function(t){return/^(?!^(?:COM|PRN|AUX|NUL|CON|CLOCK\$)(?:\..+)?$)[^\s\\/:\*\?\"<>\|\x00-\x1F\x7F]{1,254}$/.test(t)}};class Ve{constructor(t){l(this,"config",void 0),l(this,"resizeObserver",void 0),l(this,"cleanupEvents",void 0),this.config=t}setupEvents(){const{listener:t,canvas:e,mode:r}=this.config;let n,o,i,a,l,c=!1;const u=t=>{if(void 0===n){if(0===t.button)n="rotate";else{if(1!==t.button)return;n="pan"}o=t.clientX,i=t.clientY,a="rotate"===n?this.config.modelControls.rotationX:this.config.modelControls.translationX,l="rotate"===n?this.config.modelControls.rotationY:this.config.modelControls.translationY}},f=t=>{if(void 0===o||void 0===i||void 0===a||void 0===l)return;const e=Math.round(.75*(t.clientX-o)),s=Math.round(.75*(t.clientY-i));if(0!==e||0!==s){if(0!==e)if("rotate"===n){let t=l+e;for(;t>180;)t-=360;for(;t<-180;)t+=360;this.config.modelControls.rotationY=t}else this.config.modelControls.translationX=a+e;if(0!==s)if("rotate"===n){let t=a+s;for(;t>180;)t-=360;for(;t<-180;)t+=360;this.config.modelControls.rotationX=t}else this.config.modelControls.translationY=l+s;c=!0,"static"===r&&this.render()}},h=()=>{n=o=i=a=l=void 0,c&&(t.onModelControlsChanged(s({},this.config.modelControls)),c=!1)},d=()=>{"hidden"===document.visibilityState&&h()},b=e=>{0!==e.deltaY&&(this.config.modelControls.zoom+=e.deltaY,"static"===this.config.mode&&this.render(),t.onModelControlsChanged(s({},this.config.modelControls)))};e.addEventListener("mousedown",u),e.addEventListener("mousemove",f),window.addEventListener("mouseup",h),document.addEventListener("visibilitychange",d),e.addEventListener("wheel",b),this.cleanupEvents=()=>{e.removeEventListener("mousedown",u),e.removeEventListener("mousedown",f),window.removeEventListener("mouseup",h),document.removeEventListener("visibilitychange",d),e.removeEventListener("wheel",b)};const g=()=>{const t=e.parentElement;if(!t)throw new Error("Canvas has no parent!!");const r=t.clientWidth,n=t.clientHeight;let o=!1;return e.width!==r&&(e.width=r,o=!0),e.height!==n&&(e.height=n,o=!0),!!o&&(this.onResized(),!0)};this.resizeObserver=new ResizeObserver(g);const p=e.parentElement;if(!p)throw window.alert("Failed to create canvas"),new Error("Canvas has no parent!! (Can't listen to resizing...)");this.resizeObserver.observe(p),g()||this.onResized()}setModelControls(t){this.config.modelControls=t,"static"===this.config.mode&&this.render()}setTextureMapping(t){this.config.textureMapping=t,"static"===this.config.mode&&this.render()}setObjectStateMap(t){this.config.objStateMap=t,"static"===this.config.mode&&this.render()}destroy(){var t;this.resizeObserver&&this.resizeObserver.disconnect(),null===(t=this.cleanupEvents)||void 0===t||t.call(this)}get width(){return this.config.canvas.width}get height(){return this.config.canvas.height}}class Xe extends Ve{constructor(t){super(t),c(this,"ctx",void 0),c(this,"renderCount",0);const e=t.canvas.getContext("2d");if(null===e)throw window.alert("Canvas not supported in this browser."),new Error("Failed to create context");this.ctx=e,this.setupEvents()}onResized(){this.render()}render(){const{modelControls:t}=this.config;console.log(`Rendering next  (#${this.renderCount})`);const e=performance.now(),r=this.width,n=this.height;this.ctx.fillStyle="rgb(4, 16, 22)",this.ctx.fillRect(0,0,r,n),this.ctx.strokeStyle="rgb(0, 0, 200)",this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(0,n/2),this.ctx.lineTo(r,n/2),this.ctx.stroke(),this.ctx.moveTo(r/2,0),this.ctx.lineTo(r/2,n),this.ctx.stroke();const o=[`renderCount: ${this.renderCount}`,`viewWidth: ${r}`,`viewHeight: ${n}`,`zoom: ${t.zoom}`,`rotationX: ${t.rotationX}`,`rotationY: ${t.rotationY}`,`rotationZ: ${t.rotationZ}`,`translationX: ${t.translationX}`,`translationY: ${t.translationY}`,`viewMode: ${t.viewMode}`];this.ctx.textAlign="left",this.ctx.textBaseline="middle",this.ctx.fillStyle="white",this.ctx.font="18px monospace",this.ctx.strokeStyle="red";const i=this.ctx.measureText(o.reduce(((t,e)=>t.length>e.length?t:e))).width,a=18*o.length+4*o.length*2;for(let t=0;t<o.length;t++){const e=26;false,this.ctx.fillText(o[t],r/2-i/2,n/2-a/2+(t*e+e/2))}const s=performance.now();console.log(`Finished rendering  in ${s-e}ms`),this.renderCount++}}const $e={compileShader:function(t,e,r){const n=t.createShader(r);if(null===n)throw`Failed to create shader of type "${r}"`;if(t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw`Could not compile shader: ${t.getShaderInfoLog(n)}`;return n},createProgram:function(t,e,r){const n=t.createProgram();if(null===n)throw"Failed to create program";if(t.attachShader(n,e),t.attachShader(n,r),t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS))throw`Program failed to link: ${t.getProgramInfoLog(n)}`;return n},resizeCanvasToDisplaySize:function(t){const e=t.clientWidth,r=t.clientHeight,n=t.width!==e||t.height!==r;return n&&(t.width=e,t.height=r),n}};var Ye=1e-6,We="undefined"!=typeof Float32Array?Float32Array:Array,He=Math.random,ze=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Ge,qe=W,Ze=G,Ke=x,Qe=et,Je=dt,tr=bt,er=gt,rr=xt,nr=wt,or=lt,ir=Mt,ar=(Ge=at(),function(t,e,r,n,o,i){var a,s;for(e||(e=3),r||(r=0),s=n?Math.min(n*e+r,t.length):t.length,a=r;a<s;a+=e)Ge[0]=t[a],Ge[1]=t[a+1],Ge[2]=t[a+2],o(Ge,Ge,i),t[a]=Ge[0],t[a+1]=Ge[1],t[a+2]=Ge[2];return t});class sr{constructor(t){Ht(this,"gl",void 0),Ht(this,"handle",void 0),Ht(this,"deleted",!1),Ht(this,"ok",!1),this.gl=t;const e=t.createTexture();if(null===e)throw new Error("Failed to create texture.");this.handle=e}use(t,e,r){if(this.deleted)throw"Trying to use a texture that has already been deleted.";return!!this.ok&&(this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.handle),this.gl.uniform1i(t,0),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,e),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,r),!0)}loadDataFromPixels(t,e,r){if(this.deleted)throw"Trying to use a texture that has already been deleted.";const n=this.gl.RGBA,o=this.gl.RGBA,i=this.gl.UNSIGNED_BYTE;this.gl.bindTexture(this.gl.TEXTURE_2D,this.handle),this.gl.texImage2D(this.gl.TEXTURE_2D,0,n,t,e,0,o,i,r),this.ok=!0}loadDataFromImage(t){if(this.deleted)throw"Trying to use a texture that has already been deleted.";if(!t.complete||0===t.naturalWidth){console.error("Trying to load data from an image that hasn't yet loaded!");const e=new Uint8Array([255,255,255,255]);return this.loadDataFromPixels(1,1,e),void(t.onload=()=>{t.complete&&0!==t.naturalWidth&&this.loadDataFromImage(t)})}const e=this.gl.RGBA,r=this.gl.RGBA,n=this.gl.UNSIGNED_BYTE;this.gl.bindTexture(this.gl.TEXTURE_2D,this.handle),this.gl.texImage2D(this.gl.TEXTURE_2D,0,e,r,n,t),zt(t.width)&&zt(t.height)&&this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.ok=!0}delete(){this.gl.deleteTexture(this.handle),this.deleted=!0}}class lr{constructor(t,e,r){Gt(this,"gl",void 0),Gt(this,"programInfo",void 0),Gt(this,"logoDefs",void 0),Gt(this,"currentLogoIdx",void 0),Gt(this,"textureDatabase",{}),Gt(this,"lastTexture",void 0),Gt(this,"baseEntityColor",new Float32Array([1,1,1,1])),Gt(this,"textureMinFilter",void 0),Gt(this,"textureMagFilter",void 0),this.gl=t,this.programInfo=e,this.logoDefs=r,this.currentLogoIdx=r.defaultIdx,this.textureMinFilter=t.NEAREST,this.textureMagFilter=t.NEAREST}getGl(){return this.gl}getProgramInfo(){return this.programInfo}getBaseEntityColor(){return this.baseEntityColor}setBaseEntityColor(t){this.baseEntityColor=t}setUniformMatrix4(t,e){const r=this.programInfo.uniformLocations[t];r&&this.gl.uniformMatrix4fv(r,!1,e)}setUniformFloat4(t,e){if(4!==e.length)throw new Error(`data.length is not 4: ${e.length}`);const r=this.programInfo.uniformLocations[t];r&&this.gl.uniform4fv(r,e)}setUniformBool(t,e){const r=this.programInfo.uniformLocations[t];r&&this.gl.uniform1i(r,e?1:0)}setTextureMinFilter(t){this.textureMinFilter=t}setTextureMagFilter(t){this.textureMagFilter=t}drawElements(t){this.gl.drawElements(this.gl.TRIANGLES,t,this.gl.UNSIGNED_SHORT,0)}useTexture(t){let e;if(null===t)e=null;else{const r=this.logoDefs.textureKeyUsesLogo(t)?this.logoDefs.idxToTextureKey(this.currentLogoIdx,t):t,n=this.textureDatabase[r];void 0===n?(console.error(`Missing texture for: ${r}`),e=null):e=n}return this.lastTexture===e?null!==e:(this.lastTexture=e,null!==e&&(e.use(this.programInfo.uniformLocations.sampler,this.textureMinFilter,this.textureMagFilter),!0))}changeTextureMapping(t){for(const[e,r]of Object.entries(t)){const t=this.textureDatabase[e];t!==r&&(null!=t&&t.delete(),this.textureDatabase[e]=null===r?null:this.setupTexture(r))}}setCurrentLogoIdx(t){this.currentLogoIdx=t}setupTexture(t){const e=new sr(this.gl);if("html"===t.type)e.loadDataFromImage(t.image);else{const{width:r,height:n,data:o}=t;e.loadDataFromPixels(r,n,o)}return e}}class cr extends lr{constructor(t,e,r,n){super(t,e,r),qt(this,"viewMode",void 0),this.viewMode=n}drawElements(t){this.gl.drawElements("wireframe"===this.viewMode?this.gl.LINE_LOOP:this.gl.TRIANGLES,t,this.gl.UNSIGNED_SHORT,0)}useTexture(t){return"regular"!==this.viewMode||super.useTexture(t)}}const ur=new Float32Array([1,1,0,1]);class fr{constructor(t,e){Zt(this,"model",void 0),Zt(this,"name",void 0),Zt(this,"children",void 0),Zt(this,"parent",void 0),Zt(this,"modelViewMatrix",void 0),Zt(this,"relativeModelViewMatrix",void 0),Zt(this,"stateOptions",void 0),this.model=t,this.name=null!=e?e:null,this.children=[],this.parent=null,this.modelViewMatrix=Me.create(),this.relativeModelViewMatrix=Me.create(),this.stateOptions={visibile:!0,highlighted:!1}}addChild(t){if(null!==t.parent)throw new Error("Can't add a child that already has a parent.");this.children.push(t),t.parent=this}render(t){this.recalculateMatrices(Me.create()),this.renderChild(t)}recalculateMatrices(t){this.relativeModelViewMatrix=Me.mul(Me.create(),t,this.modelViewMatrix);for(const t of this.children)t.recalculateMatrices(this.relativeModelViewMatrix)}renderChild(t){var e;const r=null!==(e=this.color)&&void 0!==e?e:t.getBaseEntityColor();if(null!==this.model&&this.stateOptions.visibile)if(t.setUniformFloat4("entityColor",r),t.setUniformMatrix4("modelViewMatrix",this.relativeModelViewMatrix),Array.isArray(this.model))for(const e of this.model)this.renderModel(t,e);else this.renderModel(t,this.model);for(const e of this.children)e.renderChild(t)}findChild(t,e){for(const r of this.children){if(r.name===t)return r;if(e){const n=r.findChild(t,e);if(void 0!==n)return n}}}renderModel(t,e){if(e.usesNormals()){const e=Me.create();Me.invert(e,this.relativeModelViewMatrix),Me.transpose(e,e),t.setUniformMatrix4("normalMatrix",e)}e.draw(t)}translate(t,e,r){Me.translate(this.modelViewMatrix,this.modelViewMatrix,[t,e,r])}scale(t,e,r){Me.scale(this.modelViewMatrix,this.modelViewMatrix,[t,e,r])}rotate(t,e,r,n){Me.rotate(this.modelViewMatrix,this.modelViewMatrix,t,[e?1:0,r?1:0,n?1:0])}rotateX(t){Me.rotateX(this.modelViewMatrix,this.modelViewMatrix,t)}rotateY(t){Me.rotateY(this.modelViewMatrix,this.modelViewMatrix,t)}rotateZ(t){Me.rotateZ(this.modelViewMatrix,this.modelViewMatrix,t)}resetTransformations(){this.modelViewMatrix=Me.create()}get color(){if(this.stateOptions.highlighted)return ur}getStateOptions(){return this.stateOptions}setStateOptions(t){this.stateOptions=t}}class hr{constructor(t){Kt(this,"gl",void 0),Kt(this,"_handle",void 0),Kt(this,"deleted",!1),this.gl=t;const e=t.createBuffer();if(null===e)throw"Failed to create buffer!";this._handle=e}get handle(){return this._handle}bufferData(t){if(this.deleted)throw"Trying to use a buffer that has already been deleted.";this.doBufferData(t)}use(){if(this.deleted)throw"Trying to use a buffer that has already been deleted.";this.doUse()}delete(){if(this.deleted)throw"Trying to delete a buffer that has already been deleted.";this.gl.deleteBuffer(this._handle),this.deleted=!0}}class dr extends hr{constructor(...t){super(...t),Qt(this,"length",0)}getLength(){return this.length}doBufferData(t){this.length=t.byteLength/2,this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.handle),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,t,this.gl.STATIC_DRAW)}doUse(){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.handle)}static createBufferSourceFromIndices(t){return new Uint16Array(t)}}class br extends hr{constructor(t,e){super(t),Jt(this,"attribLocation",void 0),this.attribLocation=e}}class gr extends br{doBufferData(t){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.handle),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW)}doUse(){const t=this.gl.FLOAT;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.handle),this.gl.vertexAttribPointer(this.attribLocation,3,t,!1,0,0),this.gl.enableVertexAttribArray(this.attribLocation)}static createBufferSourceFromPositions(t){return new Float32Array(t)}}class pr extends br{doBufferData(t){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.handle),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW)}doUse(){const t=this.gl.FLOAT;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.handle),this.gl.vertexAttribPointer(this.attribLocation,3,t,!1,0,0),this.gl.enableVertexAttribArray(this.attribLocation)}static createBufferSourceFromPositions(t){return new Float32Array(t)}}class vr extends br{doBufferData(t){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.handle),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW)}doUse(){const t=this.gl.FLOAT;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.handle),this.gl.vertexAttribPointer(this.attribLocation,2,t,!1,0,0),this.gl.enableVertexAttribArray(this.attribLocation)}static createBufferSourceFromCoords(t){return new Float32Array(t)}}class mr{constructor(t,e,r,n){te(this,"positionBuffer",void 0),te(this,"indexBuffer",void 0),te(this,"normalBuffer",void 0),te(this,"textureCoordsBuffer",void 0),te(this,"textureKey",null),this.positionBuffer=t,this.indexBuffer=e,this.normalBuffer=r,this.textureCoordsBuffer=n}setTextureKey(t){this.textureKey=t}getTextureKey(){return this.textureKey}usesNormals(){return void 0!==this.normalBuffer}draw(t){t.useTexture(this.textureKey)&&(this.positionBuffer.use(),this.indexBuffer.use(),void 0!==this.normalBuffer&&this.normalBuffer.use(),void 0!==this.textureCoordsBuffer&&this.textureCoordsBuffer.use(),t.drawElements(this.indexBuffer.getLength()))}}const _r={createModelFromIndexedVertices:ee,createModelFromSmartVertices:function(t,e,r){const n=[],o=[];t:for(let t=0;t<e.length;t++){const r=e[t];for(let t=0;t<n.length;t++){if((i=r)[0]===(a=n[t])[0]&&i[1]===a[1]&&i[2]===a[2]){o.push(t);continue t}}n.push(r),o.push(n.length-1)}var i,a;return ee(t,{vertices:n,indices:o,texCoords:null},r)},makeCube:function(t,e){const r=new pr(t,e.attribLocations.vertexPosition);r.bufferData(pr.createBufferSourceFromPositions([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]));const n=new dr(t);n.bufferData(dr.createBufferSourceFromIndices([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]));const o=new gr(t,e.attribLocations.vertexNormal);o.bufferData(gr.createBufferSourceFromPositions([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]));const i=new vr(t,e.attribLocations.textureCoord);i.bufferData(vr.createBufferSourceFromCoords([0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1]));const a=new mr(r,n,o,i);return new fr(a,"cube")}},Or=1e-6,yr=[1,1,1,1];class jr{constructor(t,e,r,n){this.gl=t,this.shaderSources=e,this.object3doTree=r,this.logoDefs=n,oe(this,"programInfo",void 0),oe(this,"ctx",void 0),oe(this,"rootEntity",void 0),oe(this,"objEntityMap",new Map),this.programInfo=this.initProgram(),this.ctx=this.initContext(),this.rootEntity=this.initRootEntity()}initContext(){return new cr(this.gl,this.programInfo,this.logoDefs,this.getViewMode())}initRootEntity(){const t=this.getViewMode(),e=new fr(null);for(const r of this.object3doTree.rootNodes)re(this.ctx,r,e,this.objEntityMap,"wireframe"!==t,"wireframe"!==t,"regular"===t);return e}changeTextureMapping(t){}changeModelControls(t){}changeObjectStateMap(t){for(const[e,r]of t){const t=this.objEntityMap.get(e);if(void 0===t)throw new Error(`Couldn't find an entity for the object: ${e}`);t.setStateOptions({visibile:!r.hide,highlighted:r.highlight})}}inBeforeTheRootRender(t,e){}render(t,e,r){var n;const o=t.drawingBufferWidth,i=t.drawingBufferHeight;t.clearColor(0,0,0,0),t.clearDepth(1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);const a=45*Math.PI/180,s=o/i,l=Me.create();t.useProgram(this.programInfo.program),this.ctx.setUniformFloat4("baseColor",null!==(n=e.viewColor)&&void 0!==n?n:yr),Me.perspective(l,a,s,.1,100),this.ctx.setUniformMatrix4("projectionMatrix",l);const c=.02*e.translationX,u=.02*e.translationY*-1,f=-1*(8+.01*e.zoom);this.rootEntity.resetTransformations(),this.rootEntity.translate(c,u,f),this.rootEntity.rotateX(we.toRadian(e.rotationX)),this.rootEntity.rotateY(we.toRadian(e.rotationY)),this.rootEntity.rotateZ(we.toRadian(e.rotationZ)),this.inBeforeTheRootRender(t,e),this.rootEntity.render(this.ctx)}update(t){}}class xr extends jr{changeTextureMapping(t){this.ctx.changeTextureMapping(t)}changeModelControls(t){this.ctx.setCurrentLogoIdx(t.logoColorIdx),super.changeModelControls(t)}getViewMode(){return"regular"}initProgram(){const{vsSource:t,fsSource:e}=this.shaderSources.regular,r=$e.compileShader(this.gl,t,this.gl.VERTEX_SHADER),n=$e.compileShader(this.gl,e,this.gl.FRAGMENT_SHADER),o=$e.createProgram(this.gl,r,n);return{program:o,attribLocations:{vertexPosition:this.gl.getAttribLocation(o,"aVertexPosition"),vertexNormal:this.gl.getAttribLocation(o,"aVertexNormal"),textureCoord:this.gl.getAttribLocation(o,"aTextureCoord")},uniformLocations:{modelViewMatrix:this.gl.getUniformLocation(o,"uModelViewMatrix"),projectionMatrix:this.gl.getUniformLocation(o,"uProjectionMatrix"),baseColor:this.gl.getUniformLocation(o,"baseColor"),entityColor:this.gl.getUniformLocation(o,"entityColor"),normalMatrix:this.gl.getUniformLocation(o,"uNormalMatrix"),sampler:this.gl.getUniformLocation(o,"uSampler"),useLights:this.gl.getUniformLocation(o,"useLights")}}}inBeforeTheRootRender(t,e){this.ctx.setUniformBool("useLights",e.enableLightingRegular);const r="linear"===e.textureFilterMag?t.LINEAR:t.NEAREST;this.ctx.setTextureMinFilter("linear"===e.textureFilterMin?t.LINEAR:t.NEAREST),this.ctx.setTextureMagFilter(r)}}class wr extends jr{getViewMode(){return"solid_color"}changeModelControls(t){this.ctx.setBaseEntityColor(t.solidColor)}initProgram(){const{vsSource:t,fsSource:e}=this.shaderSources.solid,r=$e.compileShader(this.gl,t,this.gl.VERTEX_SHADER),n=$e.compileShader(this.gl,e,this.gl.FRAGMENT_SHADER),o=$e.createProgram(this.gl,r,n);return{program:o,attribLocations:{vertexPosition:this.gl.getAttribLocation(o,"aVertexPosition"),vertexNormal:this.gl.getAttribLocation(o,"aVertexNormal")},uniformLocations:{modelViewMatrix:this.gl.getUniformLocation(o,"uModelViewMatrix"),projectionMatrix:this.gl.getUniformLocation(o,"uProjectionMatrix"),baseColor:this.gl.getUniformLocation(o,"baseColor"),entityColor:this.gl.getUniformLocation(o,"entityColor"),normalMatrix:this.gl.getUniformLocation(o,"uNormalMatrix"),useLights:this.gl.getUniformLocation(o,"useLights")}}}inBeforeTheRootRender(t,e){this.ctx.setUniformBool("useLights",e.enableLightingSolidColor)}}class Mr extends jr{getViewMode(){return"wireframe"}changeModelControls(t){this.ctx.setBaseEntityColor(t.wireframeColor)}initProgram(){const{vsSource:t,fsSource:e}=this.shaderSources.wireframe,r=$e.compileShader(this.gl,t,this.gl.VERTEX_SHADER),n=$e.compileShader(this.gl,e,this.gl.FRAGMENT_SHADER),o=$e.createProgram(this.gl,r,n);return{program:o,attribLocations:{vertexPosition:this.gl.getAttribLocation(o,"aVertexPosition")},uniformLocations:{modelViewMatrix:this.gl.getUniformLocation(o,"uModelViewMatrix"),projectionMatrix:this.gl.getUniformLocation(o,"uProjectionMatrix"),baseColor:this.gl.getUniformLocation(o,"baseColor"),entityColor:this.gl.getUniformLocation(o,"entityColor")}}}}class Sr extends Ve{constructor(t,e,r,n){super(t),ie(this,"gl",void 0),ie(this,"subRenderers",void 0);const o=t.canvas.getContext("webgl",{preserveDrawingBuffer:t.preserveDrawingBuffer});if(null===o)throw"Couldn't get WebGL rendering context!";this.gl=o,o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),this.subRenderers={regular:new xr(o,e,r,n),solid_color:new wr(o,e,r,n),wireframe:new Mr(o,e,r,n)};for(const e of Object.values(this.subRenderers))e.changeTextureMapping(t.textureMapping);if(this.setupEvents(),"continuous"===t.mode){let t=0;const e=r=>{const n=(r*=.001)-t;t=r,this.update(n),this.render(n),requestAnimationFrame(e)};requestAnimationFrame(e)}}onResized(){console.log(`Resized! (${this.width} x ${this.height})`),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),"static"===this.config.mode&&this.render()}render(t){this.subRenderers[this.config.modelControls.viewMode].render(this.gl,this.config.modelControls,t)}setTextureMapping(t){for(const e of Object.values(this.subRenderers))e.changeTextureMapping(t);super.setTextureMapping(t)}setModelControls(t){for(const e of Object.values(this.subRenderers))e.changeModelControls(t);super.setModelControls(t)}setObjectStateMap(t){for(const e of Object.values(this.subRenderers))e.changeObjectStateMap(t);super.setObjectStateMap(t)}update(t){this.subRenderers[this.config.modelControls.viewMode].update(t)}}var Tr=({canvasRef:t})=>{console.log("Re-rendering CanvasWrapper");const e=Object(Te.h)("div",{class:"absolute inset-0"},Object(Te.h)("canvas",{ref:t}));return Object(Te.h)("div",{class:"w-full h-full max-w-full max-h-full relative"},e)},Pr="NameWrapper__lk4ti",Er="LeftBorder__WZG0Y",Cr="MiddleBorder__FcOEe",Rr="Root__0piuG";var Dr=({state:t,setState:e})=>Object(Te.h)("div",{class:"flex pr-1"},Object(Te.h)("div",{class:"flex items-center px-1 cursor-pointer"+(t.highlight?" text-yellow-500":""),onClick:()=>e(se(se({},t),{},{highlight:!t.highlight}))},"H"),Object(Te.h)("div",{class:"flex items-center px-1 cursor-pointer"+(t.hide?"":" text-yellow-500"),onClick:()=>e(se(se({},t),{},{hide:!t.hide}))},"V"));const Ur="1.50rem",kr="34px",Lr="0.50rem",Fr=({current:t,nodes:e,onChangeNodeStack:r,nodeStack:n,objStateMap:o,setObjStateMap:i})=>{var a;const[s,l]=Object(Pe.e)(!0),c=e.length>0,u=t&&o.get(t);return Object(Te.h)("div",{class:Rr+" w-full overflow-hidden text-sm"},null!==t&&Object(Te.h)("div",{style:{height:kr},class:Pr+" flex py-1 bg-cyan-900 box-border"},Object(Te.h)("div",{onClick:c?()=>l(!s):void 0,class:"flex items-center px-1 pl-2 "+(c?"cursor-pointer hover:text-yellow-400":"invisible")},s?"":""),Object(Te.h)("div",{class:"min-w-0 flex items-center grow hover:text-yellow-400 cursor-pointer",onClick:()=>r(n)},Object(Te.h)("div",{class:"truncate px-1",title:t.name},null!==(a=t.name)&&void 0!==a?a:Object(Te.h)("span",{class:"text-gray-300"},"<empty name>"))),u&&Object(Te.h)(Dr,{state:u,setState:e=>{const r=Ne.createUpdatedMap(o,t,e);i(r)}})),e.length>0&&Object(Te.h)("div",{class:s?"block":"hidden"},e.map(((t,a)=>Object(Te.h)("div",{key:a,class:"flex"},Object(Te.h)("div",{class:Er,style:{marginLeft:`calc(${Ur} / 2)`,height:a===e.length-1?`calc(${kr} / 2 + ${Lr})`:"auto"}}),Object(Te.h)("div",{class:Cr+" self-start",style:{width:`calc(${Ur} / 2)`,height:`calc(${kr} / 2 + ${Lr})`}}),Object(Te.h)("div",{class:"grow max-w-full overflow-hidden",style:{paddingTop:Lr}},Object(Te.h)(Fr,{current:t,nodes:t.children,onChangeNodeStack:r,nodeStack:[...n,t],objStateMap:o,setObjStateMap:i})))))))};var Ir=Fr;const Ar="px-1.5 py-1 align-top text-left",Br=`${Ar} whitespace-nowrap`,Nr=`${Ar} break-all`;var Vr=({primitives:t})=>Object(Te.h)("table",{class:"w-full overflow-hidden"},Object(Te.h)("thead",null,Object(Te.h)("tr",null,Object(Te.h)("th",{class:Br},"#"),Object(Te.h)("th",{class:Br,title:"Vertex Indices"},"V.Indices"),Object(Te.h)("th",{class:Br},"Texture"))),Object(Te.h)("tbody",null,t.map(((t,e)=>Object(Te.h)("tr",{key:e},Object(Te.h)("td",{class:Nr},e),Object(Te.h)("td",{class:Nr},"[",t.vertexIndices.join(", "),"]"),Object(Te.h)("td",{class:`${Nr}`},t.textureName))))));var Xr=({object3doTree:t,objStateMap:e,setObjStateMap:r})=>{const[n,o]=Object(Pe.e)([]),i=0===n.length?null:n[n.length-1],a=null===i?t.rootNodes:i.children,s=i&&e.get(i),l=Object(Pe.c)((()=>{const t=Object(Te.h)("div",{class:"mx-1 text-pink-600"},""),e="font-bold",r="cursor-pointer text-gray-400 hover:text-white";return Object(Te.h)("div",{class:"flex flex-wrap bg-gray-900 px-1 py-0.5"},Object(Te.h)("div",{class:null===i?e:r,onClick:()=>o([])},Object(Te.h)("span",{class:"italic"},"(ROOT)")),null!==i&&t,n.map(((i,a)=>Object(Te.h)(Te.Fragment,{key:a},Object(Te.h)("div",{onClick:()=>o(n.slice(0,a+1)),class:a===n.length-1?e:r},i.name),a<n.length-1&&t))))}),[n,i]),c=Object(Pe.c)((()=>{var t;return Object(Te.h)("div",{class:"flex py-1 bg-cyan-900 border border-yellow-500 text-sm"},Object(Te.h)("div",{class:"min-w-0 grow px-1 pl-2"},null===i?Object(Te.h)("span",{class:"italic"},"(ROOT)"):null!==(t=i.name)&&void 0!==t?t:Object(Te.h)("span",{class:"text-gray-300"},"<empty name>")),s&&Object(Te.h)(Dr,{state:s,setState:t=>{const n=Ne.createUpdatedMap(e,i,t);r(n)}}))}),[i,s,e,r]),u=Object(Pe.c)((()=>null===i||0===i.primitives.length?null:Object(Te.h)("div",{class:"border border-dashed border-gray-500 px-2 py-1 mt-2 mb-1 text-sm text-gray-300"},Object(Te.h)(De,{title:"Vertices"},Object(Te.h)("div",{class:"border-t border-gray-700 mt-1 pt-1 text-xs"},Object(Te.h)("span",{class:"break-all"},"[",i.vertices.map((t=>`[${t.x}, ${t.y}, ${t.z}]`)).join(", "),"]"))))),[i]),f=Object(Pe.c)((()=>null===i||0===i.primitives.length?null:Object(Te.h)("div",{class:"border border-dashed border-gray-500 px-2 py-1 mt-2 mb-1 text-sm text-gray-300"},Object(Te.h)(De,{title:"Primitives"},Object(Te.h)("div",{class:"border-t border-gray-700 mt-1 pt-1 text-xs"},Object(Te.h)(Vr,{primitives:i.primitives}))))),[i]);return Object(Te.h)("div",{class:"flex flex-col h-full overflow-hidden"},Object(Te.h)("div",{className:"px-6"},Object(Te.h)("div",{class:"mb-4"},l),Object(Te.h)("div",{class:"mb-2 font-bold"},"Current:"),c,Object(Te.h)("div",{class:"pl-4"},u,f),a.length>0&&Object(Te.h)("div",{class:"mt-6 mb-2 font-bold flex justify-between"},Object(Te.h)("span",null,"Children:"),Object(Te.h)("span",null,"(",a.length,")"))),Object(Te.h)("div",{class:"grow overflow-auto px-6"},Object(Te.h)(Ir,{current:null,nodes:a,onChangeNodeStack:o,nodeStack:n,objStateMap:e,setObjStateMap:r})))},$r=r("IomO"),Yr=r("u6ao");var Wr=({textures:t})=>Object(Te.h)("div",{class:"flex flex-col space-y-2"},Object.entries(t).map((([t,e],r)=>{let n=null!==e;null!==e&&"html"===e.type&&(n=e.image.complete&&0!==e.image.naturalWidth);const o=n?"OK":"ERROR";return Object(Te.h)("div",{key:r,class:"flex items-center group"+(n?" text-green-600 hover:text-green-500":" text-red-600 hover:text-red-500")},Object(Te.h)("div",{class:"break-all"},t),Object(Te.h)("div",{class:"grow border-b border-dashed border-gray-600 group-hover:border-gray-500 mx-1\r text-transparent text-center",style:{minWidth:"24px",marginBottom:"6px"}},"-"),"html"===(null==e?void 0:e.type)?Object(Te.h)("a",{href:e.image.src,target:"_blank",rel:"noreferrer"},o):Object(Te.h)("div",null,o))})));const Hr=["image/png","image/gif","image/jpeg"];var zr=({regularTextures:t,customTextures:e,setCustomTextures:r})=>{const[n,o]=Object(Pe.e)(!1),i=Object(Pe.a)((async t=>{const n={};for(const e of t){if(!Hr.includes(e.type))continue;const t=t=>{const r=e.name.replace(/^.*[\\\/]/,"").replace(/\.[^/.]+$/,"");n[r]={type:"html",image:t}};await Yr.a.loadDataUrl(e).then(Yr.a.createImageFromDataUrl).then(t).catch(console.error)}r(ue(ue({},e),n))}),[e,r]),a=Object(Te.h)("input",{type:"file",multiple:!0,accept:Hr.join(", "),disabled:n,onChange:t=>{if(n)return void(t.currentTarget.value="");const e=t.currentTarget.files;null!==e&&(o(!0),i(e).finally((()=>{o(!1)}))),t.currentTarget.value=""}});return Object(Te.h)("div",{class:"flex flex-col max-h-full overflow-hidden"},Object(Te.h)("div",{class:"text-center font-bold mb-2"},"Custom Textures"),Object(Te.h)("div",{class:"grow overflow-auto px-6"},Object(Te.h)(Wr,{textures:e,setTextures:r})),Object(Te.h)("div",{className:"px-6 mt-2"},a),Object(Te.h)("div",{class:"mb-6"}),Object(Te.h)("div",{class:"text-center font-bold mb-2"},"TAK Textures"),Object(Te.h)("div",{class:"grow overflow-auto px-6"},Object(Te.h)(Wr,{textures:t})))};const Gr=["options","objects","textures"];var qr=({engineName:t,shaders:e,object3doTree:r,regularTextures:n,defaultObjStateMap:o,logoDefs:i,userService:a,defaultUserSettings:s,defaultModelControls:l})=>{console.log("Re-rendering App");const[c,u]=Object(Pe.e)(!1),[f,h]=Object(Pe.e)("options"),[d,b]=Object(Pe.e)(l),[g,p]=Object(Pe.e)(o),[v,m]=Object(Pe.e)(),[_,O]=Object(Pe.e)(s),y=Object(Pe.a)((t=>{O(t),a.save(t)}),[a]),[j,x]=Object(Pe.e)({}),w=Object(Pe.d)();Object(Pe.b)((()=>{const a=w.current;if(!a)return;a.width=a.clientWidth,a.height=a.clientHeight,console.log("Creating the Engine");const c={mode:"static",canvas:a,modelControls:l,listener:{onModelControlsChanged:b},textureMapping:de({},n),objStateMap:o,preserveDrawingBuffer:s.preserveDrawingBuffer},u=de(de({},i),{},{defaultIdx:l.logoColorIdx}),f="webgl"===t?new Sr(c,e,r,u):new Xe(c);return m(f),()=>{f.destroy(),m(void 0),alert("Unmounting the engine. This should probably not be happening normally!!!")}}),[w,e,o,t,r,n,i,l,s]),Object(Pe.b)((()=>{const t=w.current;t&&(t.style.background=d.canvasBackground,t.style.backgroundSize=d.canvasBackgroundSize,t.style.backgroundRepeat=d.canvasBackgroundRepeat,t.style.backgroundPosition="center")}),[w,d]),Object(Pe.b)((()=>{v&&v.setModelControls(d)}),[v,d]),Object(Pe.b)((()=>{d.textureFilterMin===_.defaultTextureFilterMin&&d.textureFilterMag===_.defaultTextureFilterMag||y(de(de({},_),{},{defaultTextureFilterMin:d.textureFilterMin,defaultTextureFilterMag:d.textureFilterMag}))}),[v,d,_,y]),Object(Pe.b)((()=>{v&&v.setObjectStateMap(g)}),[v,g]),Object(Pe.b)((()=>{v&&v.setTextureMapping(de(de({},n),j))}),[v,n,j]);const M=Object(Pe.c)((()=>Object(Te.h)(Tr,{canvasRef:w})),[w]),S=Object(Pe.c)((()=>Object(Te.h)("div",{class:"h-full flex flex-col"},Object(Te.h)("div",{class:"flex text-white border-b border-gray-700"},Object(Te.h)("div",{class:"grow px-4 py-4 text-center"},"Canvas"),Object(Te.h)("div",{class:"px-4 py-4 cursor-pointer hover:bg-blue-700 font-mono",onClick:()=>u(!c)},c?">[ ]<":"<[ ]>")),Object(Te.h)("div",{class:"grow p-6"},M))),[M,c]),T=Object(Pe.c)((()=>Object(Te.h)($r.a,{modelControls:d,setModelControls:b,userSettings:_,setUserSettings:y,logoDefs:i,canvasRef:w})),[d,_,y,i,w]),P=Object(Pe.c)((()=>Object(Te.h)(Xr,{object3doTree:r,objStateMap:g,setObjStateMap:p})),[r,g]),E=Object(Pe.c)((()=>Object(Te.h)(zr,{regularTextures:n,customTextures:j,setCustomTextures:x})),[j,n]),C=Object(Pe.c)((()=>Object(Te.h)("div",{class:"h-full flex flex-col"},Object(Te.h)("div",{class:"flex text-white border-b border-gray-700"},Gr.map(((t,e,r)=>{const n=t===f,o=n?"font-bold":"cursor-pointer text-gray-400 hover:text-white",i=e!==r.length-1?"border-r border-gray-700":"";return Object(Te.h)("div",{key:e,class:`grow basis-0 px-2 py-4 text-center ${o} ${i}`,onClick:()=>{n||h(t)}},"options"===t?"Options":"objects"===t?"Objects":"Textures")}))),Object(Te.h)("div",{class:"grow max-h-full overflow-hidden py-6",style:{width:_.sidebarWidth,overflowX:"auto"}},"options"===f?T:"objects"===f?P:E))),[f,T,_,P,E]),R=c?" border-gray-800":" border-gray-700",D="left"===_.sidebarPosition?"":" flex-row-reverse",U="left"===_.sidebarPosition?" border-r":" border-l";return Object(Te.h)("div",{class:"flex justify-center items-stretch h-screen overflow-hidden bg-gray-900"},Object(Te.h)("div",{class:`grow flex bg-gray-800 border ${R} ${D}`,style:{"max-width":c?"100%":"1600px"}},Object(Te.h)("div",{class:`hidden lg:block border-gray-700 ${U}`},C),Object(Te.h)("div",{class:"grow"},S)))};var Zr=({dataSource:t,userService:e,defaultUserSettings:r,defaultModelControls:n})=>{var o,i;const[a,s]=Object(Pe.e)(),[l,c]=Object(Pe.e)(),[u,f]=Object(Pe.e)(),[h,d]=Object(Pe.e)(),b=Ae;if(Object(Pe.b)((()=>{(async function(){return{regular:{fsSource:await fetch("assets/shaders/regular.fs").then((t=>t.text())),vsSource:await fetch("assets/shaders/regular.vs").then((t=>t.text()))},solid:{fsSource:await fetch("assets/shaders/solid_color.fs").then((t=>t.text())),vsSource:await fetch("assets/shaders/solid_color.vs").then((t=>t.text()))},wireframe:{fsSource:await fetch("assets/shaders/wireframe.fs").then((t=>t.text())),vsSource:await fetch("assets/shaders/wireframe.vs").then((t=>t.text()))}}})().then(c)}),[]),Object(Pe.b)((()=>{(async function(t){let e;if("string"==typeof t){const r=await fetch(t);e=await r.arrayBuffer()}else e=await t.arrayBuffer();const r=new DataView(e);return Ie.Parse3do.fromBuffer(r)})(t).then((t=>(s(t),async function(t,e,r,n){const o=new Set,i=t=>{for(const e of t.primitives){const t=e.textureName;Ne.validateTextureName(t)&&o.add(t)}for(const e of t.children)i(e)};for(const e of t.rootNodes)i(e);const a={};return await Promise.all(Array.from(o).map((t=>new Promise(((o,i)=>{if(""===(t=t.trim()))return a[t]=null,void o();if(!e.textureKeyUsesLogo(t)){const e=`${t}.${n}`,i=new Image;return i.src=r+e,i.onerror=()=>{console.error(`Failed to load image at: ${i.src}`),a[t]=null,o()},void(i.onload=()=>{a[t]={type:"html",image:i},o()})}Promise.all(e.idxList.map((o=>new Promise((i=>{const s=e.idxToTextureKey(o,t),l=`${e.idxToTextureFilename(o,t)}.${n}`,c=new Image;c.src=r+l,c.onerror=()=>{console.error(`Failed to load image at: ${c.src}`),a[s]=null,i()},c.onload=()=>{a[s]={type:"html",image:c},i()}}))))).then((()=>o()),i)}))))),a}(t,b,"assets/custom/pngs/","png")))).then(f).catch(d)}),[t,b]),void 0!==h)return Object(Te.h)("div",{class:"min-w-screen min-h-screen flex flex-col justify-center items-center text-3xl\r bg-black"},Object(Te.h)("div",{class:"text-red-300"},"Error!"),Object(Te.h)("div",{class:"text-red-600"},"(TODO)"),Object(Te.h)("div",{class:"text-red-600"},JSON.stringify(h)));if(void 0===a||void 0===l||void 0===u){let t="Loading...";return a&&l&&(t="Loading textures..."),Object(Te.h)("div",{class:"min-w-screen min-h-screen flex justify-center items-center text-3xl bg-black"},Object(Te.h)("span",{class:"text-gray-400"},t))}return Object(Te.h)(qr,{engineName:"webgl",object3doTree:a,shaders:l,regularTextures:u,defaultObjStateMap:me(a),logoDefs:b,userService:e,defaultUserSettings:r,defaultModelControls:pe(pe({},n),{},{viewMode:null!==(o=_e(u))&&void 0!==o?o:n.viewMode,logoColorIdx:null!==(i=Oe(t))&&void 0!==i?i:n.logoColorIdx})})};e.default=()=>{const[t,e]=Object(Pe.e)(),[r]=Object(Pe.e)(Ce),[n,o]=Object(Pe.e)(),[i,a]=Object(Pe.e)();return Object(Pe.b)((()=>{let t;try{var e;t=null!==(e=r.load())&&void 0!==e?e:Ee}catch(e){console.error(e),t=Ee,r.save(t)}o(t),a(je(je({},Re),{},{textureFilterMin:t.defaultTextureFilterMin,textureFilterMag:t.defaultTextureFilterMag}))}),[r]),void 0===n||void 0===i?Object(Te.h)("div",{class:"min-h-screen flex justify-center items-center"},Object(Te.h)("span",null,"Loading...")):void 0===t?Object(Te.h)(Fe,{onSubmit:e,defaultUserSettings:n,setDefaultUserSettings:t=>{o(t),r.save(t)}}):Object(Te.h)(Zr,{dataSource:t,userService:r,defaultUserSettings:n,defaultModelControls:i})}},qiYd:function(t,e,r){"use strict";function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=r("hosL"),s=r("GssO");e.a=({modelControls:t,setModelControls:e})=>Object(a.h)("div",{class:"space-y-4"},Object(a.h)("div",null,Object(a.h)("label",{class:"flex items-center"},Object(a.h)("input",{type:"checkbox",checked:t.enableLightingSolidColor,onChange:r=>{e(o(o({},t),{},{enableLightingSolidColor:r.currentTarget.checked}))}}),Object(a.h)("span",{class:"pl-1"},"Enable Lighting"))),Object(a.h)("div",null,Object(a.h)("div",{class:""},"Solid Color"),Object(a.h)(s.a,{color:t.solidColor,setColor:r=>e(o(o({},t),{},{solidColor:r}))})))},tpTz:function(t,e,r){"use strict";function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=r("hosL"),s=r("QRet"),l=r("u6ao");e.a=({modelControls:t,setModelControls:e,enableSaveImageButton:r,canvasRef:n})=>{const[i,c]=Object(s.e)(function(t){return"black"===t||"white"===t||"transparent"===t?t:"custom"}(t.canvasBackground)),u=Object(s.a)((r=>{c(r),"custom"!==r&&e(o(o({},t),{},{canvasBackground:r}))}),[t,e]),f=Object(s.c)((()=>"custom"!==i?null:Object(a.h)("input",{type:"file",multiple:!1,onChange:r=>{const n=r.currentTarget.files;if(null===n||0===n.length)return void(r.currentTarget.value="");l.a.loadDataUrl(n[0]).then((r=>{const n=`url(${r})`;e(o(o({},t),{},{canvasBackground:n}))}))}})),[i,t,e]),h=Object(s.c)((()=>"custom"!==i?null:Object(a.h)("div",null,Object(a.h)("div",null,"Background Size"),Object(a.h)("select",{class:"w-full",value:t.canvasBackgroundSize,onChange:r=>{e(o(o({},t),{},{canvasBackgroundSize:r.currentTarget.value}))}},Object(a.h)("option",{value:"auto"},"Auto"),Object(a.h)("option",{value:"cover"},"Cover"),Object(a.h)("option",{value:"contain"},"Contain")))),[i,t]),d=Object(s.c)((()=>"custom"!==i||"cover"===t.canvasBackgroundSize?null:Object(a.h)("div",null,Object(a.h)("div",null,"Background Repeat"),Object(a.h)("select",{class:"w-full",value:t.canvasBackgroundRepeat,onChange:r=>{e(o(o({},t),{},{canvasBackgroundRepeat:r.currentTarget.value}))}},Object(a.h)("option",{value:"repeat"},"On"),Object(a.h)("option",{value:"no-repeat"},"Off")))),[i,t]),b=Object(s.a)((()=>{const t=n.current;if(void 0===t)return;const e=t.toDataURL(),r=document.createElement("a"),o=(new Date).getTime();r.href=e,r.download=`3do-${o}.png`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}),[n]),g=Object(s.c)((()=>r?Object(a.h)("div",{class:"text-center"},Object(a.h)("button",{class:"text-white hover:text-yellow-500 focus:text-yellow-500",onClick:b},"Save Model Image")):null),[r,b]);return Object(a.h)("div",{class:"space-y-4"},g,Object(a.h)("div",null,"Canvas Background",Object(a.h)("select",{class:"w-full",value:i,onChange:t=>u(t.currentTarget.value)},Object(a.h)("option",{value:"transparent"},"Transparent"),Object(a.h)("option",{value:"black"},"Black"),Object(a.h)("option",{value:"white"},"White"),Object(a.h)("option",{value:"custom"},"(Custom Image)")),Object(a.h)("div",{class:"mt-0.5"},f)),h,d)}},u6ao:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));const n={loadDataUrl:function(t){const e=new FileReader,r=new Promise(((r,n)=>{e.onload=()=>{const o=e.result;"string"==typeof o?r(o):n(new Error(`Failed to read file: ${t.name}`))},e.onerror=()=>{n(new Error(`Failed to read file: ${t.name}`))}}));return e.readAsDataURL(t),r},createImageFromDataUrl:function(t){return new Promise(((e,r)=>{const n=new Image;n.onload=()=>{e(n)},n.onerror=()=>{r(new Error(`Failed to create image for dataUrl: ${t}`))},n.src=t}))}}},weEs:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PRIMITIVE_STRUCT_SIZE=e.PRIMITIVE_STRUCT=e.VERTEX_STRUCT_SIZE=e.VERTEX_STRUCT=e.OBJECT_STRUCT_SIZE=e.OBJECT_STRUCT=void 0,e.OBJECT_STRUCT=[["VersionSignature","U32"],["NumberOfVertexes","U32"],["NumberOfPrimitives","U32"],["UnknownFlag","U32"],["XFromParent","U32"],["YFromParent","U32"],["ZFromParent","U32"],["OffsetToObjectName","U32"],["Always_0","U32"],["OffsetToVertexArray","U32"],["OffsetToPrimitiveArray","U32"],["OffsetToSiblingObject","U32"],["OffsetToChildObject","U32"]],e.OBJECT_STRUCT_SIZE=4*e.OBJECT_STRUCT.length,e.VERTEX_STRUCT=[["x","U32"],["y","U32"],["z","U32"]],e.VERTEX_STRUCT_SIZE=4*e.VERTEX_STRUCT.length,e.PRIMITIVE_STRUCT=[["Unknown_0","U32"],["NumberOfVertexIndexes","U32"],["Always_0","U32"],["OffsetToVertexIndexArray","U32"],["OffsetToTextureName","U32"],["Unknown_1","U32"],["Unknown_2","U32"],["Unknown_3","U32"]],e.PRIMITIVE_STRUCT_SIZE=4*e.PRIMITIVE_STRUCT.length}});
//# sourceMappingURL=bundle.5d194.esm.js.map